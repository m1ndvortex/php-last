import{d as e,r as a,c as s,u as l,x as t,y as r,C as o,z as n,J as i,O as d,F as u,D as c,L as v,o as m,H as p,E as f,K as b,k as y}from"./chunk-6e15bf0e.js";import{a3 as g,a as h}from"./chunk-7e530ccd.js";import{a as w}from"./index-8f9bb664.js";import"./chunk-b3261f71.js";import"./chunk-842293c6.js";import"./chunk-63a63872.js";import"./chunk-e5f6a124.js";import"./chunk-4562ab5a.js";const x={class:"text-md font-medium text-gray-900 mb-4"},_={key:0,class:"space-y-4"},k={class:"text-sm text-gray-600"},$=["disabled"],F={key:0},C={key:1},j={key:1,class:"space-y-4"},S={class:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-md"},A={class:"flex items-center"},M={class:"text-sm text-green-800"},U=["disabled"],V={class:"text-sm text-gray-600"},B={class:"mt-3"},z={class:"text-lg font-medium text-gray-900 mb-4"},D={key:0,class:"space-y-4"},E={class:"text-sm text-gray-600"},P={class:"text-center"},T={class:"text-xs text-gray-500 mb-2"},q={class:"text-xs bg-gray-100 p-2 rounded"},L={key:1,class:"space-y-4"},R={class:"text-sm text-gray-600"},H={for:"verification_code",class:"form-label"},J={class:"flex space-x-3"},Y=["disabled"],I={key:0},K={key:1},O={key:2,class:"space-y-4"},Q={class:"text-center"},G={class:"mt-2 text-lg font-medium text-gray-900"},N={class:"bg-yellow-50 border border-yellow-200 rounded-md p-3"},W={class:"text-sm text-yellow-800 mb-2"},X={class:"grid grid-cols-2 gap-2 text-xs font-mono"},Z=e({__name:"TwoFactorAuth",setup(e){const m=g(),{showSuccess:p,showError:f}=w(),b=a(!1),y=a(!1),Z=a(1),ee=a(""),ae=a(""),se=a([]),le=s(()=>{var e;return(null==(e=m.user)?void 0:e.two_factor_enabled)||!1}),te=async()=>{var e,a;try{b.value=!0;const e=await h.auth.enable2FA();ee.value=e.data.secret,y.value=!0,Z.value=1}catch(s){f("2FA Setup Failed",(null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.message)||"Failed to enable 2FA")}finally{b.value=!1}},re=async()=>{var e,a;const s=prompt("Please enter your password to disable 2FA:");if(s)try{b.value=!0,await h.auth.disable2FA({password:s}),p("2FA Disabled","Two-factor authentication has been disabled")}catch(l){f("Disable Failed",(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to disable 2FA")}finally{b.value=!1}},oe=async()=>{var e,a;try{b.value=!0;const e=await h.auth.verify2FA({code:ae.value});se.value=e.data.backup_codes,Z.value=3}catch(s){f("Verification Failed",(null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.message)||"Invalid verification code")}finally{b.value=!1}},ne=()=>{y.value=!1,Z.value=1,ae.value="",p("2FA Enabled","Two-factor authentication has been enabled successfully")},ie=()=>{y.value=!1,Z.value=1,ae.value=""},de=()=>{alert("Backup codes functionality coming soon")};return(e,a)=>(l(),t("div",null,[r("h4",x,o(e.$t("auth.two_factor")),1),le.value?(l(),t("div",j,[r("div",S,[r("div",A,[a[4]||(a[4]=r("svg",{class:"h-5 w-5 text-green-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),r("span",M,o(e.$t("auth.2fa_enabled_status")),1)]),r("button",{onClick:re,disabled:b.value,class:"btn btn-sm btn-outline-danger"},o(e.$t("auth.disable_2fa")),9,U)]),r("div",V,[r("p",null,o(e.$t("auth.2fa_backup_codes_info")),1),r("button",{onClick:de,class:"text-primary-600 hover:text-primary-500 underline"},o(e.$t("auth.view_backup_codes")),1)])])):(l(),t("div",_,[r("p",k,o(e.$t("auth.2fa_description")),1),r("button",{onClick:te,disabled:b.value,class:"btn btn-primary"},[b.value?(l(),t("span",F,o(e.$t("common.loading")),1)):(l(),t("span",C,o(e.$t("auth.enable_2fa")),1))],8,$)])),y.value?(l(),t("div",{key:2,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:ie},[r("div",{class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",onClick:a[3]||(a[3]=v(()=>{},["stop"]))},[r("div",B,[r("h3",z,o(e.$t("auth.setup_2fa")),1),1===Z.value?(l(),t("div",D,[r("p",E,o(e.$t("auth.scan_qr_code")),1),a[5]||(a[5]=r("div",{class:"flex justify-center"},[r("div",{class:"p-4 bg-white border-2 border-gray-300 rounded-lg"},[r("div",{class:"w-48 h-48 bg-gray-100 flex items-center justify-center"},[r("span",{class:"text-gray-500"},"QR Code")])])],-1)),r("div",P,[r("p",T,o(e.$t("auth.manual_entry")),1),r("code",q,o(ee.value),1)]),r("button",{onClick:a[0]||(a[0]=e=>Z.value=2),class:"w-full btn btn-primary"},o(e.$t("common.next")),1)])):n("",!0),2===Z.value?(l(),t("div",L,[r("p",R,o(e.$t("auth.enter_verification_code")),1),r("div",null,[r("label",H,o(e.$t("auth.2fa_code")),1),i(r("input",{id:"verification_code","onUpdate:modelValue":a[1]||(a[1]=e=>ae.value=e),type:"text",maxlength:"6",class:"form-input text-center text-lg tracking-widest",placeholder:"000000"},null,512),[[d,ae.value]])]),r("div",J,[r("button",{onClick:a[2]||(a[2]=e=>Z.value=1),class:"flex-1 btn btn-outline"},o(e.$t("common.back")),1),r("button",{onClick:oe,disabled:6!==ae.value.length||b.value,class:"flex-1 btn btn-primary"},[b.value?(l(),t("span",I,o(e.$t("common.verifying")),1)):(l(),t("span",K,o(e.$t("auth.verify_2fa")),1))],8,Y)])])):n("",!0),3===Z.value?(l(),t("div",O,[r("div",Q,[a[6]||(a[6]=r("svg",{class:"mx-auto h-12 w-12 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 48 48"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),r("h3",G,o(e.$t("auth.2fa_setup_complete")),1)]),r("div",N,[r("p",W,o(e.$t("auth.backup_codes_important")),1),r("div",X,[(l(!0),t(u,null,c(se.value,e=>(l(),t("div",{key:e,class:"bg-white p-1 rounded"},o(e),1))),128))])]),r("button",{onClick:ne,class:"w-full btn btn-primary"},o(e.$t("common.done")),1)])):n("",!0)])])])):n("",!0)]))}}),ee={class:"text-md font-medium text-gray-900 mb-4"},ae={key:0,class:"text-center py-4"},se={class:"mt-2 text-sm text-gray-600"},le={key:1,class:"text-center py-4"},te={class:"text-sm text-gray-600"},re={key:2,class:"space-y-3"},oe={class:"flex-1"},ne={class:"flex items-center"},ie={class:"flex-shrink-0"},de={key:0,class:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20"},ue={key:1,class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ce={class:"ml-3"},ve={class:"text-sm font-medium text-gray-900"},me={key:0,class:"text-green-600 font-normal"},pe={class:"text-xs text-gray-500"},fe={key:0},be=["onClick","disabled"],ye={key:3,class:"mt-4 pt-4 border-t"},ge=["disabled"],he=e({__name:"SessionManager",setup(e){const{showSuccess:s,showError:i}=w(),d=a([]),v=a(!1),b=a(!1),y=async()=>{var e,a;if(confirm("Are you sure you want to revoke all other sessions? This will log you out from all other devices."))try{b.value=!0,await h.auth.revokeAllSessions(),d.value=d.value.filter(e=>e.is_current),s("Sessions Revoked","All other sessions have been revoked successfully")}catch(l){i("Revoke Failed",(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to revoke sessions")}finally{b.value=!1}},g=e=>{const a=new Date(e),s=new Date,l=Math.floor((s.getTime()-a.getTime())/6e4);return l<1?"Just now":l<60?`${l} minutes ago`:l<1440?`${Math.floor(l/60)} hours ago`:a.toLocaleDateString()};return m(()=>{(async()=>{var e,a;try{v.value=!0;const e=await h.auth.getSessions();d.value=e.data}catch(s){i("Load Failed",(null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.message)||"Failed to load sessions")}finally{v.value=!1}})()}),(e,a)=>(l(),t("div",null,[r("h4",ee,o(e.$t("auth.active_sessions")),1),v.value?(l(),t("div",ae,[a[0]||(a[0]=r("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"},null,-1)),r("p",se,o(e.$t("common.loading")),1)])):0===d.value.length?(l(),t("div",le,[r("p",te,o(e.$t("auth.no_active_sessions")),1)])):(l(),t("div",re,[(l(!0),t(u,null,c(d.value,u=>{return l(),t("div",{key:u.id,class:p(["flex items-center justify-between p-3 border border-gray-200 rounded-lg",{"bg-green-50 border-green-200":u.is_current}])},[r("div",oe,[r("div",ne,[r("div",ie,[u.is_current?(l(),t("svg",de,a[1]||(a[1]=[r("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):(l(),t("svg",ue,a[2]||(a[2]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)])))]),r("div",ce,[r("p",ve,[f(o((c=u.user_agent,c.includes("Mobile")?"Mobile Device":c.includes("Chrome")?"Chrome Browser":c.includes("Firefox")?"Firefox Browser":c.includes("Safari")?"Safari Browser":c.includes("Edge")?"Edge Browser":"Unknown Device"))+" ",1),u.is_current?(l(),t("span",me," ("+o(e.$t("auth.current_session"))+") ",1)):n("",!0)]),r("p",pe,o(u.ip_address)+" â€¢ "+o(g(u.last_activity)),1)])])]),u.is_current?n("",!0):(l(),t("div",fe,[r("button",{onClick:e=>(async e=>{var a,l;if(confirm("Are you sure you want to revoke this session?"))try{b.value=!0,await h.auth.revokeSession(e),d.value=d.value.filter(a=>a.id!==e),s("Session Revoked","The session has been revoked successfully")}catch(t){i("Revoke Failed",(null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.message)||"Failed to revoke session")}finally{b.value=!1}})(u.id),disabled:b.value,class:"btn btn-sm btn-outline-danger"},o(e.$t("auth.revoke")),9,be)]))],2);var c}),128))])),d.value.length>1?(l(),t("div",ye,[r("button",{onClick:y,disabled:b.value,class:"btn btn-outline-danger"},o(e.$t("auth.revoke_all_other_sessions")),9,ge)])):n("",!0)]))}}),we={class:"max-w-2xl mx-auto"},xe={class:"card"},_e={class:"card-header"},ke={class:"text-lg font-medium text-gray-900"},$e={class:"card-body space-y-6"},Fe={class:"text-md font-medium text-gray-900 mb-4"},Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},je={for:"name",class:"form-label"},Se=["disabled"],Ae={for:"email",class:"form-label"},Me=["disabled"],Ue={for:"preferred_language",class:"form-label"},Ve=["disabled"],Be={value:"en"},ze={value:"fa"},De={class:"flex justify-end"},Ee=["disabled"],Pe={key:0},Te={key:1},qe={class:"border-t pt-6"},Le={class:"text-md font-medium text-gray-900 mb-4"},Re={for:"current_password",class:"form-label"},He=["disabled"],Je={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ye={for:"new_password",class:"form-label"},Ie=["disabled"],Ke={for:"confirm_password",class:"form-label"},Oe=["disabled"],Qe={class:"flex justify-end"},Ge=["disabled"],Ne={key:0},We={key:1},Xe={class:"border-t pt-6"},Ze={class:"border-t pt-6"},ea=e({__name:"UserProfile",setup(e){const n=g(),{showSuccess:u,showError:c}=w(),p=a(!1),f=a(!1),x=a({name:"",email:"",preferred_language:"en"}),_=a({current_password:"",new_password:"",confirm_password:""}),k=s(()=>""!==x.value.name.trim()&&""!==x.value.email.trim()&&""!==x.value.preferred_language),$=s(()=>""!==_.value.current_password.trim()&&""!==_.value.new_password.trim()&&""!==_.value.confirm_password.trim()&&_.value.new_password===_.value.confirm_password&&_.value.new_password.length>=8),F=async()=>{var e,a;if(k.value)try{p.value=!0,await h.auth.updateProfile(x.value),n.updateUser(x.value),u("Profile updated successfully","Your profile information has been updated.")}catch(s){c("Update Failed",(null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.message)||"Failed to update profile")}finally{p.value=!1}},C=async()=>{var e,a;if($.value)try{f.value=!0,await h.auth.changePassword({current_password:_.value.current_password,password:_.value.new_password,password_confirmation:_.value.confirm_password}),_.value={current_password:"",new_password:"",confirm_password:""},u("Password Changed","Your password has been changed successfully.")}catch(s){c("Change Failed",(null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.message)||"Failed to change password")}finally{f.value=!1}};return m(()=>{n.user&&(x.value={name:n.user.name,email:n.user.email,preferred_language:n.user.preferred_language})}),(e,a)=>(l(),t("div",we,[r("div",xe,[r("div",_e,[r("h3",ke,o(e.$t("auth.profile")),1)]),r("div",$e,[r("div",null,[r("h4",Fe,o(e.$t("common.profile_information")),1),r("form",{onSubmit:v(F,["prevent"]),class:"space-y-4"},[r("div",Ce,[r("div",null,[r("label",je,o(e.$t("common.name")),1),i(r("input",{id:"name","onUpdate:modelValue":a[0]||(a[0]=e=>x.value.name=e),type:"text",required:"",disabled:p.value,class:"form-input"},null,8,Se),[[d,x.value.name]])]),r("div",null,[r("label",Ae,o(e.$t("auth.email")),1),i(r("input",{id:"email","onUpdate:modelValue":a[1]||(a[1]=e=>x.value.email=e),type:"email",required:"",disabled:p.value,class:"form-input"},null,8,Me),[[d,x.value.email]])])]),r("div",null,[r("label",Ue,o(e.$t("common.preferred_language")),1),i(r("select",{id:"preferred_language","onUpdate:modelValue":a[2]||(a[2]=e=>x.value.preferred_language=e),disabled:p.value,class:"form-select"},[r("option",Be,o(e.$t("language.english")),1),r("option",ze,o(e.$t("language.persian")),1)],8,Ve),[[b,x.value.preferred_language]])]),r("div",De,[r("button",{type:"submit",disabled:p.value||!k.value,class:"btn btn-primary"},[p.value?(l(),t("span",Pe,o(e.$t("common.saving")),1)):(l(),t("span",Te,o(e.$t("common.save")),1))],8,Ee)])],32)]),r("div",qe,[r("h4",Le,o(e.$t("auth.change_password")),1),r("form",{onSubmit:v(C,["prevent"]),class:"space-y-4"},[r("div",null,[r("label",Re,o(e.$t("auth.current_password")),1),i(r("input",{id:"current_password","onUpdate:modelValue":a[3]||(a[3]=e=>_.value.current_password=e),type:"password",required:"",disabled:f.value,class:"form-input"},null,8,He),[[d,_.value.current_password]])]),r("div",Je,[r("div",null,[r("label",Ye,o(e.$t("auth.new_password")),1),i(r("input",{id:"new_password","onUpdate:modelValue":a[4]||(a[4]=e=>_.value.new_password=e),type:"password",required:"",disabled:f.value,class:"form-input"},null,8,Ie),[[d,_.value.new_password]])]),r("div",null,[r("label",Ke,o(e.$t("auth.confirm_password")),1),i(r("input",{id:"confirm_password","onUpdate:modelValue":a[5]||(a[5]=e=>_.value.confirm_password=e),type:"password",required:"",disabled:f.value,class:"form-input"},null,8,Oe),[[d,_.value.confirm_password]])])]),r("div",Qe,[r("button",{type:"submit",disabled:f.value||!$.value,class:"btn btn-primary"},[f.value?(l(),t("span",Ne,o(e.$t("common.saving")),1)):(l(),t("span",We,o(e.$t("auth.change_password")),1))],8,Ge)])],32)]),r("div",Xe,[y(Z)]),r("div",Ze,[y(he)])])])]))}}),aa={class:"container mx-auto px-4 py-6"},sa={class:"mb-6"},la={class:"text-2xl font-bold text-gray-900"},ta={class:"mt-1 text-sm text-gray-600"},ra=e({__name:"ProfileView",setup:e=>(e,a)=>(l(),t("div",aa,[r("div",sa,[r("h1",la,o(e.$t("auth.profile")),1),r("p",ta,o(e.$t("auth.profile_description")),1)]),y(ea)]))});export{ra as default};
