import{a as e,b as t}from"./chunk-aec80c57.js";import{d as s,r as a,l as r,w as l,o,u as i,x as d,y as n,C as c,J as u,O as m,K as g,k as b,B as p,E as y,L as x,c as f,F as k,D as _,z as v,Q as h,A as w,H as $,I as C,S as U,N as V}from"./chunk-6e15bf0e.js";import{a as S}from"./index-8ff573a4.js";import{Y as j,ad as D,N as Y,Q as M,O as A,u as L,o as q,aa as z,ab as B,ae as F,m as R,M as T,L as E,C as P,$ as H,af as O,B as I}from"./chunk-026199ed.js";import{_ as N}from"./chunk-b9fd9ac5.js";import"./chunk-b3261f71.js";import"./chunk-842293c6.js";import"./chunk-63a63872.js";import"./chunk-e5f6a124.js";const G={class:"space-y-6"},J={class:"text-lg font-medium text-gray-900 dark:text-white"},Q={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},K={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},W={for:"business_name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},X=["placeholder"],Z={for:"business_name_persian",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},ee=["placeholder"],te={for:"business_email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},se=["placeholder"],ae={for:"business_phone",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},re=["placeholder"],le={for:"business_website",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},oe=["placeholder"],ie={for:"tax_number",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},de=["placeholder"],ne={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},ce={for:"business_address",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},ue=["placeholder"],me={for:"business_address_persian",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},ge=["placeholder"],be={class:"border-t border-gray-200 dark:border-gray-700 pt-6"},pe={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},ye={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},xe={for:"default_currency",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},fe={for:"default_labor_percentage",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},ke={class:"mt-1 relative rounded-md shadow-sm"},_e=["placeholder"],ve={for:"default_profit_percentage",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},he={class:"mt-1 relative rounded-md shadow-sm"},we=["placeholder"],$e={for:"default_tax_rate",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Ce={class:"mt-1 relative rounded-md shadow-sm"},Ue=["placeholder"],Ve={class:"border-t border-gray-200 dark:border-gray-700 pt-6"},Se={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},je={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},De={for:"invoice_prefix",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Ye=["placeholder"],Me={for:"invoice_starting_number",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Ae=["placeholder"],Le={class:"border-t border-gray-200 dark:border-gray-700 pt-6"},qe={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},ze={class:"flex items-center space-x-6"},Be={class:"shrink-0"},Fe=["src","alt"],Re={key:1,class:"h-20 w-20 rounded-lg bg-gray-200 dark:bg-gray-700 flex items-center justify-center"},Te={class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},Ee={class:"flex justify-end"},Pe=["disabled"],He={key:0,class:"flex items-center"},Oe={key:1},Ie=s({__name:"BusinessSettings",setup(t){const s=e(),{showNotification:f}=S(),k=a(!1),_=a(),v=r({business_name:"",business_name_persian:"",business_address:"",business_address_persian:"",business_phone:"",business_email:"",business_website:"",tax_number:"",registration_number:"",logo_path:"",default_currency:"USD",default_language:"en",default_tax_rate:0,default_labor_percentage:0,default_profit_percentage:0,invoice_prefix:"INV",invoice_starting_number:1,fiscal_year_start:"01-01",timezone:"UTC",date_format:"YYYY-MM-DD",time_format:"HH:mm",number_format:"en"});l(()=>s.businessConfig,e=>{e&&Object.assign(v,e)},{immediate:!0});const h=async e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s)if(s.type.startsWith("image/"))if(s.size>2097152)f({type:"error",title:"File too large",message:"Please select an image smaller than 2MB"});else try{k.value=!0;(new FormData).append("logo",s),v.logo_path=URL.createObjectURL(s),f({type:"success",title:"Logo uploaded",message:"Business logo has been updated successfully"})}catch(a){f({type:"error",title:"Upload failed",message:"Failed to upload logo. Please try again."})}finally{k.value=!1}else f({type:"error",title:"Invalid file type",message:"Please select an image file"})},w=async()=>{try{k.value=!0;const e=await s.updateBusinessConfig({business_name:v.business_name,business_name_persian:v.business_name_persian,business_address:v.business_address,business_address_persian:v.business_address_persian,business_phone:v.business_phone,business_email:v.business_email,business_website:v.business_website,tax_number:v.tax_number,default_currency:v.default_currency,invoice_prefix:v.invoice_prefix,invoice_starting_number:v.invoice_starting_number,logo_path:v.logo_path}),t=await s.updateDefaultPricingPercentages({labor_percentage:v.default_labor_percentage||0,profit_percentage:v.default_profit_percentage||0,tax_percentage:v.default_tax_rate||0});e.success&&t.success?f({type:"success",title:"Settings saved",message:"Business configuration has been updated successfully"}):f({type:"error",title:"Save failed",message:e.error||t.error||"Failed to save business configuration"})}catch(e){f({type:"error",title:"Save failed",message:"An unexpected error occurred while saving"})}finally{k.value=!1}};return o(async()=>{s.businessConfig||await s.fetchSettings();try{const e=await s.getDefaultPricingPercentages();e.success&&(v.default_labor_percentage=e.data.labor_percentage,v.default_profit_percentage=e.data.profit_percentage,v.default_tax_rate=e.data.tax_percentage)}catch(e){}}),(e,t)=>(i(),d("div",G,[n("div",null,[n("h3",J,c(e.$t("settings.business.title")),1),n("p",Q,c(e.$t("settings.business.description")),1)]),n("form",{onSubmit:x(w,["prevent"]),class:"space-y-6"},[n("div",K,[n("div",null,[n("label",W,c(e.$t("settings.business.business_name")),1),u(n("input",{type:"text",id:"business_name","onUpdate:modelValue":t[0]||(t[0]=e=>v.business_name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.business_name_placeholder")},null,8,X),[[m,v.business_name]])]),n("div",null,[n("label",Z,c(e.$t("settings.business.business_name_persian")),1),u(n("input",{type:"text",id:"business_name_persian","onUpdate:modelValue":t[1]||(t[1]=e=>v.business_name_persian=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.business_name_persian_placeholder"),dir:"rtl"},null,8,ee),[[m,v.business_name_persian]])]),n("div",null,[n("label",te,c(e.$t("settings.business.business_email")),1),u(n("input",{type:"email",id:"business_email","onUpdate:modelValue":t[2]||(t[2]=e=>v.business_email=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.business_email_placeholder")},null,8,se),[[m,v.business_email]])]),n("div",null,[n("label",ae,c(e.$t("settings.business.business_phone")),1),u(n("input",{type:"tel",id:"business_phone","onUpdate:modelValue":t[3]||(t[3]=e=>v.business_phone=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.business_phone_placeholder")},null,8,re),[[m,v.business_phone]])]),n("div",null,[n("label",le,c(e.$t("settings.business.business_website")),1),u(n("input",{type:"url",id:"business_website","onUpdate:modelValue":t[4]||(t[4]=e=>v.business_website=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.business_website_placeholder")},null,8,oe),[[m,v.business_website]])]),n("div",null,[n("label",ie,c(e.$t("settings.business.tax_number")),1),u(n("input",{type:"text",id:"tax_number","onUpdate:modelValue":t[5]||(t[5]=e=>v.tax_number=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.tax_number_placeholder")},null,8,de),[[m,v.tax_number]])])]),n("div",ne,[n("div",null,[n("label",ce,c(e.$t("settings.business.business_address")),1),u(n("textarea",{id:"business_address","onUpdate:modelValue":t[6]||(t[6]=e=>v.business_address=e),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.business_address_placeholder")},null,8,ue),[[m,v.business_address]])]),n("div",null,[n("label",me,c(e.$t("settings.business.business_address_persian")),1),u(n("textarea",{id:"business_address_persian","onUpdate:modelValue":t[7]||(t[7]=e=>v.business_address_persian=e),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.business_address_persian_placeholder"),dir:"rtl"},null,8,ge),[[m,v.business_address_persian]])])]),n("div",be,[n("h4",pe,c(e.$t("settings.business.financial_settings")),1),n("div",ye,[n("div",null,[n("label",xe,c(e.$t("settings.business.default_currency")),1),u(n("select",{id:"default_currency","onUpdate:modelValue":t[8]||(t[8]=e=>v.default_currency=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},t[15]||(t[15]=[n("option",{value:"USD"},"USD - US Dollar",-1),n("option",{value:"EUR"},"EUR - Euro",-1),n("option",{value:"IRR"},"IRR - Iranian Rial",-1),n("option",{value:"AED"},"AED - UAE Dirham",-1)]),512),[[g,v.default_currency]])]),n("div",null,[n("label",fe,c(e.$t("settings.business.default_labor_percentage")),1),n("div",ke,[u(n("input",{type:"number",id:"default_labor_percentage","onUpdate:modelValue":t[9]||(t[9]=e=>v.default_labor_percentage=e),step:"0.01",min:"0",max:"1000",class:"block w-full rounded-md border-gray-300 pr-12 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.default_labor_percentage_placeholder")},null,8,_e),[[m,v.default_labor_percentage,void 0,{number:!0}]]),t[16]||(t[16]=n("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3"},[n("span",{class:"text-gray-500 sm:text-sm"},"%")],-1))])]),n("div",null,[n("label",ve,c(e.$t("settings.business.default_profit_percentage")),1),n("div",he,[u(n("input",{type:"number",id:"default_profit_percentage","onUpdate:modelValue":t[10]||(t[10]=e=>v.default_profit_percentage=e),step:"0.01",min:"0",max:"1000",class:"block w-full rounded-md border-gray-300 pr-12 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.default_profit_percentage_placeholder")},null,8,we),[[m,v.default_profit_percentage,void 0,{number:!0}]]),t[17]||(t[17]=n("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3"},[n("span",{class:"text-gray-500 sm:text-sm"},"%")],-1))])]),n("div",null,[n("label",$e,c(e.$t("settings.business.default_tax_rate")),1),n("div",Ce,[u(n("input",{type:"number",id:"default_tax_rate","onUpdate:modelValue":t[11]||(t[11]=e=>v.default_tax_rate=e),step:"0.01",min:"0",max:"100",class:"block w-full rounded-md border-gray-300 pr-12 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.default_tax_rate_placeholder")},null,8,Ue),[[m,v.default_tax_rate,void 0,{number:!0}]]),t[18]||(t[18]=n("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3"},[n("span",{class:"text-gray-500 sm:text-sm"},"%")],-1))])])])]),n("div",Ve,[n("h4",Se,c(e.$t("settings.business.invoice_settings")),1),n("div",je,[n("div",null,[n("label",De,c(e.$t("settings.business.invoice_prefix")),1),u(n("input",{type:"text",id:"invoice_prefix","onUpdate:modelValue":t[12]||(t[12]=e=>v.invoice_prefix=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.invoice_prefix_placeholder")},null,8,Ye),[[m,v.invoice_prefix]])]),n("div",null,[n("label",Me,c(e.$t("settings.business.invoice_starting_number")),1),u(n("input",{type:"number",id:"invoice_starting_number","onUpdate:modelValue":t[13]||(t[13]=e=>v.invoice_starting_number=e),min:"1",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.business.invoice_starting_number_placeholder")},null,8,Ae),[[m,v.invoice_starting_number,void 0,{number:!0}]])])])]),n("div",Le,[n("h4",qe,c(e.$t("settings.business.logo")),1),n("div",ze,[n("div",Be,[v.logo_path?(i(),d("img",{key:0,src:v.logo_path,alt:e.$t("settings.business.current_logo"),class:"h-20 w-20 object-cover rounded-lg"},null,8,Fe)):(i(),d("div",Re,[b(p(j),{class:"h-8 w-8 text-gray-400"})]))]),n("div",null,[n("input",{ref_key:"logoInput",ref:_,type:"file",accept:"image/*",onChange:h,class:"hidden"},null,544),n("button",{type:"button",onClick:t[14]||(t[14]=e=>{var t;return null==(t=_.value)?void 0:t.click()}),class:"bg-white dark:bg-gray-700 py-2 px-3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},c(e.$t("settings.business.change_logo")),1),n("p",Te,c(e.$t("settings.business.logo_requirements")),1)])])]),n("div",Ee,[n("button",{type:"submit",disabled:k.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[k.value?(i(),d("span",He,[t[19]||(t[19]=n("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+c(e.$t("common.saving")),1)])):(i(),d("span",Oe,c(e.$t("common.save")),1))],8,Pe)])],32)]))}}),Ne={class:"space-y-6"},Ge={class:"flex justify-between items-center"},Je={class:"text-lg font-medium text-gray-900 dark:text-white"},Qe={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Ke={class:"bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-md"},We={class:"divide-y divide-gray-200 dark:divide-gray-700"},Xe={class:"px-4 py-4 flex items-center justify-between"},Ze={class:"flex items-center"},et={class:"flex-shrink-0"},tt={class:"ml-4"},st={class:"text-sm font-medium text-gray-900 dark:text-white"},at={class:"text-sm text-gray-500 dark:text-gray-400"},rt={class:"text-xs text-gray-400 dark:text-gray-500 mt-1"},lt={class:"flex items-center space-x-2"},ot={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"},it=["onClick"],dt=["onClick"],nt={class:"mt-3"},ct={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},ut={for:"role_name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},mt=["placeholder"],gt={for:"role_display_name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},bt=["placeholder"],pt={for:"role_description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},yt=["placeholder"],xt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},ft={class:"space-y-4"},kt={class:"flex items-center justify-between mb-3"},_t={class:"text-sm font-medium text-gray-900 dark:text-white capitalize"},vt=["onClick"],ht={class:"grid grid-cols-2 gap-2"},wt=["value"],$t={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},Ct={class:"flex justify-end space-x-3 pt-4"},Ut=["disabled"],Vt=s({__name:"RolePermissionSettings",setup(t){const s=e(),{showNotification:l}=S(),g=a(!1),y=a(!1),$=a(!1),C=a(!1),U=a(null),V=a(null),j=r({name:"",display_name:"",description:"",permission_ids:[]}),Y=f(()=>{const e=new Set(s.permissions.map(e=>e.module));return Array.from(e)}),M=e=>s.permissions.filter(t=>t.module===e),A=e=>M(e).every(e=>j.permission_ids.includes(e.id)),L=async()=>{if(U.value)try{g.value=!0;const e=await s.deleteRole(U.value.id);e.success?l({type:"success",title:"Role deleted",message:"Role has been deleted successfully"}):l({type:"error",title:"Delete failed",message:e.error||"Failed to delete role"})}catch(e){l({type:"error",title:"Delete failed",message:"An unexpected error occurred while deleting the role"})}finally{g.value=!1,C.value=!1,U.value=null}},q=async()=>{try{g.value=!0;const e={name:j.name,display_name:j.display_name,description:j.description,permission_ids:j.permission_ids};let t;t=$.value&&V.value?await s.updateRole(V.value.id,e):await s.createRole(e),t.success?(l({type:"success",title:$.value?"Role updated":"Role created",message:`Role has been ${$.value?"updated":"created"} successfully`}),z()):l({type:"error",title:"Save failed",message:t.error||"Failed to save role"})}catch(e){l({type:"error",title:"Save failed",message:"An unexpected error occurred while saving the role"})}finally{g.value=!1}},z=()=>{y.value=!1,$.value=!1,V.value=null,j.name="",j.display_name="",j.description="",j.permission_ids=[]};return o(async()=>{await Promise.all([s.fetchRoles(),s.fetchPermissions()])}),(e,t)=>{var a;return i(),d("div",Ne,[n("div",Ge,[n("div",null,[n("h3",Je,c(e.$t("settings.roles.title")),1),n("p",Qe,c(e.$t("settings.roles.description")),1)]),n("button",{onClick:t[0]||(t[0]=e=>y.value=!0),class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},c(e.$t("settings.roles.create_role")),1)]),n("div",Ke,[n("ul",We,[(i(!0),d(k,null,_(p(s).roles,t=>(i(),d("li",{key:t.id},[n("div",Xe,[n("div",Ze,[n("div",et,[b(p(D),{class:"h-8 w-8 text-gray-400"})]),n("div",tt,[n("div",st,c(t.display_name),1),n("div",at,c(t.description),1),n("div",rt,c(t.permissions.length)+" "+c(e.$t("settings.roles.permissions")),1)])]),n("div",lt,[t.is_system?(i(),d("span",ot,c(e.$t("settings.roles.system_role")),1)):v("",!0),n("button",{onClick:e=>(e=>{V.value=e,j.name=e.name,j.display_name=e.display_name,j.description=e.description||"",j.permission_ids=e.permissions.map(e=>e.id),$.value=!0})(t),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300"},c(e.$t("common.edit")),9,it),t.is_system?v("",!0):(i(),d("button",{key:1,onClick:e=>(e=>{U.value=e,C.value=!0})(t),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},c(e.$t("common.delete")),9,dt))])])]))),128))])]),y.value||$.value?(i(),d("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:z},[n("div",{class:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white dark:bg-gray-800",onClick:t[5]||(t[5]=x(()=>{},["stop"]))},[n("div",nt,[n("h3",ct,c(y.value?e.$t("settings.roles.create_role"):e.$t("settings.roles.edit_role")),1),n("form",{onSubmit:x(q,["prevent"]),class:"space-y-4"},[n("div",null,[n("label",ut,c(e.$t("settings.roles.role_name")),1),u(n("input",{type:"text",id:"role_name","onUpdate:modelValue":t[1]||(t[1]=e=>j.name=e),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.roles.role_name_placeholder")},null,8,mt),[[m,j.name]])]),n("div",null,[n("label",gt,c(e.$t("settings.roles.display_name")),1),u(n("input",{type:"text",id:"role_display_name","onUpdate:modelValue":t[2]||(t[2]=e=>j.display_name=e),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.roles.display_name_placeholder")},null,8,bt),[[m,j.display_name]])]),n("div",null,[n("label",pt,c(e.$t("settings.roles.description")),1),u(n("textarea",{id:"role_description","onUpdate:modelValue":t[3]||(t[3]=e=>j.description=e),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.roles.description_placeholder")},null,8,yt),[[m,j.description]])]),n("div",null,[n("label",xt,c(e.$t("settings.roles.permissions")),1),n("div",ft,[(i(!0),d(k,null,_(Y.value,s=>(i(),d("div",{key:s,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-4"},[n("div",kt,[n("h4",_t,c(s),1),n("button",{type:"button",onClick:e=>(e=>{const t=M(e);if(A(e))j.permission_ids=j.permission_ids.filter(e=>!t.some(t=>t.id===e));else{const e=t.filter(e=>!j.permission_ids.includes(e.id)).map(e=>e.id);j.permission_ids.push(...e)}})(s),class:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400"},c(A(s)?e.$t("common.deselect_all"):e.$t("common.select_all")),9,vt)]),n("div",ht,[(i(!0),d(k,null,_(M(s),e=>(i(),d("label",{key:e.id,class:"flex items-center"},[u(n("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[4]||(t[4]=e=>j.permission_ids=e),class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,8,wt),[[h,j.permission_ids]]),n("span",$t,c(e.display_name),1)]))),128))])]))),128))])]),n("div",Ct,[n("button",{type:"button",onClick:z,class:"bg-white dark:bg-gray-700 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},c(e.$t("common.cancel")),1),n("button",{type:"submit",disabled:g.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},c(g.value?e.$t("common.saving"):e.$t("common.save")),9,Ut)])],32)])])])):v("",!0),C.value?(i(),w(N,{key:1,title:e.$t("settings.roles.delete_role"),message:e.$t("settings.roles.delete_confirmation",{role:null==(a=U.value)?void 0:a.display_name}),"confirm-text":e.$t("common.delete"),"cancel-text":e.$t("common.cancel"),onConfirm:L,onCancel:t[6]||(t[6]=e=>C.value=!1)},null,8,["title","message","confirm-text","cancel-text"])):v("",!0)])}}}),St={class:"space-y-6"},jt={class:"flex justify-between items-center"},Dt={class:"text-lg font-medium text-gray-900 dark:text-white"},Yt={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Mt={class:"border-b border-gray-200 dark:border-gray-700"},At={class:"-mb-px flex space-x-8","aria-label":"Tabs"},Lt=["onClick"],qt={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3"},zt={class:"p-5"},Bt={class:"flex items-center"},Ft={class:"flex-shrink-0"},Rt={class:"ml-5 w-0 flex-1"},Tt={class:"text-sm font-medium text-gray-500 dark:text-gray-400 truncate"},Et={class:"text-lg font-medium text-gray-900 dark:text-white"},Pt={class:"bg-gray-50 dark:bg-gray-700 px-5 py-3"},Ht={class:"text-sm"},Ot={class:"flex justify-between items-center mb-2"},It={class:"text-gray-500 dark:text-gray-400"},Nt={class:"flex flex-wrap gap-1 mb-3"},Gt={class:"flex justify-end space-x-2"},Jt=["onClick"],Qt=["onClick"],Kt={class:"mt-3"},Wt={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},Xt={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Zt={for:"template_name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},es=["placeholder"],ts={for:"template_type",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},ss={value:"email"},as={value:"sms"},rs={value:"whatsapp"},ls={key:0},os={for:"template_subject",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},is=["placeholder"],ds={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ns={class:"border-b border-gray-200 dark:border-gray-700 mb-4"},cs={class:"-mb-px flex space-x-8","aria-label":"Tabs"},us={key:0},ms=["placeholder"],gs={key:1},bs=["placeholder"],ps={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},ys={class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},xs={class:"flex flex-wrap gap-2"},fs=["onClick"],ks={class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},_s={class:"flex items-center"},vs={for:"template_active",class:"ml-2 block text-sm text-gray-900 dark:text-white"},hs={class:"flex justify-end space-x-3 pt-4"},ws=["disabled"],$s=s({__name:"MessageTemplateSettings",setup(t){const s=e(),{showNotification:l}=S(),b=a(!1),p=a(!1),y=a(!1),U=a(!1),V=a(null),j=a(null),D=a("email"),L=a("en"),q=["email","sms","whatsapp"],z=r({name:"",type:"email",subject:"",content:"",content_persian:"",is_active:!0}),B=["{{customer_name}}","{{customer_email}}","{{customer_phone}}","{{business_name}}","{{invoice_number}}","{{invoice_total}}","{{due_date}}","{{item_name}}","{{quantity}}","{{price}}","{{birthday}}","{{anniversary}}"],F=f(()=>s.messageTemplates.filter(e=>e.type===D.value)),R=e=>{switch(e){case"email":default:return Y;case"sms":return A;case"whatsapp":return M}},T=async()=>{if(V.value)try{b.value=!0;const e=await s.deleteMessageTemplate(V.value.id);e.success?l({type:"success",title:"Template deleted",message:"Message template has been deleted successfully"}):l({type:"error",title:"Delete failed",message:e.error||"Failed to delete template"})}catch(e){l({type:"error",title:"Delete failed",message:"An unexpected error occurred while deleting the template"})}finally{b.value=!1,U.value=!1,V.value=null}},E=async()=>{try{b.value=!0;const e={name:z.name,type:z.type,subject:z.subject||void 0,content:z.content,content_persian:z.content_persian||void 0,is_active:z.is_active,variables:B.filter(e=>z.content.includes(e)||z.content_persian&&z.content_persian.includes(e))};let t;t=y.value&&j.value?await s.updateMessageTemplate(j.value.id,e):await s.createMessageTemplate(e),t.success?(l({type:"success",title:y.value?"Template updated":"Template created",message:`Message template has been ${y.value?"updated":"created"} successfully`}),P()):l({type:"error",title:"Save failed",message:t.error||"Failed to save template"})}catch(e){l({type:"error",title:"Save failed",message:"An unexpected error occurred while saving the template"})}finally{b.value=!1}},P=()=>{p.value=!1,y.value=!1,j.value=null,L.value="en",z.name="",z.type="email",z.subject="",z.content="",z.content_persian="",z.is_active=!0};return o(async()=>{await s.fetchMessageTemplates()}),(e,t)=>{var s;return i(),d("div",St,[n("div",jt,[n("div",null,[n("h3",Dt,c(e.$t("settings.templates.title")),1),n("p",Yt,c(e.$t("settings.templates.description")),1)]),n("button",{onClick:t[0]||(t[0]=e=>p.value=!0),class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},c(e.$t("settings.templates.create_template")),1)]),n("div",Mt,[n("nav",At,[(i(),d(k,null,_(q,t=>n("button",{key:t,onClick:e=>D.value=t,class:$([D.value===t?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm capitalize"])},c(e.$t(`settings.templates.types.${t}`)),11,Lt)),64))])]),n("div",qt,[(i(!0),d(k,null,_(F.value,t=>(i(),d("div",{key:t.id,class:"bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg"},[n("div",zt,[n("div",Bt,[n("div",Ft,[(i(),w(C(R(t.type)),{class:"h-8 w-8 text-gray-400"}))]),n("div",Rt,[n("dl",null,[n("dt",Tt,c(t.name),1),n("dd",Et,c(t.subject||e.$t("settings.templates.no_subject")),1)])])])]),n("div",Pt,[n("div",Ht,[n("div",Ot,[n("span",It,c(e.$t("settings.templates.variables"))+": ",1),n("span",{class:$([t.is_active?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100","inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},c(t.is_active?e.$t("common.active"):e.$t("common.inactive")),3)]),n("div",Nt,[(i(!0),d(k,null,_(t.variables,e=>(i(),d("span",{key:e,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100"},c(e),1))),128))]),n("div",Gt,[n("button",{onClick:e=>(e=>{j.value=e,z.name=e.name,z.type=e.type,z.subject=e.subject||"",z.content=e.content,z.content_persian=e.content_persian||"",z.is_active=e.is_active,y.value=!0})(t),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium"},c(e.$t("common.edit")),9,Jt),n("button",{onClick:e=>(e=>{V.value=e,U.value=!0})(t),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 text-sm font-medium"},c(e.$t("common.delete")),9,Qt)])])])]))),128))]),p.value||y.value?(i(),d("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:P},[n("div",{class:"relative top-10 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-2/3 xl:w-1/2 shadow-lg rounded-md bg-white dark:bg-gray-800 max-h-screen overflow-y-auto",onClick:t[9]||(t[9]=x(()=>{},["stop"]))},[n("div",Kt,[n("h3",Wt,c(p.value?e.$t("settings.templates.create_template"):e.$t("settings.templates.edit_template")),1),n("form",{onSubmit:x(E,["prevent"]),class:"space-y-4"},[n("div",Xt,[n("div",null,[n("label",Zt,c(e.$t("settings.templates.template_name")),1),u(n("input",{type:"text",id:"template_name","onUpdate:modelValue":t[1]||(t[1]=e=>z.name=e),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.templates.template_name_placeholder")},null,8,es),[[m,z.name]])]),n("div",null,[n("label",ts,c(e.$t("settings.templates.template_type")),1),u(n("select",{id:"template_type","onUpdate:modelValue":t[2]||(t[2]=e=>z.type=e),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},[n("option",ss,c(e.$t("settings.templates.types.email")),1),n("option",as,c(e.$t("settings.templates.types.sms")),1),n("option",rs,c(e.$t("settings.templates.types.whatsapp")),1)],512),[[g,z.type]])])]),"email"===z.type?(i(),d("div",ls,[n("label",os,c(e.$t("settings.templates.subject")),1),u(n("input",{type:"text",id:"template_subject","onUpdate:modelValue":t[3]||(t[3]=e=>z.subject=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.templates.subject_placeholder")},null,8,is),[[m,z.subject]])])):v("",!0),n("div",null,[n("label",ds,c(e.$t("settings.templates.content")),1),n("div",ns,[n("nav",cs,[n("button",{type:"button",onClick:t[4]||(t[4]=e=>L.value="en"),class:$(["en"===L.value?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"])}," English ",2),n("button",{type:"button",onClick:t[5]||(t[5]=e=>L.value="fa"),class:$(["fa"===L.value?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"])}," ÙØ§Ø±Ø³ÛŒ ",2)])]),"en"===L.value?(i(),d("div",us,[u(n("textarea",{"onUpdate:modelValue":t[6]||(t[6]=e=>z.content=e),rows:"8",required:"",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.templates.content_placeholder")},null,8,ms),[[m,z.content]])])):v("",!0),"fa"===L.value?(i(),d("div",gs,[u(n("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>z.content_persian=e),rows:"8",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.templates.content_persian_placeholder"),dir:"rtl"},null,8,bs),[[m,z.content_persian]])])):v("",!0)]),n("div",ps,[n("h4",ys,c(e.$t("settings.templates.available_variables")),1),n("div",xs,[(i(),d(k,null,_(B,e=>n("button",{key:e,type:"button",onClick:t=>(e=>{const t=document.querySelector("en"===L.value?'textarea[v-model="templateForm.content"]':'textarea[v-model="templateForm.content_persian"]');if(t){const s=t.selectionStart,a=t.selectionEnd,r="en"===L.value?z.content:z.content_persian,l=r.substring(0,s)+e+r.substring(a);"en"===L.value?z.content=l:z.content_persian=l,setTimeout(()=>{t.focus(),t.setSelectionRange(s+e.length,s+e.length)},0)}})(e),class:"inline-flex items-center px-2.5 py-1.5 border border-gray-300 dark:border-gray-600 shadow-sm text-xs font-medium rounded text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},c(e),9,fs)),64))]),n("p",ks,c(e.$t("settings.templates.variables_help")),1)]),n("div",_s,[u(n("input",{id:"template_active",type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>z.is_active=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,z.is_active]]),n("label",vs,c(e.$t("settings.templates.is_active")),1)]),n("div",hs,[n("button",{type:"button",onClick:P,class:"bg-white dark:bg-gray-700 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},c(e.$t("common.cancel")),1),n("button",{type:"submit",disabled:b.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},c(b.value?e.$t("common.saving"):e.$t("common.save")),9,ws)])],32)])])])):v("",!0),U.value?(i(),w(N,{key:1,title:e.$t("settings.templates.delete_template"),message:e.$t("settings.templates.delete_confirmation",{template:null==(s=V.value)?void 0:s.name}),"confirm-text":e.$t("common.delete"),"cancel-text":e.$t("common.cancel"),onConfirm:T,onCancel:t[10]||(t[10]=e=>U.value=!1)},null,8,["title","message","confirm-text","cancel-text"])):v("",!0)])}}}),Cs={class:"space-y-8"},Us={class:"text-lg font-medium text-gray-900 dark:text-white"},Vs={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Ss={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},js={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},Ds={class:"space-y-6"},Ys={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},Ms={class:"grid grid-cols-3 gap-3"},As=["value","onUpdate:modelValue"],Ls={class:"flex-1"},qs={class:"flex items-center"},zs={class:"text-sm"},Bs={class:"font-medium text-gray-900 dark:text-white"},Fs={class:"text-gray-500 dark:text-gray-400"},Rs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},Ts={class:"grid grid-cols-4 gap-3"},Es=["value"],Ps={class:"flex items-center justify-center h-8"},Hs={class:"text-center mt-2"},Os={class:"text-xs font-medium text-white"},Is={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},Ns={for:"sidebar_style",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Gs={value:"expanded"},Js={value:"collapsed"},Qs={value:"overlay"},Ks={for:"font_size",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Ws={value:"small"},Xs={value:"medium"},Zs={value:"large"},ea={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},ta={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},sa={class:"space-y-6"},aa={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},ra={class:"grid grid-cols-2 gap-3"},la=["value"],oa={class:"flex-1"},ia={class:"flex items-center"},da={class:"text-2xl mr-3"},na={class:"text-sm"},ca={class:"font-medium text-gray-900 dark:text-white"},ua={class:"text-gray-500 dark:text-gray-400"},ma={class:"flex items-center"},ga={for:"rtl_enabled",class:"ml-2 block text-sm text-gray-900 dark:text-white"},ba={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},pa={for:"calendar_type",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},ya={value:"gregorian"},xa={value:"jalali"},fa={for:"number_format",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},ka={value:"en"},_a={value:"fa"},va={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},ha={for:"date_format",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},wa={for:"time_format",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},$a={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Ca={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},Ua={class:"border border-gray-200 dark:border-gray-700 rounded-lg p-4"},Va={class:"flex items-center justify-between mb-4"},Sa={class:"text-sm font-medium text-gray-900 dark:text-white"},ja={class:"flex items-center space-x-2"},Da={class:"text-sm text-gray-500 dark:text-gray-400"},Ya={class:"text-sm text-gray-500 dark:text-gray-400"},Ma={class:"flex items-center"},Aa={class:"text-sm font-medium text-gray-900 dark:text-white"},La={class:"flex justify-end"},qa=["disabled"],za={key:0,class:"flex items-center"},Ba={key:1},Fa=s({__name:"ThemeLanguageSettings",setup(s){const m=e(),{showNotification:b}=S(),{formatJalaliDate:f,formatGregorianDate:j}=t(),{formatNumber:D}=L(),Y=a(!1),M=r({mode:"light",primary_color:"#3B82F6",secondary_color:"#6B7280",accent_color:"#10B981",sidebar_style:"expanded",header_style:"fixed",font_size:"medium",border_radius:"medium"}),A=r({default_language:"en",rtl_enabled:!0,date_format:"YYYY-MM-DD",time_format:"HH:mm",number_format:"en",currency_format:"USD",calendar_type:"gregorian"}),R=[{value:"light",icon:z},{value:"dark",icon:B},{value:"system",icon:F}],T=[{name:"Blue",value:"#3B82F6"},{name:"Green",value:"#10B981"},{name:"Purple",value:"#8B5CF6"},{name:"Pink",value:"#EC4899"},{name:"Indigo",value:"#6366F1"},{name:"Red",value:"#EF4444"},{name:"Orange",value:"#F59E0B"},{name:"Teal",value:"#14B8A6"}],E=[{code:"en",name:"English",flag:"ðŸ‡ºðŸ‡¸",dir:"ltr"},{code:"fa",name:"ÙØ§Ø±Ø³ÛŒ",flag:"ðŸ‡®ðŸ‡·",dir:"rtl"}];l(()=>m.themeSettings,e=>{e&&Object.assign(M,e)},{immediate:!0}),l(()=>m.languageSettings,e=>{e&&Object.assign(A,e)},{immediate:!0});const P=()=>{const e=new Date;return"jalali"===A.calendar_type?f(e,A.date_format||"YYYY-MM-DD"):j(e,A.date_format||"YYYY-MM-DD")},H=async()=>{try{Y.value=!0;const e=await m.updateThemeSettings(M);if(!e.success)throw new Error(e.error||"Theme update failed");const t=await m.updateLanguageSettings(A);if(!t.success)throw new Error(t.error||"Language update failed");b({type:"success",title:"Settings saved",message:"Theme and language settings have been updated successfully"}),O()}catch(e){b({type:"error",title:"Save failed",message:e.message||"Failed to save settings"})}finally{Y.value=!1}},O=()=>{const e=document.documentElement;if("dark"===M.mode)e.classList.add("dark");else if("light"===M.mode)e.classList.remove("dark");else{window.matchMedia("(prefers-color-scheme: dark)").matches?e.classList.add("dark"):e.classList.remove("dark")}if("fa"===A.default_language&&A.rtl_enabled?e.setAttribute("dir","rtl"):e.setAttribute("dir","ltr"),M.primary_color&&e.style.setProperty("--primary-color",M.primary_color),M.font_size)switch(e.classList.remove("text-sm","text-base","text-lg"),M.font_size){case"small":e.classList.add("text-sm");break;case"large":e.classList.add("text-lg");break;default:e.classList.add("text-base")}};return o(()=>{m.themeSettings&&m.languageSettings||m.fetchSettings()}),(e,t)=>{return i(),d("div",Cs,[n("div",null,[n("h3",Us,c(e.$t("settings.appearance.title")),1),n("p",Vs,c(e.$t("settings.appearance.description")),1)]),n("form",{onSubmit:x(H,["prevent"]),class:"space-y-8"},[n("div",Ss,[n("h4",js,c(e.$t("settings.appearance.theme_settings")),1),n("div",Ds,[n("div",null,[n("label",Ys,c(e.$t("settings.appearance.theme_mode")),1),n("div",Ms,[(i(),d(k,null,_(R,t=>n("label",{key:t.value,class:$([M.mode===t.value?"border-blue-500 ring-2 ring-blue-500":"border-gray-300 dark:border-gray-600","relative border rounded-lg p-4 flex cursor-pointer focus:outline-none"])},[u(n("input",{type:"radio",value:t.value,"onUpdate:modelValue":e=>M.mode=e,class:"sr-only"},null,8,As),[[U,M.mode]]),n("div",Ls,[n("div",qs,[(i(),w(C(t.icon),{class:"h-5 w-5 text-gray-400 mr-3"})),n("div",zs,[n("div",Bs,c(e.$t(`settings.appearance.modes.${t.value}`)),1),n("div",Fs,c(e.$t(`settings.appearance.modes.${t.value}_desc`)),1)])])])],2)),64))])]),n("div",null,[n("label",Rs,c(e.$t("settings.appearance.color_scheme")),1),n("div",Ts,[(i(),d(k,null,_(T,e=>n("label",{key:e.value,class:$([M.primary_color===e.value?"ring-2 ring-offset-2 ring-blue-500":"","relative rounded-lg p-3 cursor-pointer focus:outline-none"]),style:V({backgroundColor:e.value})},[u(n("input",{type:"radio",value:e.value,"onUpdate:modelValue":t[0]||(t[0]=e=>M.primary_color=e),class:"sr-only"},null,8,Es),[[U,M.primary_color]]),n("div",Ps,[M.primary_color===e.value?(i(),w(p(q),{key:0,class:"h-5 w-5 text-white"})):v("",!0)]),n("div",Hs,[n("div",Os,c(e.name),1)])],6)),64))])]),n("div",Is,[n("div",null,[n("label",Ns,c(e.$t("settings.appearance.sidebar_style")),1),u(n("select",{id:"sidebar_style","onUpdate:modelValue":t[1]||(t[1]=e=>M.sidebar_style=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},[n("option",Gs,c(e.$t("settings.appearance.sidebar_expanded")),1),n("option",Js,c(e.$t("settings.appearance.sidebar_collapsed")),1),n("option",Qs,c(e.$t("settings.appearance.sidebar_overlay")),1)],512),[[g,M.sidebar_style]])]),n("div",null,[n("label",Ks,c(e.$t("settings.appearance.font_size")),1),u(n("select",{id:"font_size","onUpdate:modelValue":t[2]||(t[2]=e=>M.font_size=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},[n("option",Ws,c(e.$t("settings.appearance.font_small")),1),n("option",Xs,c(e.$t("settings.appearance.font_medium")),1),n("option",Zs,c(e.$t("settings.appearance.font_large")),1)],512),[[g,M.font_size]])])])])]),n("div",ea,[n("h4",ta,c(e.$t("settings.appearance.language_settings")),1),n("div",sa,[n("div",null,[n("label",aa,c(e.$t("settings.appearance.default_language")),1),n("div",ra,[(i(),d(k,null,_(E,e=>n("label",{key:e.code,class:$([A.default_language===e.code?"border-blue-500 ring-2 ring-blue-500":"border-gray-300 dark:border-gray-600","relative border rounded-lg p-4 flex cursor-pointer focus:outline-none"])},[u(n("input",{type:"radio",value:e.code,"onUpdate:modelValue":t[3]||(t[3]=e=>A.default_language=e),class:"sr-only"},null,8,la),[[U,A.default_language]]),n("div",oa,[n("div",ia,[n("span",da,c(e.flag),1),n("div",na,[n("div",ca,c(e.name),1),n("div",ua,c("rtl"===e.dir?"Right-to-Left":"Left-to-Right"),1)])])])],2)),64))])]),n("div",ma,[u(n("input",{id:"rtl_enabled",type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>A.rtl_enabled=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,A.rtl_enabled]]),n("label",ga,c(e.$t("settings.appearance.enable_rtl")),1)]),n("div",ba,[n("div",null,[n("label",pa,c(e.$t("settings.appearance.calendar_type")),1),u(n("select",{id:"calendar_type","onUpdate:modelValue":t[5]||(t[5]=e=>A.calendar_type=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},[n("option",ya,c(e.$t("settings.appearance.gregorian")),1),n("option",xa,c(e.$t("settings.appearance.jalali")),1)],512),[[g,A.calendar_type]])]),n("div",null,[n("label",fa,c(e.$t("settings.appearance.number_format")),1),u(n("select",{id:"number_format","onUpdate:modelValue":t[6]||(t[6]=e=>A.number_format=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},[n("option",ka,c(e.$t("settings.appearance.english_numerals")),1),n("option",_a,c(e.$t("settings.appearance.persian_numerals")),1)],512),[[g,A.number_format]])])]),n("div",va,[n("div",null,[n("label",ha,c(e.$t("settings.appearance.date_format")),1),u(n("select",{id:"date_format","onUpdate:modelValue":t[7]||(t[7]=e=>A.date_format=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},t[9]||(t[9]=[n("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1),n("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),n("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),n("option",{value:"DD-MM-YYYY"},"DD-MM-YYYY",-1)]),512),[[g,A.date_format]])]),n("div",null,[n("label",wa,c(e.$t("settings.appearance.time_format")),1),u(n("select",{id:"time_format","onUpdate:modelValue":t[8]||(t[8]=e=>A.time_format=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},t[10]||(t[10]=[n("option",{value:"HH:mm"},"24 Hour (HH:mm)",-1),n("option",{value:"hh:mm A"},"12 Hour (hh:mm AM/PM)",-1)]),512),[[g,A.time_format]])])])])]),n("div",$a,[n("h4",Ca,c(e.$t("settings.appearance.preview")),1),n("div",Ua,[n("div",Va,[n("h5",Sa,c(e.$t("settings.appearance.preview_sample")),1),n("div",ja,[n("span",Da,c(P()),1),n("span",Ya,c((s=1234.56,D(s,{minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:!0}))),1)])]),n("div",{class:$(["p-4 rounded-lg",M.primary_color?"bg-opacity-10":"bg-blue-50 dark:bg-blue-900"]),style:V({backgroundColor:M.primary_color+"20"})},[n("div",Ma,[n("div",{class:"w-3 h-3 rounded-full mr-3",style:V({backgroundColor:M.primary_color})},null,4),n("span",Aa,c(e.$t("settings.appearance.sample_content")),1)])],6)])]),n("div",La,[n("button",{type:"submit",disabled:Y.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[Y.value?(i(),d("span",za,[t[11]||(t[11]=n("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+c(e.$t("common.saving")),1)])):(i(),d("span",Ba,c(e.$t("common.save")),1))],8,qa)])],32)]);var s}}}),Ra={class:"mt-3"},Ta={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},Ea={key:0,class:"space-y-4"},Pa={class:"text-sm text-gray-500 dark:text-gray-400"},Ha={class:"space-y-2"},Oa={class:"flex items-center p-3 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700"},Ia={class:"ml-3"},Na={class:"text-sm font-medium text-gray-900 dark:text-white"},Ga={class:"text-xs text-gray-500 dark:text-gray-400"},Ja={class:"flex items-center p-3 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700"},Qa={class:"ml-3"},Ka={class:"text-sm font-medium text-gray-900 dark:text-white"},Wa={class:"text-xs text-gray-500 dark:text-gray-400"},Xa={class:"flex justify-end space-x-3 pt-4"},Za=["disabled"],er={key:1,class:"space-y-4"},tr={key:0,class:"text-center"},sr={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},ar={key:1,class:"space-y-4"},rr={class:"text-center"},lr={class:"text-sm text-gray-500 dark:text-gray-400 mb-4"},or={class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},ir={class:"bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded"},dr={for:"totp_code",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},nr=["placeholder"],cr={key:0,class:"bg-yellow-50 dark:bg-yellow-900 p-4 rounded-lg"},ur={class:"text-sm font-medium text-yellow-800 dark:text-yellow-200 mb-2"},mr={class:"text-xs text-yellow-700 dark:text-yellow-300 mb-3"},gr={class:"grid grid-cols-2 gap-2"},br={class:"flex justify-end space-x-3 pt-4"},pr=["disabled"],yr={key:0},xr={key:1},fr={key:2,class:"space-y-4"},kr={class:"text-sm text-gray-500 dark:text-gray-400"},_r={for:"phone_number",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},vr=["placeholder"],hr=["disabled"],wr={key:0},$r={key:1},Cr={key:0},Ur={for:"sms_code",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Vr=["placeholder"],Sr={class:"flex justify-end space-x-3 pt-4"},jr=["disabled"],Dr={key:0},Yr={key:1},Mr=s({__name:"TwoFactorSetupModal",props:{method:{}},emits:["close","success"],setup(t,{emit:s}){const r=t,l=s,g=e(),{showNotification:b}=S(),p=a(!1),f=a(1),h=a("both"===r.method?"sms":r.method),w=a(null),$=a(""),C=a(""),V=a(!1),j=async()=>{f.value=2,"totp"===h.value&&await D()},D=async()=>{try{p.value=!0;const e=await g.setupTwoFactor("totp");e.success?w.value=e.data:b({type:"error",title:"Setup failed",message:e.error||"Failed to setup two-factor authentication"})}catch(e){b({type:"error",title:"Setup failed",message:"An unexpected error occurred during setup"})}finally{p.value=!1}},Y=async()=>{try{p.value=!0;const e=await g.setupTwoFactor("sms");e.success?(V.value=!0,b({type:"success",title:"Code sent",message:"Verification code has been sent to your phone"})):b({type:"error",title:"Send failed",message:e.error||"Failed to send verification code"})}catch(e){b({type:"error",title:"Send failed",message:"An unexpected error occurred while sending the code"})}finally{p.value=!1}},M=async()=>{try{p.value=!0;const e=await g.verifyTwoFactor($.value);e.success?(b({type:"success",title:"Verification successful",message:"Two-factor authentication has been enabled"}),l("success")):b({type:"error",title:"Verification failed",message:e.error||"Invalid verification code"})}catch(e){b({type:"error",title:"Verification failed",message:"An unexpected error occurred during verification"})}finally{p.value=!1}};return o(()=>{"both"!==r.method&&(f.value=2,"totp"===r.method&&D())}),(e,t)=>(i(),d("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:t[9]||(t[9]=t=>e.$emit("close"))},[n("div",{class:"relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 lg:w-1/3 shadow-lg rounded-md bg-white dark:bg-gray-800",onClick:t[8]||(t[8]=x(()=>{},["stop"]))},[n("div",Ra,[n("h3",Ta,c(e.$t("settings.security.setup_2fa")),1),"both"===e.method&&1===f.value?(i(),d("div",Ea,[n("p",Pa,c(e.$t("settings.security.choose_2fa_method")),1),n("div",Ha,[n("label",Oa,[u(n("input",{type:"radio",value:"sms","onUpdate:modelValue":t[0]||(t[0]=e=>h.value=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[U,h.value]]),n("div",Ia,[n("div",Na,c(e.$t("settings.security.sms_method")),1),n("div",Ga,c(e.$t("settings.security.sms_method_desc")),1)])]),n("label",Ja,[u(n("input",{type:"radio",value:"totp","onUpdate:modelValue":t[1]||(t[1]=e=>h.value=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[U,h.value]]),n("div",Qa,[n("div",Ka,c(e.$t("settings.security.totp_method")),1),n("div",Wa,c(e.$t("settings.security.totp_method_desc")),1)])])]),n("div",Xa,[n("button",{type:"button",onClick:t[2]||(t[2]=t=>e.$emit("close")),class:"bg-white dark:bg-gray-700 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"},c(e.$t("common.cancel")),1),n("button",{type:"button",onClick:j,disabled:!h.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md disabled:opacity-50 disabled:cursor-not-allowed"},c(e.$t("common.continue")),9,Za)])])):("totp"===e.method||"totp"===h.value)&&f.value<=2?(i(),d("div",er,[w.value?(i(),d("div",ar,[n("div",rr,[n("p",lr,c(e.$t("settings.security.scan_qr_code")),1),t[11]||(t[11]=n("div",{class:"bg-white p-4 rounded-lg inline-block"},[n("div",{class:"w-48 h-48 bg-gray-200 flex items-center justify-center"},[n("span",{class:"text-gray-500"},"QR Code")])],-1)),n("p",or,[y(c(e.$t("settings.security.manual_entry"))+": ",1),n("code",ir,c(w.value.secret),1)])]),n("div",null,[n("label",dr,c(e.$t("settings.security.enter_verification_code")),1),u(n("input",{type:"text",id:"totp_code","onUpdate:modelValue":t[3]||(t[3]=e=>$.value=e),maxlength:"6",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm text-center text-lg tracking-widest",placeholder:e.$t("settings.security.six_digit_code")},null,8,nr),[[m,$.value]])]),w.value.backup_codes?(i(),d("div",cr,[n("h4",ur,c(e.$t("settings.security.backup_codes")),1),n("p",mr,c(e.$t("settings.security.backup_codes_desc")),1),n("div",gr,[(i(!0),d(k,null,_(w.value.backup_codes,e=>(i(),d("code",{key:e,class:"bg-yellow-100 dark:bg-yellow-800 px-2 py-1 rounded text-xs text-center"},c(e),1))),128))])])):v("",!0)])):(i(),d("div",tr,[t[10]||(t[10]=n("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"},null,-1)),n("p",sr,c(e.$t("settings.security.generating_qr")),1)])),n("div",br,[n("button",{type:"button",onClick:t[4]||(t[4]=t=>e.$emit("close")),class:"bg-white dark:bg-gray-700 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"},c(e.$t("common.cancel")),1),n("button",{type:"button",onClick:M,disabled:!$.value||6!==$.value.length||p.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(i(),d("span",yr,c(e.$t("common.verifying")),1)):(i(),d("span",xr,c(e.$t("common.verify")),1))],8,pr)])])):("sms"===e.method||"sms"===h.value)&&f.value<=2?(i(),d("div",fr,[n("p",kr,c(e.$t("settings.security.sms_setup_desc")),1),n("div",null,[n("label",_r,c(e.$t("settings.security.phone_number")),1),u(n("input",{type:"tel",id:"phone_number","onUpdate:modelValue":t[5]||(t[5]=e=>C.value=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.security.phone_placeholder")},null,8,vr),[[m,C.value]])]),n("button",{type:"button",onClick:Y,disabled:!C.value||p.value,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(i(),d("span",wr,c(e.$t("settings.security.sending_code")),1)):(i(),d("span",$r,c(e.$t("settings.security.send_verification_code")),1))],8,hr),V.value?(i(),d("div",Cr,[n("label",Ur,c(e.$t("settings.security.enter_sms_code")),1),u(n("input",{type:"text",id:"sms_code","onUpdate:modelValue":t[6]||(t[6]=e=>$.value=e),maxlength:"6",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm text-center text-lg tracking-widest",placeholder:e.$t("settings.security.six_digit_code")},null,8,Vr),[[m,$.value]])])):v("",!0),n("div",Sr,[n("button",{type:"button",onClick:t[7]||(t[7]=t=>e.$emit("close")),class:"bg-white dark:bg-gray-700 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"},c(e.$t("common.cancel")),1),V.value?(i(),d("button",{key:0,type:"button",onClick:M,disabled:!$.value||6!==$.value.length||p.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(i(),d("span",Dr,c(e.$t("common.verifying")),1)):(i(),d("span",Yr,c(e.$t("common.verify")),1))],8,jr)):v("",!0)])])):v("",!0)])])]))}}),Ar={class:"space-y-8"},Lr={class:"text-lg font-medium text-gray-900 dark:text-white"},qr={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},zr={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Br={class:"flex items-center justify-between mb-4"},Fr={class:"text-md font-medium text-gray-900 dark:text-white"},Rr={class:"text-sm text-gray-500 dark:text-gray-400"},Tr={class:"flex items-center"},Er={for:"two_factor_enabled",class:"ml-2 block text-sm text-gray-900 dark:text-white"},Pr={key:0,class:"space-y-4"},Hr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},Or={class:"space-y-2"},Ir={class:"flex items-center"},Nr={class:"ml-2 text-sm text-gray-900 dark:text-white"},Gr={class:"flex items-center"},Jr={class:"ml-2 text-sm text-gray-900 dark:text-white"},Qr={class:"flex items-center"},Kr={class:"ml-2 text-sm text-gray-900 dark:text-white"},Wr={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Xr={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},Zr={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},el={for:"session_timeout",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},tl={class:"mt-1 relative rounded-md shadow-sm"},sl=["placeholder"],al={class:"absolute inset-y-0 right-0 flex items-center pr-3"},rl={class:"text-gray-500 sm:text-sm"},ll={for:"max_login_attempts",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},ol=["placeholder"],il={for:"lockout_duration",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},dl={class:"mt-1 relative rounded-md shadow-sm"},nl=["placeholder"],cl={class:"absolute inset-y-0 right-0 flex items-center pr-3"},ul={class:"text-gray-500 sm:text-sm"},ml={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},gl={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},bl={class:"space-y-4"},pl={for:"password_min_length",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},yl={class:"space-y-2"},xl={class:"flex items-center"},fl={class:"ml-2 text-sm text-gray-900 dark:text-white"},kl={class:"flex items-center"},_l={class:"ml-2 text-sm text-gray-900 dark:text-white"},vl={class:"flex items-center"},hl={class:"ml-2 text-sm text-gray-900 dark:text-white"},wl={class:"flex items-center"},$l={class:"ml-2 text-sm text-gray-900 dark:text-white"},Cl={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Ul={class:"flex items-center justify-between mb-4"},Vl={class:"text-md font-medium text-gray-900 dark:text-white"},Sl={class:"text-sm text-gray-500 dark:text-gray-400"},jl={class:"flex items-center"},Dl={for:"ip_whitelist_enabled",class:"ml-2 block text-sm text-gray-900 dark:text-white"},Yl={key:0,class:"space-y-4"},Ml={for:"ip_address",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Al={class:"mt-1 flex rounded-md shadow-sm"},Ll=["placeholder"],ql={key:0},zl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Bl={class:"space-y-2"},Fl={class:"text-sm text-gray-900 dark:text-white"},Rl=["onClick"],Tl={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},El={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},Pl={class:"space-y-4"},Hl={class:"flex items-center"},Ol={class:"ml-2 text-sm text-gray-900 dark:text-white"},Il={for:"audit_log_retention",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Nl={class:"mt-1 relative rounded-md shadow-sm"},Gl=["placeholder"],Jl={class:"absolute inset-y-0 right-0 flex items-center pr-3"},Ql={class:"text-gray-500 sm:text-sm"},Kl={key:0,class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Wl={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},Xl={class:"space-y-3"},Zl={class:"text-sm font-medium text-gray-900 dark:text-white"},eo={class:"text-xs text-gray-500 dark:text-gray-400"},to={class:"flex space-x-2"},so=["onClick"],ao=["onClick"],ro={class:"flex justify-end"},lo=["disabled"],oo={key:0,class:"flex items-center"},io={key:1},no=s({__name:"SecuritySettings",setup(t){const s=e(),{showNotification:g}=S(),$=a(!1),C=a(!1),V=a(""),j=r({two_factor_enabled:!1,two_factor_method:"sms",session_timeout:30,max_login_attempts:5,lockout_duration:15,password_min_length:8,password_require_uppercase:!0,password_require_lowercase:!0,password_require_numbers:!0,password_require_symbols:!1,ip_whitelist_enabled:!1,ip_whitelist:[],audit_log_retention:365,login_anomaly_detection:!0}),D=f(()=>s.loginAnomalies);l(()=>s.securitySettings,e=>{e&&Object.assign(j,e)},{immediate:!0});const Y=()=>{j.two_factor_enabled&&M()},M=()=>{C.value=!0},A=()=>{C.value=!1,g({type:"success",title:"Two-factor authentication enabled",message:"Your account is now more secure with 2FA enabled"})},L=()=>{if(!V.value.trim())return;/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(V.value.trim())?(j.ip_whitelist||(j.ip_whitelist=[]),j.ip_whitelist.includes(V.value.trim())?g({type:"warning",title:"IP already exists",message:"This IP address is already in the whitelist"}):(j.ip_whitelist.push(V.value.trim()),V.value="")):g({type:"error",title:"Invalid IP address",message:"Please enter a valid IP address"})},q=async(e,t)=>{try{const a=await s.updateAnomalyStatus(e,t);a.success?g({type:"success",title:"Status updated",message:`Login anomaly has been ${t}`}):g({type:"error",title:"Update failed",message:a.error||"Failed to update anomaly status"})}catch(a){g({type:"error",title:"Update failed",message:"An unexpected error occurred"})}},z=async()=>{try{$.value=!0;const e=await s.updateSecuritySettings(j);e.success?g({type:"success",title:"Security settings saved",message:"Your security settings have been updated successfully"}):g({type:"error",title:"Save failed",message:e.error||"Failed to save security settings"})}catch(e){g({type:"error",title:"Save failed",message:"An unexpected error occurred while saving"})}finally{$.value=!1}};return o(async()=>{s.securitySettings||await s.fetchSettings(),await s.fetchLoginAnomalies()}),(e,t)=>(i(),d("div",Ar,[n("div",null,[n("h3",Lr,c(e.$t("settings.security.title")),1),n("p",qr,c(e.$t("settings.security.description")),1)]),n("form",{onSubmit:x(z,["prevent"]),class:"space-y-8"},[n("div",zr,[n("div",Br,[n("div",null,[n("h4",Fr,c(e.$t("settings.security.two_factor_auth")),1),n("p",Rr,c(e.$t("settings.security.two_factor_description")),1)]),n("div",Tr,[u(n("input",{id:"two_factor_enabled",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>j.two_factor_enabled=e),onChange:Y,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,544),[[h,j.two_factor_enabled]]),n("label",Er,c(e.$t("settings.security.enable_2fa")),1)])]),j.two_factor_enabled?(i(),d("div",Pr,[n("div",null,[n("label",Hr,c(e.$t("settings.security.two_factor_method")),1),n("div",Or,[n("label",Ir,[u(n("input",{type:"radio",value:"sms","onUpdate:modelValue":t[1]||(t[1]=e=>j.two_factor_method=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[U,j.two_factor_method]]),n("span",Nr,c(e.$t("settings.security.sms_method")),1)]),n("label",Gr,[u(n("input",{type:"radio",value:"totp","onUpdate:modelValue":t[2]||(t[2]=e=>j.two_factor_method=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[U,j.two_factor_method]]),n("span",Jr,c(e.$t("settings.security.totp_method")),1)]),n("label",Qr,[u(n("input",{type:"radio",value:"both","onUpdate:modelValue":t[3]||(t[3]=e=>j.two_factor_method=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[U,j.two_factor_method]]),n("span",Kr,c(e.$t("settings.security.both_methods")),1)])])]),n("button",{type:"button",onClick:M,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},c(e.$t("settings.security.setup_2fa")),1)])):v("",!0)]),n("div",Wr,[n("h4",Xr,c(e.$t("settings.security.session_management")),1),n("div",Zr,[n("div",null,[n("label",el,c(e.$t("settings.security.session_timeout")),1),n("div",tl,[u(n("input",{type:"number",id:"session_timeout","onUpdate:modelValue":t[4]||(t[4]=e=>j.session_timeout=e),min:"5",max:"1440",class:"block w-full rounded-md border-gray-300 pr-20 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.security.session_timeout_placeholder")},null,8,sl),[[m,j.session_timeout,void 0,{number:!0}]]),n("div",al,[n("span",rl,c(e.$t("common.minutes")),1)])])]),n("div",null,[n("label",ll,c(e.$t("settings.security.max_login_attempts")),1),u(n("input",{type:"number",id:"max_login_attempts","onUpdate:modelValue":t[5]||(t[5]=e=>j.max_login_attempts=e),min:"3",max:"10",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.security.max_login_attempts_placeholder")},null,8,ol),[[m,j.max_login_attempts,void 0,{number:!0}]])]),n("div",null,[n("label",il,c(e.$t("settings.security.lockout_duration")),1),n("div",dl,[u(n("input",{type:"number",id:"lockout_duration","onUpdate:modelValue":t[6]||(t[6]=e=>j.lockout_duration=e),min:"5",max:"1440",class:"block w-full rounded-md border-gray-300 pr-20 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.security.lockout_duration_placeholder")},null,8,nl),[[m,j.lockout_duration,void 0,{number:!0}]]),n("div",cl,[n("span",ul,c(e.$t("common.minutes")),1)])])])])]),n("div",ml,[n("h4",gl,c(e.$t("settings.security.password_policy")),1),n("div",bl,[n("div",null,[n("label",pl,c(e.$t("settings.security.password_min_length")),1),u(n("input",{type:"number",id:"password_min_length","onUpdate:modelValue":t[7]||(t[7]=e=>j.password_min_length=e),min:"6",max:"32",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},null,512),[[m,j.password_min_length,void 0,{number:!0}]])]),n("div",yl,[n("label",xl,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>j.password_require_uppercase=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.password_require_uppercase]]),n("span",fl,c(e.$t("settings.security.require_uppercase")),1)]),n("label",kl,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>j.password_require_lowercase=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.password_require_lowercase]]),n("span",_l,c(e.$t("settings.security.require_lowercase")),1)]),n("label",vl,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=e=>j.password_require_numbers=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.password_require_numbers]]),n("span",hl,c(e.$t("settings.security.require_numbers")),1)]),n("label",wl,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=e=>j.password_require_symbols=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.password_require_symbols]]),n("span",$l,c(e.$t("settings.security.require_symbols")),1)])])])]),n("div",Cl,[n("div",Ul,[n("div",null,[n("h4",Vl,c(e.$t("settings.security.ip_whitelist")),1),n("p",Sl,c(e.$t("settings.security.ip_whitelist_description")),1)]),n("div",jl,[u(n("input",{id:"ip_whitelist_enabled",type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=e=>j.ip_whitelist_enabled=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.ip_whitelist_enabled]]),n("label",Dl,c(e.$t("settings.security.enable_ip_whitelist")),1)])]),j.ip_whitelist_enabled?(i(),d("div",Yl,[n("div",null,[n("label",Ml,c(e.$t("settings.security.add_ip_address")),1),n("div",Al,[u(n("input",{type:"text",id:"ip_address","onUpdate:modelValue":t[13]||(t[13]=e=>V.value=e),class:"flex-1 rounded-none rounded-l-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.security.ip_address_placeholder")},null,8,Ll),[[m,V.value]]),n("button",{type:"button",onClick:L,class:"relative -ml-px inline-flex items-center space-x-2 rounded-r-md border border-gray-300 bg-gray-50 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700"},c(e.$t("common.add")),1)])]),j.ip_whitelist&&j.ip_whitelist.length>0?(i(),d("div",ql,[n("label",zl,c(e.$t("settings.security.whitelisted_ips")),1),n("div",Bl,[(i(!0),d(k,null,_(j.ip_whitelist,(e,t)=>(i(),d("div",{key:t,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700 rounded-md px-3 py-2"},[n("span",Fl,c(e),1),n("button",{type:"button",onClick:e=>(e=>{j.ip_whitelist&&j.ip_whitelist.splice(e,1)})(t),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},[b(p(R),{class:"h-4 w-4"})],8,Rl)]))),128))])])):v("",!0)])):v("",!0)]),n("div",Tl,[n("h4",El,c(e.$t("settings.security.advanced_security")),1),n("div",Pl,[n("label",Hl,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=e=>j.login_anomaly_detection=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.login_anomaly_detection]]),n("span",Ol,c(e.$t("settings.security.enable_anomaly_detection")),1)]),n("div",null,[n("label",Il,c(e.$t("settings.security.audit_log_retention")),1),n("div",Nl,[u(n("input",{type:"number",id:"audit_log_retention","onUpdate:modelValue":t[15]||(t[15]=e=>j.audit_log_retention=e),min:"30",max:"3650",class:"block w-full rounded-md border-gray-300 pr-16 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.security.audit_log_retention_placeholder")},null,8,Gl),[[m,j.audit_log_retention,void 0,{number:!0}]]),n("div",Jl,[n("span",Ql,c(e.$t("common.days")),1)])])])])]),D.value.length>0?(i(),d("div",Kl,[n("h4",Wl,c(e.$t("settings.security.recent_anomalies")),1),n("div",Xl,[(i(!0),d(k,null,_(D.value.slice(0,5),t=>{return i(),d("div",{key:t.id,class:"flex items-center justify-between p-3 bg-yellow-50 dark:bg-yellow-900 rounded-lg"},[n("div",null,[n("div",Zl,c(t.anomaly_type.replace("_"," ").toUpperCase()),1),n("div",eo,c(t.ip_address)+" â€¢ "+c((s=t.created_at,new Date(s).toLocaleDateString())),1)]),n("div",to,[n("button",{onClick:e=>q(t.id,"approved"),class:"text-green-600 hover:text-green-900 dark:text-green-400 text-xs font-medium"},c(e.$t("common.approve")),9,so),n("button",{onClick:e=>q(t.id,"blocked"),class:"text-red-600 hover:text-red-900 dark:text-red-400 text-xs font-medium"},c(e.$t("common.block")),9,ao)])]);var s}),128))])])):v("",!0),n("div",ro,[n("button",{type:"submit",disabled:$.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[$.value?(i(),d("span",oo,[t[17]||(t[17]=n("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+c(e.$t("common.saving")),1)])):(i(),d("span",io,c(e.$t("common.save")),1))],8,lo)])],32),C.value?(i(),w(Mr,{key:0,method:j.two_factor_method||"sms",onClose:t[16]||(t[16]=e=>C.value=!1),onSuccess:A},null,8,["method"])):v("",!0)]))}}),co={class:"space-y-8"},uo={class:"text-lg font-medium text-gray-900 dark:text-white"},mo={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},go={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},bo={class:"flex items-center justify-between mb-4"},po={class:"text-md font-medium text-gray-900 dark:text-white"},yo={class:"text-sm text-gray-500 dark:text-gray-400"},xo={class:"flex items-center"},fo={for:"auto_backup_enabled",class:"ml-2 block text-sm text-gray-900 dark:text-white"},ko={key:0,class:"space-y-6"},_o={class:"grid grid-cols-1 gap-6 sm:grid-cols-3"},vo={for:"backup_frequency",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},ho={value:"daily"},wo={value:"weekly"},$o={value:"monthly"},Co={for:"backup_time",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Uo={for:"backup_retention",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Vo={class:"mt-1 relative rounded-md shadow-sm"},So=["placeholder"],jo={class:"absolute inset-y-0 right-0 flex items-center pr-3"},Do={class:"text-gray-500 sm:text-sm"},Yo={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Mo={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},Ao={class:"space-y-4"},Lo={class:"space-y-2"},qo={class:"flex items-center"},zo={class:"ml-2 text-sm text-gray-900 dark:text-white"},Bo={class:"ml-6 text-xs text-gray-500 dark:text-gray-400"},Fo={class:"flex items-center"},Ro={class:"ml-2 text-sm text-gray-900 dark:text-white"},To={class:"ml-6 text-xs text-gray-500 dark:text-gray-400"},Eo={key:0,class:"ml-6 space-y-4 border-l-2 border-gray-200 dark:border-gray-700 pl-4"},Po={for:"cloud_provider",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Ho={key:0,class:"space-y-4"},Oo={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Io={for:"aws_access_key",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},No=["placeholder"],Go={for:"aws_secret_key",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Jo=["placeholder"],Qo={for:"aws_region",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Ko=["placeholder"],Wo={for:"aws_bucket",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Xo=["placeholder"],Zo=["disabled"],ei={key:0,class:"flex items-center"},ti={key:1},si={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},ai={class:"text-md font-medium text-gray-900 dark:text-white mb-4"},ri={class:"space-y-4"},li={class:"flex items-center"},oi={class:"ml-2 text-sm text-gray-900 dark:text-white"},ii={class:"flex items-center"},di={class:"ml-2 text-sm text-gray-900 dark:text-white"},ni={class:"flex items-center"},ci={class:"ml-2 text-sm text-gray-900 dark:text-white"},ui={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},mi={class:"space-y-2"},gi=["value"],bi={class:"ml-2 text-sm text-gray-900 dark:text-white"},pi={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},yi={class:"flex items-center justify-between"},xi={class:"text-md font-medium text-gray-900 dark:text-white"},fi={class:"text-sm text-gray-500 dark:text-gray-400"},ki=["disabled"],_i={key:0,class:"flex items-center"},vi={key:1},hi={class:"flex justify-end"},wi=["disabled"],$i={key:0,class:"flex items-center"},Ci={key:1},Ui=s({__name:"BackupSettings",setup(t){const s=e(),{showNotification:b}=S(),p=a(!1),f=a(!1),w=a(!1),$=r({auto_backup_enabled:!1,backup_frequency:"daily",backup_time:"02:00",backup_retention:30,backup_location:"local",cloud_provider:"aws",backup_encryption:!0,backup_compression:!0,include_files:!0,exclude_tables:[]}),C=r({aws_access_key_id:"",aws_secret_access_key:"",aws_region:"us-east-1",aws_bucket:""}),V=["sessions","password_resets","failed_jobs","audit_logs","login_anomalies"];l(()=>s.backupSettings,e=>{e&&(Object.assign($,e),e.cloud_credentials&&Object.assign(C,e.cloud_credentials))},{immediate:!0});const j=async()=>{try{f.value=!0;const e=await s.testBackupConnection();e.success?b({type:"success",title:"Connection successful",message:"Successfully connected to the backup storage"}):b({type:"error",title:"Connection failed",message:e.error||"Failed to connect to backup storage"})}catch(e){b({type:"error",title:"Connection failed",message:"An unexpected error occurred while testing the connection"})}finally{f.value=!1}},D=async()=>{try{w.value=!0;const e=await s.createBackup();e.success?b({type:"success",title:"Backup created",message:"Manual backup has been created successfully"}):b({type:"error",title:"Backup failed",message:e.error||"Failed to create backup"})}catch(e){b({type:"error",title:"Backup failed",message:"An unexpected error occurred while creating the backup"})}finally{w.value=!1}},Y=async()=>{try{p.value=!0;const e={...$,cloud_credentials:"cloud"===$.backup_location?C:void 0},t=await s.updateBackupSettings(e);t.success?b({type:"success",title:"Backup settings saved",message:"Your backup settings have been updated successfully"}):b({type:"error",title:"Save failed",message:t.error||"Failed to save backup settings"})}catch(e){b({type:"error",title:"Save failed",message:"An unexpected error occurred while saving"})}finally{p.value=!1}};return o(()=>{s.backupSettings||s.fetchSettings()}),(e,t)=>(i(),d("div",co,[n("div",null,[n("h3",uo,c(e.$t("settings.backup.title")),1),n("p",mo,c(e.$t("settings.backup.description")),1)]),n("form",{onSubmit:x(Y,["prevent"]),class:"space-y-8"},[n("div",go,[n("div",bo,[n("div",null,[n("h4",po,c(e.$t("settings.backup.automatic_backup")),1),n("p",yo,c(e.$t("settings.backup.automatic_backup_description")),1)]),n("div",xo,[u(n("input",{id:"auto_backup_enabled",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>$.auto_backup_enabled=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,$.auto_backup_enabled]]),n("label",fo,c(e.$t("settings.backup.enable_auto_backup")),1)])]),$.auto_backup_enabled?(i(),d("div",ko,[n("div",_o,[n("div",null,[n("label",vo,c(e.$t("settings.backup.backup_frequency")),1),u(n("select",{id:"backup_frequency","onUpdate:modelValue":t[1]||(t[1]=e=>$.backup_frequency=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},[n("option",ho,c(e.$t("settings.backup.daily")),1),n("option",wo,c(e.$t("settings.backup.weekly")),1),n("option",$o,c(e.$t("settings.backup.monthly")),1)],512),[[g,$.backup_frequency]])]),n("div",null,[n("label",Co,c(e.$t("settings.backup.backup_time")),1),u(n("input",{type:"time",id:"backup_time","onUpdate:modelValue":t[2]||(t[2]=e=>$.backup_time=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},null,512),[[m,$.backup_time]])]),n("div",null,[n("label",Uo,c(e.$t("settings.backup.backup_retention")),1),n("div",Vo,[u(n("input",{type:"number",id:"backup_retention","onUpdate:modelValue":t[3]||(t[3]=e=>$.backup_retention=e),min:"1",max:"365",class:"block w-full rounded-md border-gray-300 pr-16 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.backup.retention_placeholder")},null,8,So),[[m,$.backup_retention,void 0,{number:!0}]]),n("div",jo,[n("span",Do,c(e.$t("common.days")),1)])])])])])):v("",!0)]),n("div",Yo,[n("h4",Mo,c(e.$t("settings.backup.backup_location")),1),n("div",Ao,[n("div",Lo,[n("label",qo,[u(n("input",{type:"radio",value:"local","onUpdate:modelValue":t[4]||(t[4]=e=>$.backup_location=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[U,$.backup_location]]),n("span",zo,c(e.$t("settings.backup.local_storage")),1)]),n("p",Bo,c(e.$t("settings.backup.local_storage_desc")),1),n("label",Fo,[u(n("input",{type:"radio",value:"cloud","onUpdate:modelValue":t[5]||(t[5]=e=>$.backup_location=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[U,$.backup_location]]),n("span",Ro,c(e.$t("settings.backup.cloud_storage")),1)]),n("p",To,c(e.$t("settings.backup.cloud_storage_desc")),1)]),"cloud"===$.backup_location?(i(),d("div",Eo,[n("div",null,[n("label",Po,c(e.$t("settings.backup.cloud_provider")),1),u(n("select",{id:"cloud_provider","onUpdate:modelValue":t[6]||(t[6]=e=>$.cloud_provider=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},t[15]||(t[15]=[n("option",{value:"aws"},"Amazon S3",-1),n("option",{value:"google"},"Google Cloud Storage",-1),n("option",{value:"azure"},"Azure Blob Storage",-1)]),512),[[g,$.cloud_provider]])]),"aws"===$.cloud_provider?(i(),d("div",Ho,[n("div",Oo,[n("div",null,[n("label",Io,c(e.$t("settings.backup.aws_access_key")),1),u(n("input",{type:"text",id:"aws_access_key","onUpdate:modelValue":t[7]||(t[7]=e=>C.aws_access_key_id=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.backup.aws_access_key_placeholder")},null,8,No),[[m,C.aws_access_key_id]])]),n("div",null,[n("label",Go,c(e.$t("settings.backup.aws_secret_key")),1),u(n("input",{type:"password",id:"aws_secret_key","onUpdate:modelValue":t[8]||(t[8]=e=>C.aws_secret_access_key=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.backup.aws_secret_key_placeholder")},null,8,Jo),[[m,C.aws_secret_access_key]])]),n("div",null,[n("label",Qo,c(e.$t("settings.backup.aws_region")),1),u(n("input",{type:"text",id:"aws_region","onUpdate:modelValue":t[9]||(t[9]=e=>C.aws_region=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.backup.aws_region_placeholder")},null,8,Ko),[[m,C.aws_region]])]),n("div",null,[n("label",Wo,c(e.$t("settings.backup.aws_bucket")),1),u(n("input",{type:"text",id:"aws_bucket","onUpdate:modelValue":t[10]||(t[10]=e=>C.aws_bucket=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.backup.aws_bucket_placeholder")},null,8,Xo),[[m,C.aws_bucket]])])])])):v("",!0),n("button",{type:"button",onClick:j,disabled:f.value,class:"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed"},[f.value?(i(),d("span",ei,[t[16]||(t[16]=n("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+c(e.$t("settings.backup.testing_connection")),1)])):(i(),d("span",ti,c(e.$t("settings.backup.test_connection")),1))],8,Zo)])):v("",!0)])]),n("div",si,[n("h4",ai,c(e.$t("settings.backup.backup_options")),1),n("div",ri,[n("label",li,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=e=>$.backup_encryption=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,$.backup_encryption]]),n("span",oi,c(e.$t("settings.backup.enable_encryption")),1)]),n("label",ii,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=e=>$.backup_compression=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,$.backup_compression]]),n("span",di,c(e.$t("settings.backup.enable_compression")),1)]),n("label",ni,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=e=>$.include_files=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,$.include_files]]),n("span",ci,c(e.$t("settings.backup.include_files")),1)]),n("div",null,[n("label",ui,c(e.$t("settings.backup.exclude_tables")),1),n("div",mi,[(i(),d(k,null,_(V,e=>n("label",{key:e,class:"flex items-center"},[u(n("input",{type:"checkbox",value:e,"onUpdate:modelValue":t[14]||(t[14]=e=>$.exclude_tables=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,8,gi),[[h,$.exclude_tables]]),n("span",bi,c(e),1)])),64))])])])]),n("div",pi,[n("div",yi,[n("div",null,[n("h4",xi,c(e.$t("settings.backup.manual_backup")),1),n("p",fi,c(e.$t("settings.backup.manual_backup_description")),1)]),n("button",{type:"button",onClick:D,disabled:w.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[w.value?(i(),d("span",_i,[t[17]||(t[17]=n("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+c(e.$t("settings.backup.creating_backup")),1)])):(i(),d("span",vi,c(e.$t("settings.backup.create_backup")),1))],8,ki)])]),n("div",hi,[n("button",{type:"submit",disabled:p.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(i(),d("span",$i,[t[18]||(t[18]=n("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+c(e.$t("common.saving")),1)])):(i(),d("span",Ci,c(e.$t("common.save")),1))],8,wi)])],32)]))}}),Vi={class:"space-y-8"},Si={class:"text-lg font-medium text-gray-900 dark:text-white"},ji={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Di={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Yi={class:"flex items-center justify-between mb-4"},Mi={class:"text-md font-medium text-gray-900 dark:text-white"},Ai={class:"text-sm text-gray-500 dark:text-gray-400"},Li={class:"flex items-center"},qi={for:"audit_enabled",class:"ml-2 block text-sm text-gray-900 dark:text-white"},zi={key:0,class:"space-y-6"},Bi={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},Fi={for:"log_level",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Ri={value:"basic"},Ti={value:"detailed"},Ei={value:"verbose"},Pi={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Hi={for:"retention_days",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Oi={class:"mt-1 relative rounded-md shadow-sm"},Ii=["placeholder"],Ni={class:"absolute inset-y-0 right-0 flex items-center pr-3"},Gi={class:"text-gray-500 sm:text-sm"},Ji={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},Qi={class:"space-y-2"},Ki={class:"flex items-center"},Wi={class:"ml-2 text-sm text-gray-900 dark:text-white"},Xi={class:"flex items-center"},Zi={class:"ml-2 text-sm text-gray-900 dark:text-white"},ed={class:"flex items-center"},td={class:"ml-2 text-sm text-gray-900 dark:text-white"},sd={class:"flex items-center"},ad={class:"ml-2 text-sm text-gray-900 dark:text-white"},rd={class:"flex items-center"},ld={class:"ml-2 text-sm text-gray-900 dark:text-white"},od={class:"flex items-center"},id={class:"ml-2 text-sm text-gray-900 dark:text-white"},dd={class:"ml-6 text-xs text-gray-500 dark:text-gray-400"},nd={for:"export_format",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},cd={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},ud={class:"flex items-center justify-between mb-4"},md={class:"text-md font-medium text-gray-900 dark:text-white"},gd={class:"flex space-x-2"},bd=["disabled"],pd=["disabled"],yd={class:"mb-4 grid grid-cols-1 gap-4 sm:grid-cols-4"},xd={for:"filter_action",class:"block text-xs font-medium text-gray-700 dark:text-gray-300"},fd=["placeholder"],kd={for:"filter_user",class:"block text-xs font-medium text-gray-700 dark:text-gray-300"},_d=["placeholder"],vd={for:"filter_date_from",class:"block text-xs font-medium text-gray-700 dark:text-gray-300"},hd={for:"filter_date_to",class:"block text-xs font-medium text-gray-700 dark:text-gray-300"},wd={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},$d={class:"min-w-full divide-y divide-gray-300 dark:divide-gray-700"},Cd={class:"bg-gray-50 dark:bg-gray-700"},Ud={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Vd={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Sd={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},jd={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Dd={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Yd={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Md={key:0},Ad={colspan:"5",class:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400"},Ld={class:"flex items-center justify-center"},qd={key:1},zd={colspan:"5",class:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400"},Bd={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Fd={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Rd={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Td={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Ed={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Pd=["onClick"],Hd={class:"flex justify-end"},Od=["disabled"],Id={key:0,class:"flex items-center"},Nd={key:1},Gd={class:"mt-3"},Jd={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},Qd={class:"space-y-4"},Kd={class:"grid grid-cols-2 gap-4"},Wd={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Xd={class:"text-sm text-gray-900 dark:text-white"},Zd={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},en={class:"text-sm text-gray-900 dark:text-white"},tn={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},sn={class:"text-sm text-gray-900 dark:text-white"},an={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},rn={class:"text-sm text-gray-900 dark:text-white"},ln={key:0},on={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},dn={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},nn={class:"text-xs text-gray-900 dark:text-white overflow-auto"},cn={class:"flex justify-end pt-4"},un=s({__name:"AuditLogSettings",setup(t){const s=e(),{showNotification:w}=S(),$=a(!1),C=a(!1),U=a(!1),V=a(null),j=r({enabled:!0,log_level:"detailed",retention_days:365,log_user_actions:!0,log_system_events:!0,log_api_requests:!1,log_database_changes:!0,log_file_operations:!1,alert_on_suspicious_activity:!0,export_format:"json"}),D=r({action:"",user:"",date_from:"",date_to:""}),Y=f(()=>{let e=s.auditLogs;return D.action&&(e=e.filter(e=>e.action.toLowerCase().includes(D.action.toLowerCase()))),D.user&&(e=e.filter(e=>{var t,s;return null==(s=null==(t=e.user)?void 0:t.name)?void 0:s.toLowerCase().includes(D.user.toLowerCase())})),D.date_from&&(e=e.filter(e=>new Date(e.created_at)>=new Date(D.date_from))),D.date_to&&(e=e.filter(e=>new Date(e.created_at)<=new Date(D.date_to))),e});l(()=>s.auditSettings,e=>{e&&Object.assign(j,e)},{immediate:!0}),l(D,()=>{},{deep:!0});const M=e=>new Date(e).toLocaleString(),A=e=>{const t={};return e.old_values&&(t.old=e.old_values),e.new_values&&(t.new=e.new_values),JSON.stringify(t,null,2)},L=async()=>{try{C.value=!0,await s.fetchAuditLogs(D)}catch(e){w({type:"error",title:"Refresh failed",message:"Failed to refresh audit logs"})}finally{C.value=!1}},q=async()=>{try{U.value=!0;const e=await s.exportAuditLogs(j.export_format||"json",D);if(e.success){const t=new Blob([e.data],{type:"csv"===j.export_format?"text/csv":"application/json"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`audit-logs-${(new Date).toISOString().split("T")[0]}.${j.export_format}`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(s),w({type:"success",title:"Export successful",message:"Audit logs have been exported successfully"})}else w({type:"error",title:"Export failed",message:e.error||"Failed to export audit logs"})}catch(e){w({type:"error",title:"Export failed",message:"An unexpected error occurred during export"})}finally{U.value=!1}},z=async()=>{try{$.value=!0;const e=await s.updateAuditSettings(j);e.success?w({type:"success",title:"Audit settings saved",message:"Your audit log settings have been updated successfully"}):w({type:"error",title:"Save failed",message:e.error||"Failed to save audit settings"})}catch(e){w({type:"error",title:"Save failed",message:"An unexpected error occurred while saving"})}finally{$.value=!1}};return o(async()=>{s.auditSettings||await s.fetchSettings(),await L()}),(e,t)=>{var s;return i(),d("div",Vi,[n("div",null,[n("h3",Si,c(e.$t("settings.audit.title")),1),n("p",ji,c(e.$t("settings.audit.description")),1)]),n("form",{onSubmit:x(z,["prevent"]),class:"space-y-8"},[n("div",Di,[n("div",Yi,[n("div",null,[n("h4",Mi,c(e.$t("settings.audit.audit_logging")),1),n("p",Ai,c(e.$t("settings.audit.audit_logging_description")),1)]),n("div",Li,[u(n("input",{id:"audit_enabled",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>j.enabled=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.enabled]]),n("label",qi,c(e.$t("settings.audit.enable_audit_logging")),1)])]),j.enabled?(i(),d("div",zi,[n("div",Bi,[n("div",null,[n("label",Fi,c(e.$t("settings.audit.log_level")),1),u(n("select",{id:"log_level","onUpdate:modelValue":t[1]||(t[1]=e=>j.log_level=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},[n("option",Ri,c(e.$t("settings.audit.basic")),1),n("option",Ti,c(e.$t("settings.audit.detailed")),1),n("option",Ei,c(e.$t("settings.audit.verbose")),1)],512),[[g,j.log_level]]),n("p",Pi,c(e.$t(`settings.audit.${j.log_level}_description`)),1)]),n("div",null,[n("label",Hi,c(e.$t("settings.audit.retention_days")),1),n("div",Oi,[u(n("input",{type:"number",id:"retention_days","onUpdate:modelValue":t[2]||(t[2]=e=>j.retention_days=e),min:"30",max:"3650",class:"block w-full rounded-md border-gray-300 pr-16 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.audit.retention_placeholder")},null,8,Ii),[[m,j.retention_days,void 0,{number:!0}]]),n("div",Ni,[n("span",Gi,c(e.$t("common.days")),1)])])])]),n("div",null,[n("label",Ji,c(e.$t("settings.audit.log_types")),1),n("div",Qi,[n("label",Ki,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>j.log_user_actions=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.log_user_actions]]),n("span",Wi,c(e.$t("settings.audit.log_user_actions")),1)]),n("label",Xi,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>j.log_system_events=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.log_system_events]]),n("span",Zi,c(e.$t("settings.audit.log_system_events")),1)]),n("label",ed,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>j.log_api_requests=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.log_api_requests]]),n("span",td,c(e.$t("settings.audit.log_api_requests")),1)]),n("label",sd,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>j.log_database_changes=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.log_database_changes]]),n("span",ad,c(e.$t("settings.audit.log_database_changes")),1)]),n("label",rd,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>j.log_file_operations=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.log_file_operations]]),n("span",ld,c(e.$t("settings.audit.log_file_operations")),1)])])]),n("div",null,[n("label",od,[u(n("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>j.alert_on_suspicious_activity=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[h,j.alert_on_suspicious_activity]]),n("span",id,c(e.$t("settings.audit.alert_on_suspicious_activity")),1)]),n("p",dd,c(e.$t("settings.audit.alert_description")),1)]),n("div",null,[n("label",nd,c(e.$t("settings.audit.export_format")),1),u(n("select",{id:"export_format","onUpdate:modelValue":t[9]||(t[9]=e=>j.export_format=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},t[17]||(t[17]=[n("option",{value:"json"},"JSON",-1),n("option",{value:"csv"},"CSV",-1),n("option",{value:"xml"},"XML",-1)]),512),[[g,j.export_format]])])])):v("",!0)]),n("div",cd,[n("div",ud,[n("h4",md,c(e.$t("settings.audit.recent_logs")),1),n("div",gd,[n("button",{type:"button",onClick:L,disabled:C.value,class:"bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-3 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed"},[b(p(T),{class:"h-4 w-4"})],8,bd),n("button",{type:"button",onClick:q,disabled:U.value,class:"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-3 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed"},[b(p(E),{class:"h-4 w-4"})],8,pd)])]),n("div",yd,[n("div",null,[n("label",xd,c(e.$t("settings.audit.filter_action")),1),u(n("input",{type:"text",id:"filter_action","onUpdate:modelValue":t[10]||(t[10]=e=>D.action=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.audit.filter_action_placeholder")},null,8,fd),[[m,D.action]])]),n("div",null,[n("label",kd,c(e.$t("settings.audit.filter_user")),1),u(n("input",{type:"text",id:"filter_user","onUpdate:modelValue":t[11]||(t[11]=e=>D.user=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",placeholder:e.$t("settings.audit.filter_user_placeholder")},null,8,_d),[[m,D.user]])]),n("div",null,[n("label",vd,c(e.$t("settings.audit.filter_date_from")),1),u(n("input",{type:"date",id:"filter_date_from","onUpdate:modelValue":t[12]||(t[12]=e=>D.date_from=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},null,512),[[m,D.date_from]])]),n("div",null,[n("label",hd,c(e.$t("settings.audit.filter_date_to")),1),u(n("input",{type:"date",id:"filter_date_to","onUpdate:modelValue":t[13]||(t[13]=e=>D.date_to=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},null,512),[[m,D.date_to]])])]),n("div",wd,[n("table",$d,[n("thead",Cd,[n("tr",null,[n("th",Ud,c(e.$t("settings.audit.timestamp")),1),n("th",Vd,c(e.$t("settings.audit.user")),1),n("th",Sd,c(e.$t("settings.audit.action")),1),n("th",jd,c(e.$t("settings.audit.ip_address")),1),n("th",Dd,c(e.$t("common.actions")),1)])]),n("tbody",Yd,[C.value?(i(),d("tr",Md,[n("td",Ad,[n("div",Ld,[t[18]||(t[18]=n("svg",{class:"animate-spin h-5 w-5 text-gray-400 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+c(e.$t("common.loading")),1)])])])):0===Y.value.length?(i(),d("tr",qd,[n("td",zd,c(e.$t("settings.audit.no_logs")),1)])):(i(!0),d(k,{key:2},_(Y.value.slice(0,10),t=>{var s;return i(),d("tr",{key:t.id},[n("td",Bd,c(M(t.created_at)),1),n("td",Fd,c((null==(s=t.user)?void 0:s.name)||e.$t("settings.audit.system")),1),n("td",Rd,c(t.action),1),n("td",Td,c(t.ip_address),1),n("td",Ed,[n("button",{onClick:e=>(e=>{V.value=e})(t),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300"},c(e.$t("common.view")),9,Pd)])])}),128))])])])]),n("div",Hd,[n("button",{type:"submit",disabled:$.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[$.value?(i(),d("span",Id,[t[19]||(t[19]=n("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+c(e.$t("common.saving")),1)])):(i(),d("span",Nd,c(e.$t("common.save")),1))],8,Od)])],32),V.value?(i(),d("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:t[16]||(t[16]=e=>V.value=null)},[n("div",{class:"relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-md bg-white dark:bg-gray-800",onClick:t[15]||(t[15]=x(()=>{},["stop"]))},[n("div",Gd,[n("h3",Jd,c(e.$t("settings.audit.log_details")),1),n("div",Qd,[n("div",Kd,[n("div",null,[n("label",Wd,c(e.$t("settings.audit.timestamp")),1),n("p",Xd,c(M(V.value.created_at)),1)]),n("div",null,[n("label",Zd,c(e.$t("settings.audit.user")),1),n("p",en,c((null==(s=V.value.user)?void 0:s.name)||e.$t("settings.audit.system")),1)]),n("div",null,[n("label",tn,c(e.$t("settings.audit.action")),1),n("p",sn,c(V.value.action),1)]),n("div",null,[n("label",an,c(e.$t("settings.audit.ip_address")),1),n("p",rn,c(V.value.ip_address),1)])]),V.value.old_values||V.value.new_values?(i(),d("div",ln,[n("label",on,c(e.$t("settings.audit.changes")),1),n("div",dn,[n("pre",nn,c(A(V.value)),1)])])):v("",!0)]),n("div",cn,[n("button",{onClick:t[14]||(t[14]=e=>V.value=null),class:"bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"},c(e.$t("common.close")),1)])])])])):v("",!0)])}}}),mn={class:"space-y-6"},gn={class:"sm:flex sm:items-center"},bn={class:"sm:flex-auto"},pn={class:"text-2xl font-semibold text-gray-900 dark:text-white"},yn={class:"mt-2 text-sm text-gray-700 dark:text-gray-300"},xn={class:"bg-white dark:bg-gray-800 shadow rounded-lg"},fn={class:"border-b border-gray-200 dark:border-gray-700"},kn={class:"-mb-px flex space-x-8 px-6","aria-label":"Tabs"},_n=["onClick"],vn={class:"p-6"},hn=s({__name:"SettingsView",setup(t){const s=e(),r=a("business"),l=[{id:"business",name:"Business",icon:j},{id:"roles",name:"Roles & Permissions",icon:D},{id:"templates",name:"Message Templates",icon:M},{id:"appearance",name:"Theme & Language",icon:P},{id:"security",name:"Security",icon:H},{id:"backup",name:"Backup",icon:O},{id:"audit",name:"Audit Logs",icon:I}];return o(async()=>{await s.fetchSettings()}),(e,t)=>(i(),d("div",mn,[n("div",gn,[n("div",bn,[n("h1",pn,c(e.$t("pages.settings")),1),n("p",yn,c(e.$t("settings.description")),1)])]),n("div",xn,[n("div",fn,[n("nav",kn,[(i(),d(k,null,_(l,t=>n("button",{key:t.id,onClick:e=>r.value=t.id,class:$([r.value===t.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2"])},[(i(),w(C(t.icon),{class:"h-5 w-5"})),n("span",null,c(e.$t(`settings.tabs.${t.id}`)),1)],10,_n)),64))])]),n("div",vn,["business"===r.value?(i(),w(Ie,{key:0})):"roles"===r.value?(i(),w(Vt,{key:1})):"templates"===r.value?(i(),w($s,{key:2})):"appearance"===r.value?(i(),w(Fa,{key:3})):"security"===r.value?(i(),w(no,{key:4})):"backup"===r.value?(i(),w(Ui,{key:5})):"audit"===r.value?(i(),w(un,{key:6})):v("",!0)])])]))}});export{hn as default};
