import{u as e}from"./chunk-d86c149c.js";import{d as t,r as a,K as r,o as s,n as o,p as d,q as l,t as i,G as n,H as m,v as c,I as u,j as g,F as x,y,u as b,B as p,x as k,D as v,c as f,z as h,C as w,L as _}from"./chunk-300a47f1.js";import{J as $,w as C,c as j,d as U,K as V,e as S,v as D,f as E,L as O,l as L,A as M,M as R,N as A,O as F,t as I,z,P as q,Q as N,h as P}from"./chunk-9984d79b.js";import{_ as T}from"./chunk-9edc2f6d.js";import"./chunk-e8ade734.js";import"./chunk-63a63872.js";import"./chunk-e5f6a124.js";const B={class:"space-y-4"},J={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-4"},K={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},G={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},H=["placeholder"],Q={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},W={value:""},X={value:"retail"},Y={value:"wholesale"},Z={value:"vip"},ee={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},te={value:""},ae={value:"lead"},re={value:"prospect"},se={value:"customer"},oe={value:"inactive"},de={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},le={value:""},ie={value:"1"},ne={value:"0"},me={class:"mt-4 flex justify-end"},ce={class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},ue={key:0,class:"p-8 text-center"},ge={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},xe={key:1,class:"p-8 text-center"},ye={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},be={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},pe={key:2,class:"overflow-x-auto"},ke={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ve={class:"bg-gray-50 dark:bg-gray-700"},fe=["onClick"],he={class:"flex items-center space-x-1"},we={class:"relative px-6 py-3"},_e={class:"sr-only"},$e={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Ce={class:"px-6 py-4 whitespace-nowrap"},je={class:"flex items-center"},Ue={class:"flex-shrink-0 h-10 w-10"},Ve={class:"h-10 w-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center"},Se={class:"text-sm font-medium text-primary-800 dark:text-primary-200"},De={class:"ml-4"},Ee={class:"text-sm font-medium text-gray-900 dark:text-white"},Oe={class:"text-sm text-gray-500 dark:text-gray-400"},Le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Me={class:"px-6 py-4 whitespace-nowrap"},Re={class:"px-6 py-4 whitespace-nowrap"},Ae={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Fe={class:"px-6 py-4 whitespace-nowrap"},Ie={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ze={class:"flex items-center justify-end space-x-2"},qe=["onClick"],Ne=["onClick"],Pe=["onClick"],Te=["onClick"],Be={key:3,class:"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700 sm:px-6"},Je={class:"flex items-center justify-between"},Ke={class:"flex-1 flex justify-between sm:hidden"},Ge=["disabled"],He=["disabled"],Qe={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},We={class:"text-sm text-gray-700 dark:text-gray-300"},Xe={class:"font-medium"},Ye={class:"font-medium"},Ze={class:"font-medium"},et={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},tt=["disabled"],at=["disabled"],rt=t({__name:"CustomerList",emits:["edit-customer","view-customer","delete-customer"],setup(t){const f=e(),h=a(""),w=r({customer_type:"",crm_stage:"",is_active:"",preferred_language:"",lead_source:""}),_=[{key:"name",label:"customers.name",sortable:!0},{key:"phone",label:"customers.phone",sortable:!1},{key:"customer_type",label:"customers.type",sortable:!0},{key:"crm_stage",label:"customers.stage",sortable:!0},{key:"outstanding_balance",label:"customers.outstanding",sortable:!0},{key:"is_active",label:"common.status",sortable:!0}],O=((e,t)=>{let a;return function(...r){clearTimeout(a),a=setTimeout(()=>{clearTimeout(a),e(...r)},t)}})(()=>{f.updateFilters({search:h.value}),f.fetchCustomers()},300),L=()=>{f.updateFilters(w),f.fetchCustomers()},M=()=>{h.value="",Object.keys(w).forEach(e=>{w[e]=""}),f.resetFilters(),f.fetchCustomers()},R=e=>{const t=f.filters.sort_by,a=f.filters.sort_direction;return t!==e?"text-gray-400":"asc"===a?"text-primary-600 transform rotate-180":"text-primary-600"},A=()=>{f.pagination.current_page>1&&f.fetchCustomers({page:f.pagination.current_page-1})},F=()=>{f.pagination.current_page<f.pagination.last_page&&f.fetchCustomers({page:f.pagination.current_page+1})};return s(()=>{0===f.customers.length&&f.fetchCustomers()}),(e,t)=>(o(),d("div",B,[l("div",J,[l("div",K,[l("div",null,[l("label",G,i(e.$t("common.search")),1),n(l("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>h.value=e),onInput:t[1]||(t[1]=(...e)=>c(O)&&c(O)(...e)),type:"text",placeholder:e.$t("customers.search_placeholder"),class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,40,H),[[m,h.value]])]),l("div",null,[l("label",Q,i(e.$t("customers.customer_type")),1),n(l("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>w.customer_type=e),onChange:L,class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",W,i(e.$t("common.all")),1),l("option",X,i(e.$t("customers.types.retail")),1),l("option",Y,i(e.$t("customers.types.wholesale")),1),l("option",Z,i(e.$t("customers.types.vip")),1)],544),[[u,w.customer_type]])]),l("div",null,[l("label",ee,i(e.$t("customers.crm_stage")),1),n(l("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>w.crm_stage=e),onChange:L,class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",te,i(e.$t("common.all")),1),l("option",ae,i(e.$t("customers.stages.lead")),1),l("option",re,i(e.$t("customers.stages.prospect")),1),l("option",se,i(e.$t("customers.stages.customer")),1),l("option",oe,i(e.$t("customers.stages.inactive")),1)],544),[[u,w.crm_stage]])]),l("div",null,[l("label",de,i(e.$t("common.status")),1),n(l("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>w.is_active=e),onChange:L,class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",le,i(e.$t("common.all")),1),l("option",ie,i(e.$t("common.active")),1),l("option",ne,i(e.$t("common.inactive")),1)],544),[[u,w.is_active]])])]),l("div",me,[l("button",{onClick:M,class:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"},i(e.$t("common.clear_filters")),1)])]),l("div",ce,[c(f).loading.customers?(o(),d("div",ue,[t[5]||(t[5]=l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"},null,-1)),l("p",ge,i(e.$t("common.loading")),1)])):0===c(f).customers.length?(o(),d("div",xe,[g(c($),{class:"mx-auto h-12 w-12 text-gray-400"}),l("h3",ye,i(e.$t("customers.no_customers")),1),l("p",be,i(e.$t("customers.no_customers_description")),1)])):(o(),d("div",pe,[l("table",ke,[l("thead",ve,[l("tr",null,[(o(),d(x,null,y(_,t=>l("th",{key:t.key,onClick:e=>t.sortable&&(e=>{const t=f.filters.sort_by,a=f.filters.sort_direction;let r="asc";t===e&&"asc"===a&&(r="desc"),f.updateFilters({sort_by:e,sort_direction:r}),f.fetchCustomers()})(t.key),class:b(["px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",t.sortable&&"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"])},[l("div",he,[l("span",null,i(e.$t(t.label)),1),t.sortable?(o(),p(c(C),{key:0,class:b(["h-4 w-4",R(t.key)])},null,8,["class"])):k("",!0)])],10,fe)),64)),l("th",we,[l("span",_e,i(e.$t("common.actions")),1)])])]),l("tbody",$e,[(o(!0),d(x,null,y(c(f).customers,t=>{return o(),d("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[l("td",Ce,[l("div",je,[l("div",Ue,[l("div",Ve,[l("span",Se,i((n=t.name,n.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().slice(0,2))),1)])]),l("div",De,[l("div",Ee,i(t.name),1),l("div",Oe,i(t.email),1)])])]),l("td",Le,i(t.phone||"-"),1),l("td",Me,[l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",(s=t.customer_type,{retail:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",wholesale:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",vip:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}[s]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200")])},i(e.$t(`customers.types.${t.customer_type}`)),3)]),l("td",Re,[l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",(r=t.crm_stage,{lead:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",prospect:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",customer:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",inactive:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}[r]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200")])},i(e.$t(`customers.stages.${t.crm_stage}`)),3)]),l("td",Ae,[l("span",{class:b(t.outstanding_balance&&t.outstanding_balance>0?"text-red-600 dark:text-red-400":"")},i((a=t.outstanding_balance||0,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a))),3)]),l("td",Fe,[l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",t.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"])},i(t.is_active?e.$t("common.active"):e.$t("common.inactive")),3)]),l("td",Ie,[l("div",ze,[l("button",{onClick:a=>e.$emit("view-customer",t),class:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"},[g(c(j),{class:"h-4 w-4"})],8,qe),l("button",{onClick:a=>e.$emit("edit-customer",t),class:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300"},[g(c(U),{class:"h-4 w-4"})],8,Ne),l("button",{onClick:e=>(async e=>{try{await f.exportVCard(e.id)}catch(t){}})(t),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300"},[g(c(V),{class:"h-4 w-4"})],8,Pe),l("button",{onClick:a=>e.$emit("delete-customer",t),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},[g(c(S),{class:"h-4 w-4"})],8,Te)])])]);var a,r,s,n}),128))])])])),c(f).pagination.total>0?(o(),d("div",Be,[l("div",Je,[l("div",Ke,[l("button",{onClick:A,disabled:1===c(f).pagination.current_page,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},i(e.$t("common.previous")),9,Ge),l("button",{onClick:F,disabled:c(f).pagination.current_page===c(f).pagination.last_page,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},i(e.$t("common.next")),9,He)]),l("div",Qe,[l("div",null,[l("p",We,[v(i(e.$t("common.showing"))+" ",1),l("span",Xe,i((c(f).pagination.current_page-1)*c(f).pagination.per_page+1),1),v(" "+i(e.$t("common.to"))+" ",1),l("span",Ye,i(Math.min(c(f).pagination.current_page*c(f).pagination.per_page,c(f).pagination.total)),1),v(" "+i(e.$t("common.of"))+" ",1),l("span",Ze,i(c(f).pagination.total),1),v(" "+i(e.$t("common.results")),1)])]),l("div",null,[l("nav",et,[l("button",{onClick:A,disabled:1===c(f).pagination.current_page,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm font-medium text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed"},[g(c(D),{class:"h-5 w-5"})],8,tt),l("button",{onClick:F,disabled:c(f).pagination.current_page===c(f).pagination.last_page,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm font-medium text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed"},[g(c(E),{class:"h-5 w-5"})],8,at)])])])])])):k("",!0)])]))}}),st={class:"space-y-6"},ot={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},dt={class:"flex items-center justify-between mb-6"},lt={class:"text-lg font-medium text-gray-900 dark:text-white"},it=["disabled"],nt={key:0,class:"text-center py-8"},mt={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},ct={key:1,class:"space-y-6"},ut={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},gt={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},xt={class:"text-2xl font-bold text-gray-900 dark:text-white"},yt={class:"text-sm text-gray-500 dark:text-gray-400"},bt={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},pt={class:"text-2xl font-bold text-gray-900 dark:text-white"},kt={class:"text-sm text-gray-500 dark:text-gray-400"},vt={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},ft={class:"text-2xl font-bold text-gray-900 dark:text-white"},ht={class:"text-sm text-gray-500 dark:text-gray-400"},wt={class:"grid grid-cols-1 lg:grid-cols-4 gap-6"},_t={class:"flex items-center justify-between mb-4"},$t={class:"text-sm font-medium text-gray-900 dark:text-white"},Ct={class:"space-y-2 max-h-96 overflow-y-auto"},jt=["onClick"],Ut={class:"flex items-center justify-between"},Vt={class:"flex-1 min-w-0"},St={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},Dt={class:"text-xs text-gray-500 dark:text-gray-400 truncate"},Et={class:"flex items-center space-x-1"},Ot={class:"flex items-center space-x-1"},Lt=["onClick","disabled"],Mt=["onClick","disabled"],Rt={key:0,class:"mt-2"},At={class:"text-xs text-red-600 dark:text-red-400"},Ft={key:0,class:"text-center py-4"},It={class:"text-sm text-gray-500 dark:text-gray-400"},zt={key:2,class:"text-center py-8"},qt={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Nt={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Pt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Tt={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Bt={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6"},Jt={class:"mb-4"},Kt={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Gt={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Ht={class:"mb-4"},Qt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Wt=["placeholder"],Xt={class:"flex items-center justify-end space-x-3"},Yt=["disabled"],Zt={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},ea=t({__name:"CRMPipeline",setup(t){const r=e(),u=a(!1),p=a(null),w=a(""),_=a(""),C=a(!1),j=f(()=>r.crmPipeline),U=["lead","prospect","customer","inactive"],V=async()=>{await r.fetchCRMPipeline()},S=(e,t)=>{const a=U.indexOf(e.crm_stage);let r;r="left"===t?a-1:a+1,r>=0&&r<U.length&&(p.value=e,w.value=U[r],u.value=!0)},L=e=>U.indexOf(e)>0,M=e=>U.indexOf(e)<U.length-1,R=async()=>{if(p.value){C.value=!0;try{await r.updateCRMStage(p.value.id,w.value,_.value),u.value=!1,_.value="",p.value=null,w.value=""}catch(e){}finally{C.value=!1}}},A=e=>{const t={lead:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",prospect:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",customer:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",inactive:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};return t[e]||t.lead},F=e=>{const t={retail:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",wholesale:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",vip:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"};return t[e]||t.retail},I=e=>`${Math.round(e)}%`;return s(()=>{j.value||r.fetchCRMPipeline()}),(e,t)=>{var a;return o(),d("div",st,[l("div",ot,[l("div",dt,[l("h3",lt,i(e.$t("customers.crm_pipeline")),1),l("button",{onClick:V,disabled:c(r).loading.crm,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[g(c(O),{class:b(["h-4 w-4 mr-2",c(r).loading.crm&&"animate-spin"])},null,8,["class"]),v(" "+i(e.$t("common.refresh")),1)],8,it)]),c(r).loading.crm?(o(),d("div",nt,[t[3]||(t[3]=l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"},null,-1)),l("p",mt,i(e.$t("common.loading")),1)])):j.value?(o(),d("div",ct,[l("div",ut,[l("div",gt,[l("div",xt,i(I(j.value.conversion_rates.lead_to_prospect)),1),l("div",yt,i(e.$t("customers.lead_to_prospect")),1)]),l("div",bt,[l("div",pt,i(I(j.value.conversion_rates.prospect_to_customer)),1),l("div",kt,i(e.$t("customers.prospect_to_customer")),1)]),l("div",vt,[l("div",ft,i(I(j.value.conversion_rates.overall)),1),l("div",ht,i(e.$t("customers.overall_conversion")),1)])]),l("div",wt,[(o(!0),d(x,null,y(j.value.stages,t=>(o(),d("div",{key:t.stage,class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},[l("div",_t,[l("h4",$t,i(e.$t(`customers.stages.${t.stage}`)),1),l("span",{class:b(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",A(t.stage)])},i(t.count),3)]),l("div",Ct,[(o(!0),d(x,null,y(t.customers,a=>{return o(),d("div",{key:a.id,class:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm cursor-pointer hover:shadow-md transition-shadow",onClick:e=>{}},[l("div",Ut,[l("div",Vt,[l("p",St,i(a.name),1),l("p",Dt,i(a.email||a.phone||"-"),1)]),l("div",Et,[l("span",{class:b(["inline-flex px-1.5 py-0.5 text-xs font-medium rounded",F(a.customer_type)])},i(a.customer_type.charAt(0).toUpperCase()),3),l("div",Ot,[l("button",{onClick:h(e=>S(a,"left"),["stop"]),disabled:!L(t.stage),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed"},[g(c(D),{class:"h-3 w-3"})],8,Lt),l("button",{onClick:h(e=>S(a,"right"),["stop"]),disabled:!M(t.stage),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed"},[g(c(E),{class:"h-3 w-3"})],8,Mt)])])]),a.outstanding_balance&&a.outstanding_balance>0?(o(),d("div",Rt,[l("span",At,i(e.$t("customers.outstanding"))+": "+i((r=a.outstanding_balance,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r))),1)])):k("",!0)],8,jt);var r}),128)),0===t.customers.length?(o(),d("div",Ft,[l("p",It,i(e.$t("customers.no_customers_in_stage")),1)])):k("",!0)])]))),128))])])):(o(),d("div",zt,[g(c($),{class:"mx-auto h-12 w-12 text-gray-400"}),l("h3",qt,i(e.$t("customers.no_pipeline_data")),1),l("p",Nt,i(e.$t("customers.no_pipeline_description")),1)]))]),u.value?(o(),d("div",Pt,[l("div",Tt,[l("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=e=>u.value=!1)}),l("div",Bt,[l("div",Jt,[l("h3",Kt,i(e.$t("customers.move_customer")),1),l("p",Gt,i(e.$t("customers.move_customer_description",{name:null==(a=p.value)?void 0:a.name,stage:e.$t(`customers.stages.${w.value}`)})),1)]),l("div",Ht,[l("label",Qt,i(e.$t("customers.notes")),1),n(l("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>_.value=e),rows:"3",placeholder:e.$t("customers.move_notes_placeholder"),class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,8,Wt),[[m,_.value]])]),l("div",Xt,[l("button",{type:"button",onClick:t[2]||(t[2]=e=>u.value=!1),class:"bg-white dark:bg-gray-700 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"},i(e.$t("common.cancel")),1),l("button",{type:"button",onClick:R,disabled:C.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[C.value?(o(),d("div",Zt)):k("",!0),v(" "+i(e.$t("common.confirm")),1)],8,Yt)])])])])):k("",!0)])}}}),ta={class:"fixed inset-0 z-50 overflow-y-auto"},aa={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ra={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6"},sa={class:"mb-4"},oa={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},da={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},la={class:"mb-4"},ia={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},na={value:""},ma=["value"],ca={class:"mb-4"},ua={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ga={value:""},xa={value:"email"},ya={value:"sms"},ba={value:"whatsapp"},pa={value:"phone"},ka={value:"meeting"},va={value:"note"},fa={key:0,class:"mb-4"},ha={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},wa={class:"mb-4"},_a={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},$a={class:"flex items-center justify-end space-x-3"},Ca=["disabled"],ja={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Ua=t({__name:"SendCommunicationModal",emits:["close","sent"],setup(t,{emit:c}){const g=c,b=e(),p=a(!1),f=a([]),w=r({customer_id:"",type:"",subject:"",message:""}),_=async()=>{p.value=!0;try{g("sent")}catch(e){}finally{p.value=!1}};return s(()=>{0===b.customers.length&&b.fetchCustomers(),f.value=b.customers}),(e,t)=>(o(),d("div",ta,[l("div",aa,[l("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),l("div",ra,[l("div",sa,[l("h3",oa,i(e.$t("communication.send_message")),1),l("p",da,i(e.$t("communication.send_description")),1)]),l("form",{onSubmit:h(_,["prevent"])},[l("div",la,[l("label",ia,i(e.$t("customers.customer"))+" * ",1),n(l("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>w.customer_id=e),required:"",class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",na,i(e.$t("common.select")),1),(o(!0),d(x,null,y(f.value,e=>(o(),d("option",{key:e.id,value:e.id},i(e.name),9,ma))),128))],512),[[u,w.customer_id]])]),l("div",ca,[l("label",ua,i(e.$t("communication.type"))+" * ",1),n(l("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>w.type=e),required:"",class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",ga,i(e.$t("common.select")),1),l("option",xa,i(e.$t("communication.email")),1),l("option",ya,i(e.$t("communication.sms")),1),l("option",ba,i(e.$t("communication.whatsapp")),1),l("option",pa,i(e.$t("communication.phone")),1),l("option",ka,i(e.$t("communication.meeting")),1),l("option",va,i(e.$t("communication.note")),1)],512),[[u,w.type]])]),"email"===w.type?(o(),d("div",fa,[l("label",ha,i(e.$t("communication.subject")),1),n(l("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>w.subject=e),type:"text",class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[m,w.subject]])])):k("",!0),l("div",wa,[l("label",_a,i(e.$t("communication.message"))+" * ",1),n(l("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>w.message=e),rows:"4",required:"",class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[m,w.message]])]),l("div",$a,[l("button",{type:"button",onClick:t[5]||(t[5]=t=>e.$emit("close")),class:"bg-white dark:bg-gray-700 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"},i(e.$t("common.cancel")),1),l("button",{type:"submit",disabled:p.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[p.value?(o(),d("div",ja)):k("",!0),v(" "+i(e.$t("communication.send")),1)],8,Ca)])],32)])])]))}}),Va={class:"fixed inset-0 z-50 overflow-y-auto"},Sa={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Da={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full sm:p-6"},Ea={key:0},Oa={class:"flex items-center justify-between mb-6"},La={class:"flex items-center space-x-3"},Ma={class:"text-lg font-medium text-gray-900 dark:text-white"},Ra={class:"text-sm text-gray-500 dark:text-gray-400"},Aa={class:"space-y-4"},Fa={class:"flex items-center justify-between"},Ia={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},za={key:0},qa={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Na={class:"mt-1 text-sm text-gray-900 dark:text-white"},Pa={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Ta={class:"mt-1 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},Ba={class:"text-sm text-gray-900 dark:text-white whitespace-pre-wrap"},Ja={class:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-gray-200 dark:border-gray-700"},Ka={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Ga={class:"text-sm text-gray-900 dark:text-white"},Ha={key:0},Qa={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Wa={class:"text-sm text-gray-900 dark:text-white"},Xa={key:1},Ya={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Za={class:"text-sm text-gray-900 dark:text-white"},er={key:2},tr={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},ar={class:"text-sm text-gray-900 dark:text-white"},rr={key:1,class:"pt-4 border-t border-gray-200 dark:border-gray-700"},sr={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},or={class:"mt-1 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},dr={class:"text-xs text-gray-900 dark:text-white"},lr=t({__name:"ViewCommunicationModal",props:{communication:{}},emits:["close"],setup(e){const t=e=>{const t={email:"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300",sms:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300",whatsapp:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300",phone:"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-300",meeting:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-300",note:"bg-gray-100 text-gray-600 dark:bg-gray-900 dark:text-gray-300"};return t[e]||t.note},a=e=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",delivered:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",read:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",failed:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};return t[e]||t.draft},r=e=>new Date(e).toLocaleString();return(e,s)=>{var n,m;return o(),d("div",Va,[l("div",Sa,[l("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:s[0]||(s[0]=t=>e.$emit("close"))}),l("div",Da,[e.communication?(o(),d("div",Ea,[l("div",Oa,[l("div",La,[l("div",{class:b(["h-10 w-10 rounded-full flex items-center justify-center",t(e.communication.type)])},[(o(),p(w((m=e.communication.type,{email:R,sms:A,whatsapp:A,phone:F,meeting:I,note:M}[m]||M)),{class:"h-5 w-5"}))],2),l("div",null,[l("h3",Ma,i(e.$t(`communication.${e.communication.type}`)),1),l("p",Ra,i((null==(n=e.communication.customer)?void 0:n.name)||e.$t("common.unknown")),1)])]),l("button",{onClick:s[1]||(s[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[g(c(L),{class:"h-6 w-6"})])]),l("div",Aa,[l("div",Fa,[l("span",Ia,i(e.$t("common.status"))+": ",1),l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",a(e.communication.status)])},i(e.$t(`communication.statuses.${e.communication.status}`)),3)]),e.communication.subject?(o(),d("div",za,[l("span",qa,i(e.$t("communication.subject"))+": ",1),l("p",Na,i(e.communication.subject),1)])):k("",!0),l("div",null,[l("span",Pa,i(e.$t("communication.message"))+": ",1),l("div",Ta,[l("p",Ba,i(e.communication.message),1)])]),l("div",Ja,[l("div",null,[l("span",Ka,i(e.$t("communication.created"))+": ",1),l("p",Ga,i(r(e.communication.created_at)),1)]),e.communication.sent_at?(o(),d("div",Ha,[l("span",Qa,i(e.$t("communication.sent"))+": ",1),l("p",Wa,i(r(e.communication.sent_at)),1)])):k("",!0),e.communication.delivered_at?(o(),d("div",Xa,[l("span",Ya,i(e.$t("communication.delivered"))+": ",1),l("p",Za,i(r(e.communication.delivered_at)),1)])):k("",!0),e.communication.read_at?(o(),d("div",er,[l("span",tr,i(e.$t("communication.read"))+": ",1),l("p",ar,i(r(e.communication.read_at)),1)])):k("",!0)]),e.communication.metadata&&Object.keys(e.communication.metadata).length>0?(o(),d("div",rr,[l("span",sr,i(e.$t("communication.metadata"))+": ",1),l("div",or,[l("pre",dr,i(JSON.stringify(e.communication.metadata,null,2)),1)])])):k("",!0)])])):k("",!0)])])])}}}),ir={class:"space-y-6"},nr={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},mr={class:"flex items-center justify-between mb-6"},cr={class:"text-lg font-medium text-gray-900 dark:text-white"},ur={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},gr={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},xr={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},yr={class:"text-2xl font-bold text-gray-900 dark:text-white"},br={class:"text-sm text-gray-500 dark:text-gray-400"},pr={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},kr={class:"text-2xl font-bold text-green-600 dark:text-green-400"},vr={class:"text-sm text-gray-500 dark:text-gray-400"},fr={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},hr={class:"text-2xl font-bold text-red-600 dark:text-red-400"},wr={class:"text-sm text-gray-500 dark:text-gray-400"},_r={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},$r={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},Cr={class:"text-sm text-gray-500 dark:text-gray-400"},jr={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-4"},Ur={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Vr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Sr={value:""},Dr=["value"],Er={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Or={value:""},Lr={value:"email"},Mr={value:"sms"},Rr={value:"whatsapp"},Ar={value:"phone"},Fr={value:"meeting"},Ir={value:"note"},zr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},qr={value:""},Nr={value:"draft"},Pr={value:"sent"},Tr={value:"delivered"},Br={value:"read"},Jr={value:"failed"},Kr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Gr={class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},Hr={key:0,class:"p-8 text-center"},Qr={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},Wr={key:1,class:"p-8 text-center"},Xr={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Yr={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Zr={key:2,class:"divide-y divide-gray-200 dark:divide-gray-700"},es={class:"flex items-start space-x-4"},ts={class:"flex-shrink-0"},as={class:"flex-1 min-w-0"},rs={class:"flex items-center justify-between"},ss={class:"flex items-center space-x-2"},os={class:"text-sm font-medium text-gray-900 dark:text-white"},ds={class:"text-sm text-gray-500 dark:text-gray-400"},ls={key:0,class:"mt-1"},is={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},ns={class:"mt-2"},ms={class:"text-sm text-gray-600 dark:text-gray-400 line-clamp-3"},cs={class:"mt-3 flex items-center space-x-4 text-xs text-gray-500 dark:text-gray-400"},us={class:"flex items-center"},gs={key:0},xs={key:1},ys={key:2},bs={class:"flex-shrink-0"},ps=["onClick"],ks=t({__name:"CommunicationCenter",setup(t){const h=e(),_=a(!1),$=a(!1),C=a(!1),U=a(null),V=a([]),S=r({customer_id:"",type:"",status:"",date_from:"",date_to:""}),D=f(()=>{const e={total:V.value.length,delivered:0,failed:0,pending:0};return V.value.forEach(t=>{switch(t.status){case"delivered":case"read":e.delivered++;break;case"failed":e.failed++;break;case"draft":case"sent":e.pending++}}),e}),E=()=>{},O=()=>{$.value=!1,L()},L=async()=>{_.value=!0;try{V.value=[]}catch(e){}finally{_.value=!1}},N=e=>({email:R,sms:A,whatsapp:A,phone:F,meeting:I,note:M}[e]||M),P=e=>{const t={email:"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300",sms:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300",whatsapp:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300",phone:"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-300",meeting:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-300",note:"bg-gray-100 text-gray-600 dark:bg-gray-900 dark:text-gray-300"};return t[e]||t.note},T=e=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",delivered:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",read:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",failed:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};return t[e]||t.draft},B=e=>new Date(e).toLocaleDateString();return s(()=>{0===h.customers.length&&h.fetchCustomers(),L()}),(e,t)=>(o(),d("div",ir,[l("div",nr,[l("div",mr,[l("div",null,[l("h3",cr,i(e.$t("customers.communication_center")),1),l("p",ur,i(e.$t("customers.communication_description")),1)]),l("button",{onClick:t[0]||(t[0]=e=>$.value=!0),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[g(c(z),{class:"h-4 w-4 mr-2"}),v(" "+i(e.$t("communication.send_message")),1)])]),l("div",gr,[l("div",xr,[l("div",yr,i(D.value.total),1),l("div",br,i(e.$t("communication.total_sent")),1)]),l("div",pr,[l("div",kr,i(D.value.delivered),1),l("div",vr,i(e.$t("communication.delivered")),1)]),l("div",fr,[l("div",hr,i(D.value.failed),1),l("div",wr,i(e.$t("communication.failed")),1)]),l("div",_r,[l("div",$r,i(D.value.pending),1),l("div",Cr,i(e.$t("communication.pending")),1)])])]),l("div",jr,[l("div",Ur,[l("div",null,[l("label",Vr,i(e.$t("customers.customer")),1),n(l("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>S.customer_id=e),onChange:E,class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",Sr,i(e.$t("common.all")),1),(o(!0),d(x,null,y(c(h).customers,e=>(o(),d("option",{key:e.id,value:e.id},i(e.name),9,Dr))),128))],544),[[u,S.customer_id]])]),l("div",null,[l("label",Er,i(e.$t("communication.type")),1),n(l("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>S.type=e),onChange:E,class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",Or,i(e.$t("common.all")),1),l("option",Lr,i(e.$t("communication.email")),1),l("option",Mr,i(e.$t("communication.sms")),1),l("option",Rr,i(e.$t("communication.whatsapp")),1),l("option",Ar,i(e.$t("communication.phone")),1),l("option",Fr,i(e.$t("communication.meeting")),1),l("option",Ir,i(e.$t("communication.note")),1)],544),[[u,S.type]])]),l("div",null,[l("label",zr,i(e.$t("common.status")),1),n(l("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>S.status=e),onChange:E,class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",qr,i(e.$t("common.all")),1),l("option",Nr,i(e.$t("communication.statuses.draft")),1),l("option",Pr,i(e.$t("communication.statuses.sent")),1),l("option",Tr,i(e.$t("communication.statuses.delivered")),1),l("option",Br,i(e.$t("communication.statuses.read")),1),l("option",Jr,i(e.$t("communication.statuses.failed")),1)],544),[[u,S.status]])]),l("div",null,[l("label",Kr,i(e.$t("common.date_range")),1),n(l("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>S.date_from=e),type:"date",class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[m,S.date_from]])])])]),l("div",Gr,[_.value?(o(),d("div",Hr,[t[7]||(t[7]=l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"},null,-1)),l("p",Qr,i(e.$t("common.loading")),1)])):0===V.value.length?(o(),d("div",Wr,[g(c(q),{class:"mx-auto h-12 w-12 text-gray-400"}),l("h3",Xr,i(e.$t("communication.no_communications")),1),l("p",Yr,i(e.$t("communication.no_communications_description")),1)])):(o(),d("div",Zr,[(o(!0),d(x,null,y(V.value,t=>{var a;return o(),d("div",{key:t.id,class:"p-6 hover:bg-gray-50 dark:hover:bg-gray-700"},[l("div",es,[l("div",ts,[l("div",{class:b(["h-10 w-10 rounded-full flex items-center justify-center",P(t.type)])},[(o(),p(w(N(t.type)),{class:"h-5 w-5"}))],2)]),l("div",as,[l("div",rs,[l("div",ss,[l("p",os,i((null==(a=t.customer)?void 0:a.name)||e.$t("common.unknown")),1),l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",T(t.status)])},i(e.$t(`communication.statuses.${t.status}`)),3)]),l("div",ds,i(B(t.created_at)),1)]),t.subject?(o(),d("div",ls,[l("p",is,i(t.subject),1)])):k("",!0),l("div",ns,[l("p",ms,i(t.message),1)]),l("div",cs,[l("span",us,[(o(),p(w(N(t.type)),{class:"h-3 w-3 mr-1"})),v(" "+i(e.$t(`communication.${t.type}`)),1)]),t.sent_at?(o(),d("span",gs,i(e.$t("communication.sent"))+": "+i(B(t.sent_at)),1)):k("",!0),t.delivered_at?(o(),d("span",xs,i(e.$t("communication.delivered"))+": "+i(B(t.delivered_at)),1)):k("",!0),t.read_at?(o(),d("span",ys,i(e.$t("communication.read"))+": "+i(B(t.read_at)),1)):k("",!0)])]),l("div",bs,[l("button",{onClick:e=>(e=>{U.value=e,C.value=!0})(t),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[g(c(j),{class:"h-5 w-5"})],8,ps)])])])}),128))]))]),$.value?(o(),p(Ua,{key:0,onClose:t[5]||(t[5]=e=>$.value=!1),onSent:O})):k("",!0),C.value?(o(),p(lr,{key:1,communication:U.value,onClose:t[6]||(t[6]=e=>C.value=!1)},null,8,["communication"])):k("",!0)]))}}),vs={class:"space-y-6"},fs={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},hs={class:"flex items-center justify-between mb-6"},ws={class:"text-lg font-medium text-gray-900 dark:text-white"},_s={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},$s={class:"flex items-center space-x-3"},Cs=["disabled"],js={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Us={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Vs={value:""},Ss={value:"retail"},Ds={value:"wholesale"},Es={value:"vip"},Os={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ls={value:""},Ms={value:"en"},Rs={value:"fa"},As={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Fs={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Is={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},zs={class:"text-2xl font-bold text-gray-900 dark:text-white"},qs={class:"text-sm text-gray-500 dark:text-gray-400"},Ns={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Ps={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ts={class:"text-sm text-gray-500 dark:text-gray-400"},Bs={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Js={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ks={class:"text-sm text-gray-500 dark:text-gray-400"},Gs={key:0,class:"bg-white dark:bg-gray-800 shadow rounded-lg p-8 text-center"},Hs={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},Qs={key:1,class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},Ws={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Xs={class:"text-lg font-medium text-gray-900 dark:text-white"},Ys={class:"divide-y divide-gray-200 dark:divide-gray-700"},Zs={class:"flex items-center justify-between mb-4"},eo={class:"flex items-center space-x-3"},to={class:"text-base font-medium text-gray-900 dark:text-white"},ao={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"},ro={class:"text-right"},so={class:"text-lg font-semibold text-gray-900 dark:text-white"},oo={class:"text-sm text-gray-500 dark:text-gray-400"},lo={key:0,class:"space-y-3"},io=["onClick"],no={class:"flex items-center space-x-3"},mo={class:"flex-shrink-0 h-8 w-8"},co={class:"h-8 w-8 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center"},uo={class:"text-xs font-medium text-primary-800 dark:text-primary-200"},go={class:"flex-1 min-w-0"},xo={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},yo={class:"text-xs text-gray-500 dark:text-gray-400 truncate"},bo={class:"text-right"},po={class:"text-sm font-semibold text-red-600 dark:text-red-400"},ko={class:"text-xs text-gray-500 dark:text-gray-400"},vo={key:1,class:"text-center py-4"},fo={class:"text-sm text-gray-500 dark:text-gray-400"},ho={key:2,class:"bg-white dark:bg-gray-800 shadow rounded-lg p-8 text-center"},wo={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},_o={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},$o=t({__name:"CustomerAgingReport",setup(t){const a=e(),p=r({customer_type:"",preferred_language:"",as_of_date:(new Date).toISOString().split("T")[0]}),h=f(()=>a.agingReport),w=f(()=>h.value&&0!==h.value.total_customers?h.value.total_outstanding/h.value.total_customers:0),_=async()=>{await a.fetchAgingReport(p)},$=()=>{a.fetchAgingReport(p)},C=()=>{if(!h.value)return;let e="Customer Name,Email,Phone,Type,Outstanding Balance,Days Outstanding\n";h.value.buckets.forEach(t=>{t.customers.forEach(a=>{e+=`"${a.name}","${a.email||""}","${a.phone||""}","${a.customer_type}","${a.outstanding_balance||0}","${t.range}"\n`})});const t=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`customer-aging-report-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)},j=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return s(()=>{h.value||a.fetchAgingReport(p)}),(e,t)=>(o(),d("div",vs,[l("div",fs,[l("div",hs,[l("div",null,[l("h3",ws,i(e.$t("customers.aging_report")),1),l("p",_s,i(e.$t("customers.aging_description")),1)]),l("div",$s,[l("button",{onClick:C,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[g(c(V),{class:"h-4 w-4 mr-2"}),v(" "+i(e.$t("common.export")),1)]),l("button",{onClick:_,disabled:c(a).loading.aging,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50"},[g(c(O),{class:b(["h-4 w-4 mr-2",c(a).loading.aging&&"animate-spin"])},null,8,["class"]),v(" "+i(e.$t("common.refresh")),1)],8,Cs)])]),l("div",js,[l("div",null,[l("label",Us,i(e.$t("customers.customer_type")),1),n(l("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>p.customer_type=e),onChange:$,class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",Vs,i(e.$t("common.all")),1),l("option",Ss,i(e.$t("customers.types.retail")),1),l("option",Ds,i(e.$t("customers.types.wholesale")),1),l("option",Es,i(e.$t("customers.types.vip")),1)],544),[[u,p.customer_type]])]),l("div",null,[l("label",Os,i(e.$t("customers.preferred_language")),1),n(l("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>p.preferred_language=e),onChange:$,class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",Ls,i(e.$t("common.all")),1),l("option",Ms,i(e.$t("languages.english")),1),l("option",Rs,i(e.$t("languages.persian")),1)],544),[[u,p.preferred_language]])]),l("div",null,[l("label",As,i(e.$t("reports.as_of_date")),1),n(l("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>p.as_of_date=e),type:"date",onChange:$,class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,544),[[m,p.as_of_date]])])]),h.value?(o(),d("div",Fs,[l("div",Is,[l("div",zs,i(j(h.value.total_outstanding)),1),l("div",qs,i(e.$t("customers.total_outstanding")),1)]),l("div",Ns,[l("div",Ps,i(h.value.total_customers),1),l("div",Ts,i(e.$t("customers.customers_with_balance")),1)]),l("div",Bs,[l("div",Js,i(j(w.value)),1),l("div",Ks,i(e.$t("customers.average_balance")),1)])])):k("",!0)]),c(a).loading.aging?(o(),d("div",Gs,[t[3]||(t[3]=l("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"},null,-1)),l("p",Hs,i(e.$t("common.loading")),1)])):h.value?(o(),d("div",Qs,[l("div",Ws,[l("h4",Xs,i(e.$t("customers.aging_buckets")),1)]),l("div",Ys,[(o(!0),d(x,null,y(h.value.buckets,t=>{return o(),d("div",{key:t.range,class:"p-6"},[l("div",Zs,[l("div",eo,[l("h5",to,i(t.range),1),l("span",ao,i(t.count)+" "+i(e.$t("customers.customers")),1)]),l("div",ro,[l("div",so,i(j(t.total_amount)),1),l("div",oo,i((a=t.total_amount/h.value.total_outstanding,`${Math.round(100*a)}%`)),1)])]),t.customers.length>0?(o(),d("div",lo,[(o(!0),d(x,null,y(t.customers,t=>{return o(),d("div",{key:t.id,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer",onClick:e=>{}},[l("div",no,[l("div",mo,[l("div",co,[l("span",uo,i((s=t.name,s.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().slice(0,2))),1)])]),l("div",go,[l("p",xo,i(t.name),1),l("p",yo,i(t.email||t.phone||"-"),1)]),l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",(r=t.customer_type,{retail:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",wholesale:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",vip:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}[r]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200")])},i(e.$t(`customers.types.${t.customer_type}`)),3)]),l("div",bo,[l("div",po,i(j(t.outstanding_balance||0)),1),l("div",ko,i(e.$t("customers.last_invoice"))+": "+i((a=t.last_invoice_date,a?new Date(a).toLocaleDateString():"-")),1)])],8,io);var a,r,s}),128))])):(o(),d("div",vo,[l("p",fo,i(e.$t("customers.no_customers_in_bucket")),1)]))]);var a}),128))])])):(o(),d("div",ho,[g(c(N),{class:"mx-auto h-12 w-12 text-gray-400"}),l("h3",wo,i(e.$t("customers.no_aging_data")),1),l("p",_o,i(e.$t("customers.no_aging_description")),1)]))]))}}),Co={class:"fixed inset-0 z-50 overflow-y-auto"},jo={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Uo={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full sm:p-6"},Vo={class:"mb-6"},So={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Do={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Eo={class:"space-y-6"},Oo={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Lo={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Mo={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Ro={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ao={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Fo={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Io={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},zo={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},qo={value:"retail"},No={value:"wholesale"},Po={value:"vip"},To={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Bo={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Jo={value:"en"},Ko={value:"fa"},Go={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Ho={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Qo={value:"lead"},Wo={value:"prospect"},Xo={value:"customer"},Yo={value:"inactive"},Zo={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},ed={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},td={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},ad={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},rd={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},sd={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},od={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},dd={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},ld={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},id={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},nd={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},md={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},cd={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},ud={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},gd={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},xd={value:""},yd={value:"email"},bd={value:"sms"},pd={value:"whatsapp"},kd={value:"phone"},vd={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},fd={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},hd={value:""},wd={value:"referral"},_d={value:"website"},$d={value:"social_media"},Cd={value:"walk_in"},jd={value:"advertisement"},Ud={value:"other"},Vd={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Sd={class:"flex items-center"},Dd={class:"ml-2 block text-sm text-gray-900 dark:text-white"},Ed={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Od=["placeholder"],Ld={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Md={class:"mt-6 flex items-center justify-end space-x-3"},Rd=["disabled"],Ad={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Fd=t({__name:"CustomerFormModal",props:{customer:{default:null},isEdit:{type:Boolean,default:!1}},emits:["close","saved"],setup(t,{emit:c}){const g=t,x=c,y=e(),p=f(()=>g.isEdit?y.loading.updating:y.loading.creating),w=a({}),$=r({name:"",email:"",phone:"",address:"",preferred_language:"en",customer_type:"retail",credit_limit:0,payment_terms:30,notes:"",birthday:"",anniversary:"",preferred_communication_method:"",is_active:!0,crm_stage:"lead",lead_source:""}),C=async()=>{var e,t;w.value={};try{const e={name:$.name,email:$.email||void 0,phone:$.phone||void 0,address:$.address||void 0,preferred_language:$.preferred_language,customer_type:$.customer_type,credit_limit:$.credit_limit,payment_terms:$.payment_terms,notes:$.notes||void 0,birthday:$.birthday||void 0,anniversary:$.anniversary||void 0,preferred_communication_method:""===$.preferred_communication_method?void 0:$.preferred_communication_method,is_active:$.is_active,crm_stage:$.crm_stage,lead_source:""===$.lead_source?void 0:$.lead_source};g.isEdit&&g.customer?await y.updateCustomer(g.customer.id,e):await y.createCustomer(e),x("saved")}catch(a){(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.errors)&&(w.value=a.response.data.errors)}};return s(()=>{g.isEdit&&g.customer&&Object.keys($).forEach(e=>{const t=g.customer[e];void 0!==t&&($[e]=t)})}),(e,t)=>(o(),d("div",Co,[l("div",jo,[l("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),l("div",Uo,[l("form",{onSubmit:h(C,["prevent"])},[l("div",Vo,[l("h3",So,i(e.isEdit?e.$t("customers.edit_customer"):e.$t("customers.add_customer")),1),l("p",Do,i(e.isEdit?e.$t("customers.edit_description"):e.$t("customers.add_description")),1)]),l("div",Eo,[l("div",Oo,[l("div",null,[l("label",Lo,i(e.$t("customers.name"))+" * ",1),n(l("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>$.name=e),type:"text",required:"",class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.name?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},null,2),[[m,$.name]]),w.value.name?(o(),d("p",Mo,i(w.value.name[0]),1)):k("",!0)]),l("div",null,[l("label",Ro,i(e.$t("customers.email")),1),n(l("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>$.email=e),type:"email",class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.email?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},null,2),[[m,$.email]]),w.value.email?(o(),d("p",Ao,i(w.value.email[0]),1)):k("",!0)]),l("div",null,[l("label",Fo,i(e.$t("customers.phone")),1),n(l("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>$.phone=e),type:"tel",class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.phone?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},null,2),[[m,$.phone]]),w.value.phone?(o(),d("p",Io,i(w.value.phone[0]),1)):k("",!0)]),l("div",null,[l("label",zo,i(e.$t("customers.customer_type"))+" * ",1),n(l("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>$.customer_type=e),required:"",class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.customer_type?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},[l("option",qo,i(e.$t("customers.types.retail")),1),l("option",No,i(e.$t("customers.types.wholesale")),1),l("option",Po,i(e.$t("customers.types.vip")),1)],2),[[u,$.customer_type]]),w.value.customer_type?(o(),d("p",To,i(w.value.customer_type[0]),1)):k("",!0)]),l("div",null,[l("label",Bo,i(e.$t("customers.preferred_language")),1),n(l("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>$.preferred_language=e),class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.preferred_language?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},[l("option",Jo,i(e.$t("languages.english")),1),l("option",Ko,i(e.$t("languages.persian")),1)],2),[[u,$.preferred_language]]),w.value.preferred_language?(o(),d("p",Go,i(w.value.preferred_language[0]),1)):k("",!0)]),l("div",null,[l("label",Ho,i(e.$t("customers.crm_stage")),1),n(l("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>$.crm_stage=e),class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.crm_stage?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},[l("option",Qo,i(e.$t("customers.stages.lead")),1),l("option",Wo,i(e.$t("customers.stages.prospect")),1),l("option",Xo,i(e.$t("customers.stages.customer")),1),l("option",Yo,i(e.$t("customers.stages.inactive")),1)],2),[[u,$.crm_stage]]),w.value.crm_stage?(o(),d("p",Zo,i(w.value.crm_stage[0]),1)):k("",!0)])]),l("div",null,[l("label",ed,i(e.$t("customers.address")),1),n(l("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>$.address=e),rows:"3",class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.address?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},null,2),[[m,$.address]]),w.value.address?(o(),d("p",td,i(w.value.address[0]),1)):k("",!0)]),l("div",ad,[l("div",null,[l("label",rd,i(e.$t("customers.credit_limit")),1),n(l("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>$.credit_limit=e),type:"number",step:"0.01",min:"0",class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.credit_limit?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},null,2),[[m,$.credit_limit,void 0,{number:!0}]]),w.value.credit_limit?(o(),d("p",sd,i(w.value.credit_limit[0]),1)):k("",!0)]),l("div",null,[l("label",od,i(e.$t("customers.payment_terms"))+" ("+i(e.$t("common.days"))+") ",1),n(l("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>$.payment_terms=e),type:"number",min:"0",class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.payment_terms?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},null,2),[[m,$.payment_terms,void 0,{number:!0}]]),w.value.payment_terms?(o(),d("p",dd,i(w.value.payment_terms[0]),1)):k("",!0)])]),l("div",ld,[l("div",null,[l("label",id,i(e.$t("customers.birthday")),1),n(l("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>$.birthday=e),type:"date",class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.birthday?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},null,2),[[m,$.birthday]]),w.value.birthday?(o(),d("p",nd,i(w.value.birthday[0]),1)):k("",!0)]),l("div",null,[l("label",md,i(e.$t("customers.anniversary")),1),n(l("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>$.anniversary=e),type:"date",class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.anniversary?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},null,2),[[m,$.anniversary]]),w.value.anniversary?(o(),d("p",cd,i(w.value.anniversary[0]),1)):k("",!0)])]),l("div",ud,[l("div",null,[l("label",gd,i(e.$t("customers.preferred_communication")),1),n(l("select",{"onUpdate:modelValue":t[12]||(t[12]=e=>$.preferred_communication_method=e),class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.preferred_communication_method?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},[l("option",xd,i(e.$t("common.select")),1),l("option",yd,i(e.$t("communication.email")),1),l("option",bd,i(e.$t("communication.sms")),1),l("option",pd,i(e.$t("communication.whatsapp")),1),l("option",kd,i(e.$t("communication.phone")),1)],2),[[u,$.preferred_communication_method]]),w.value.preferred_communication_method?(o(),d("p",vd,i(w.value.preferred_communication_method[0]),1)):k("",!0)]),l("div",null,[l("label",fd,i(e.$t("customers.lead_source")),1),n(l("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>$.lead_source=e),class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.lead_source?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},[l("option",hd,i(e.$t("common.select")),1),l("option",wd,i(e.$t("customers.lead_sources.referral")),1),l("option",_d,i(e.$t("customers.lead_sources.website")),1),l("option",$d,i(e.$t("customers.lead_sources.social_media")),1),l("option",Cd,i(e.$t("customers.lead_sources.walk_in")),1),l("option",jd,i(e.$t("customers.lead_sources.advertisement")),1),l("option",Ud,i(e.$t("customers.lead_sources.other")),1)],2),[[u,$.lead_source]]),w.value.lead_source?(o(),d("p",Vd,i(w.value.lead_source[0]),1)):k("",!0)])]),l("div",Sd,[n(l("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>$.is_active=e),type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[_,$.is_active]]),l("label",Dd,i(e.$t("customers.is_active")),1)]),l("div",null,[l("label",Ed,i(e.$t("customers.notes")),1),n(l("textarea",{"onUpdate:modelValue":t[15]||(t[15]=e=>$.notes=e),rows:"4",placeholder:e.$t("customers.notes_placeholder"),class:b([["block w-full rounded-md shadow-sm sm:text-sm",w.value.notes?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-primary-500 focus:ring-primary-500"],"dark:bg-gray-700 dark:text-white"])},null,10,Od),[[m,$.notes]]),w.value.notes?(o(),d("p",Ld,i(w.value.notes[0]),1)):k("",!0)])]),l("div",Md,[l("button",{type:"button",onClick:t[16]||(t[16]=t=>e.$emit("close")),class:"bg-white dark:bg-gray-700 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},i(e.$t("common.cancel")),1),l("button",{type:"submit",disabled:p.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(o(),d("div",Ad)):k("",!0),v(" "+i(e.isEdit?e.$t("common.update"):e.$t("common.create")),1)],8,Rd)])],32)])])]))}}),Id={class:"fixed inset-0 z-50 overflow-y-auto"},zd={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},qd={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6"},Nd={class:"mb-4"},Pd={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Td={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Bd={class:"mb-4"},Jd={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Kd={value:""},Gd={value:"email"},Hd={value:"sms"},Qd={value:"whatsapp"},Wd={value:"phone"},Xd={value:"meeting"},Yd={value:"note"},Zd={key:0,class:"mb-4"},el={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},tl={class:"mb-4"},al={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},rl={class:"flex items-center justify-end space-x-3"},sl=["disabled"],ol={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},dl=t({__name:"AddCommunicationModal",props:{customer:{}},emits:["close","added"],setup(t,{emit:s}){const c=t,g=s,x=e(),y=a(!1),b=r({type:"",subject:"",message:""}),p=async()=>{y.value=!0;try{await x.sendCommunication(c.customer.id,{type:b.type,subject:b.subject,message:b.message}),g("added")}catch(e){}finally{y.value=!1}};return(e,t)=>(o(),d("div",Id,[l("div",zd,[l("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),l("div",qd,[l("div",Nd,[l("h3",Pd,i(e.$t("communication.add_communication")),1),l("p",Td,i(e.$t("communication.add_description",{customer:e.customer.name})),1)]),l("form",{onSubmit:h(p,["prevent"])},[l("div",Bd,[l("label",Jd,i(e.$t("communication.type"))+" * ",1),n(l("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>b.type=e),required:"",class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},[l("option",Kd,i(e.$t("common.select")),1),l("option",Gd,i(e.$t("communication.email")),1),l("option",Hd,i(e.$t("communication.sms")),1),l("option",Qd,i(e.$t("communication.whatsapp")),1),l("option",Wd,i(e.$t("communication.phone")),1),l("option",Xd,i(e.$t("communication.meeting")),1),l("option",Yd,i(e.$t("communication.note")),1)],512),[[u,b.type]])]),"email"===b.type?(o(),d("div",Zd,[l("label",el,i(e.$t("communication.subject")),1),n(l("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>b.subject=e),type:"text",class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[m,b.subject]])])):k("",!0),l("div",tl,[l("label",al,i(e.$t("communication.message"))+" * ",1),n(l("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>b.message=e),rows:"4",required:"",class:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"},null,512),[[m,b.message]])]),l("div",rl,[l("button",{type:"button",onClick:t[4]||(t[4]=t=>e.$emit("close")),class:"bg-white dark:bg-gray-700 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"},i(e.$t("common.cancel")),1),l("button",{type:"submit",disabled:y.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[y.value?(o(),d("div",ol)):k("",!0),v(" "+i(e.$t("common.add")),1)],8,sl)])],32)])])]))}}),ll={class:"space-y-4"},il={class:"flex justify-end"},nl={class:"space-y-3"},ml={class:"flex items-start space-x-3"},cl={class:"flex-shrink-0"},ul={class:"flex-1 min-w-0"},gl={class:"flex items-center justify-between"},xl={class:"flex items-center space-x-2"},yl={class:"text-sm font-medium text-gray-900 dark:text-white"},bl={class:"text-xs text-gray-500 dark:text-gray-400"},pl={key:0,class:"mt-1"},kl={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},vl={class:"mt-2"},fl={class:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2"},hl={key:0,class:"text-center py-8"},wl={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},_l={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},$l=t({__name:"CustomerCommunications",props:{customer:{}},setup(t){const r=t,s=e(),n=a(!1),m=f(()=>s.communications),u=()=>{n.value=!1,s.fetchCommunications(r.customer.id)},h=e=>{const t={email:"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300",sms:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300",whatsapp:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300",phone:"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-300",meeting:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-300",note:"bg-gray-100 text-gray-600 dark:bg-gray-900 dark:text-gray-300"};return t[e]||t.note},_=e=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",delivered:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",read:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",failed:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};return t[e]||t.draft};return(e,t)=>(o(),d("div",ll,[l("div",il,[l("button",{onClick:t[0]||(t[0]=e=>n.value=!0),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700"},[g(c(P),{class:"h-4 w-4 mr-2"}),v(" "+i(e.$t("communication.add_communication")),1)])]),l("div",nl,[(o(!0),d(x,null,y(m.value,t=>{return o(),d("div",{key:t.id,class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},[l("div",ml,[l("div",cl,[l("div",{class:b(["h-8 w-8 rounded-full flex items-center justify-center",h(t.type)])},[(o(),p(w((r=t.type,{email:R,sms:A,whatsapp:A,phone:F,meeting:I,note:M}[r]||M)),{class:"h-4 w-4"}))],2)]),l("div",ul,[l("div",gl,[l("div",xl,[l("span",yl,i(e.$t(`communication.${t.type}`)),1),l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",_(t.status)])},i(e.$t(`communication.statuses.${t.status}`)),3)]),l("span",bl,i((a=t.created_at,new Date(a).toLocaleDateString())),1)]),t.subject?(o(),d("div",pl,[l("p",kl,i(t.subject),1)])):k("",!0),l("div",vl,[l("p",fl,i(t.message),1)])])])]);var a,r}),128)),0===m.value.length?(o(),d("div",hl,[g(c(q),{class:"mx-auto h-12 w-12 text-gray-400"}),l("h3",wl,i(e.$t("communication.no_communications")),1),l("p",_l,i(e.$t("communication.no_communications_customer")),1)])):k("",!0)]),n.value?(o(),p(dl,{key:0,customer:e.customer,onClose:t[1]||(t[1]=e=>n.value=!1),onAdded:u},null,8,["customer"])):k("",!0)]))}}),Cl={class:"space-y-4"},jl={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ul={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Vl={class:"text-2xl font-bold text-gray-900 dark:text-white"},Sl={class:"text-sm text-gray-500 dark:text-gray-400"},Dl={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},El={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ol={class:"text-sm text-gray-500 dark:text-gray-400"},Ll={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Ml={class:"text-2xl font-bold text-red-600 dark:text-red-400"},Rl={class:"text-sm text-gray-500 dark:text-gray-400"},Al={class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},Fl={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Il={class:"text-lg font-medium text-gray-900 dark:text-white"},zl={key:0,class:"p-8 text-center"},ql={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Nl={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Pl={key:1,class:"divide-y divide-gray-200 dark:divide-gray-700"},Tl={class:"flex items-center justify-between"},Bl={class:"flex items-center space-x-4"},Jl={class:"flex-shrink-0"},Kl={class:"h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center"},Gl={class:"flex items-center space-x-2"},Hl={class:"text-sm font-medium text-gray-900 dark:text-white"},Ql={class:"mt-1 flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400"},Wl={class:"text-right"},Xl={class:"text-lg font-semibold text-gray-900 dark:text-white"},Yl={key:0,class:"text-sm text-red-600 dark:text-red-400"},Zl=t({__name:"CustomerInvoices",props:{customer:{}},setup(e){const t=f(()=>[]),a=f(()=>t.value.reduce((e,t)=>e+t.total_amount,0)),r=f(()=>t.value.filter(e=>["sent","overdue"].includes(e.status)).reduce((e,t)=>e+t.total_amount,0)),s=e=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",paid:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",overdue:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",cancelled:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"};return t[e]||t.draft},n=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),m=e=>new Date(e).toLocaleDateString();return(e,u)=>(o(),d("div",Cl,[l("div",jl,[l("div",Ul,[l("div",Vl,i(t.value.length),1),l("div",Sl,i(e.$t("invoices.total_invoices")),1)]),l("div",Dl,[l("div",El,i(n(a.value)),1),l("div",Ol,i(e.$t("invoices.total_invoiced")),1)]),l("div",Ll,[l("div",Ml,i(n(r.value)),1),l("div",Rl,i(e.$t("invoices.outstanding_balance")),1)])]),l("div",Al,[l("div",Fl,[l("h4",Il,i(e.$t("invoices.invoice_history")),1)]),0===t.value.length?(o(),d("div",zl,[g(c(M),{class:"mx-auto h-12 w-12 text-gray-400"}),l("h3",ql,i(e.$t("invoices.no_invoices")),1),l("p",Nl,i(e.$t("invoices.no_invoices_customer")),1)])):(o(),d("div",Pl,[(o(!0),d(x,null,y(t.value,t=>(o(),d("div",{key:t.id,class:"p-6 hover:bg-gray-50 dark:hover:bg-gray-700"},[l("div",Tl,[l("div",Bl,[l("div",Jl,[l("div",Kl,[g(c(M),{class:"h-5 w-5 text-blue-600 dark:text-blue-300"})])]),l("div",null,[l("div",Gl,[l("p",Hl,i(t.invoice_number),1),l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",s(t.status)])},i(e.$t(`invoices.statuses.${t.status}`)),3)]),l("div",Ql,[l("span",null,i(e.$t("invoices.issued"))+": "+i(m(t.issue_date)),1),l("span",null,i(e.$t("invoices.due"))+": "+i(m(t.due_date)),1)])])]),l("div",Wl,[l("div",Xl,i(n(t.total_amount)),1),"overdue"===t.status?(o(),d("div",Yl,i(e.$t("invoices.overdue")),1)):k("",!0)])])]))),128))]))])]))}}),ei={class:"fixed inset-0 z-50 overflow-y-auto"},ti={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ai={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6"},ri={key:0},si={class:"flex items-center justify-between mb-6"},oi={class:"flex items-center space-x-4"},di={class:"flex-shrink-0 h-16 w-16"},li={class:"h-16 w-16 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center"},ii={class:"text-xl font-medium text-primary-800 dark:text-primary-200"},ni={class:"text-xl font-semibold text-gray-900 dark:text-white"},mi={class:"flex items-center space-x-2 mt-1"},ci={class:"flex items-center space-x-2"},ui={class:"border-b border-gray-200 dark:border-gray-700 mb-6"},gi={class:"-mb-px flex space-x-8"},xi=["onClick"],yi={class:"space-y-6"},bi={key:0},pi={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ki={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},vi={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},fi={class:"space-y-2"},hi={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},wi={class:"text-sm text-gray-900 dark:text-white"},_i={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},$i={class:"text-sm text-gray-900 dark:text-white"},Ci={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},ji={class:"text-sm text-gray-900 dark:text-white"},Ui={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},Vi={class:"text-sm text-gray-900 dark:text-white"},Si={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Di={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},Ei={class:"space-y-2"},Oi={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},Li={class:"text-sm text-gray-900 dark:text-white"},Mi={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},Ri={class:"text-sm text-gray-900 dark:text-white"},Ai={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},Fi={class:"text-sm text-gray-900 dark:text-white"},Ii={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},zi={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},qi={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},Ni={class:"space-y-2"},Pi={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},Ti={class:"text-sm text-gray-900 dark:text-white"},Bi={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},Ji={class:"text-sm text-gray-900 dark:text-white"},Ki={key:0},Gi={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},Hi={class:"text-sm text-gray-900 dark:text-white"},Qi={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Wi={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},Xi={class:"space-y-2"},Yi={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},Zi={class:"text-sm text-gray-900 dark:text-white"},en={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},tn={class:"text-sm text-gray-900 dark:text-white"},an={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},rn={class:"text-sm text-gray-900 dark:text-white"},sn={key:0},on={class:"text-xs font-medium text-gray-500 dark:text-gray-400"},dn={class:"text-sm text-gray-900 dark:text-white"},ln={class:"flex flex-wrap gap-1 mt-1"},nn={key:0,class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},mn={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},cn={class:"text-sm text-gray-600 dark:text-gray-300 whitespace-pre-wrap"},un={key:1},gn={key:2},xn=t({__name:"CustomerDetailsModal",props:{customer:{}},emits:["close","edit","delete"],setup(t){const r=t,s=e(),n=a("details"),m=[{key:"details",label:"customers.tabs.details"},{key:"communications",label:"customers.tabs.communications"},{key:"invoices",label:"customers.tabs.invoices"}],u=async()=>{if(r.customer)try{await s.exportVCard(r.customer.id)}catch(e){}},p=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),f=e=>e?new Date(e).toLocaleDateString():"-";return(e,t)=>{return o(),d("div",ei,[l("div",ti,[l("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),l("div",ai,[e.customer?(o(),d("div",ri,[l("div",si,[l("div",oi,[l("div",di,[l("div",li,[l("span",ii,i((s=e.customer.name,s.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().slice(0,2))),1)])]),l("div",null,[l("h3",ni,i(e.customer.name),1),l("div",mi,[l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",(r=e.customer.customer_type,{retail:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",wholesale:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",vip:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}[r]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200")])},i(e.$t(`customers.types.${e.customer.customer_type}`)),3),l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",(a=e.customer.crm_stage,{lead:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",prospect:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",customer:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",inactive:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}[a]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200")])},i(e.$t(`customers.stages.${e.customer.crm_stage}`)),3),l("span",{class:b(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",e.customer.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"])},i(e.customer.is_active?e.$t("common.active"):e.$t("common.inactive")),3)])])]),l("div",ci,[l("button",{onClick:u,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[g(c(V),{class:"h-4 w-4 mr-2"}),v(" "+i(e.$t("customers.export_vcard")),1)]),l("button",{onClick:t[1]||(t[1]=t=>e.$emit("edit",e.customer)),class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[g(c(U),{class:"h-4 w-4 mr-2"}),v(" "+i(e.$t("common.edit")),1)]),l("button",{onClick:t[2]||(t[2]=t=>e.$emit("delete",e.customer)),class:"inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm leading-4 font-medium rounded-md text-red-700 bg-white hover:bg-red-50"},[g(c(S),{class:"h-4 w-4 mr-2"}),v(" "+i(e.$t("common.delete")),1)]),l("button",{onClick:t[3]||(t[3]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[g(c(L),{class:"h-6 w-6"})])])]),l("div",ui,[l("nav",gi,[(o(),d(x,null,y(m,t=>l("button",{key:t.key,onClick:e=>n.value=t.key,class:b(["whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm",n.value===t.key?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"])},i(e.$t(t.label)),11,xi)),64))])]),l("div",yi,["details"===n.value?(o(),d("div",bi,[l("div",pi,[l("div",ki,[l("h4",vi,i(e.$t("customers.contact_information")),1),l("dl",fi,[l("div",null,[l("dt",hi,i(e.$t("customers.email")),1),l("dd",wi,i(e.customer.email||"-"),1)]),l("div",null,[l("dt",_i,i(e.$t("customers.phone")),1),l("dd",$i,i(e.customer.phone||"-"),1)]),l("div",null,[l("dt",Ci,i(e.$t("customers.address")),1),l("dd",ji,i(e.customer.address||"-"),1)]),l("div",null,[l("dt",Ui,i(e.$t("customers.preferred_language")),1),l("dd",Vi,i(e.$t(`languages.${e.customer.preferred_language}`)),1)])])]),l("div",Si,[l("h4",Di,i(e.$t("customers.financial_information")),1),l("dl",Ei,[l("div",null,[l("dt",Oi,i(e.$t("customers.credit_limit")),1),l("dd",Li,i(p(e.customer.credit_limit||0)),1)]),l("div",null,[l("dt",Mi,i(e.$t("customers.payment_terms")),1),l("dd",Ri,i(e.customer.payment_terms||0)+" "+i(e.$t("common.days")),1)]),l("div",null,[l("dt",Ai,i(e.$t("customers.total_invoiced")),1),l("dd",Fi,i(p(e.customer.total_invoice_amount||0)),1)]),l("div",null,[l("dt",Ii,i(e.$t("customers.outstanding_balance")),1),l("dd",{class:b(["text-sm font-semibold",e.customer.outstanding_balance&&e.customer.outstanding_balance>0?"text-red-600 dark:text-red-400":"text-gray-900 dark:text-white"])},i(p(e.customer.outstanding_balance||0)),3)])])]),l("div",zi,[l("h4",qi,i(e.$t("customers.personal_information")),1),l("dl",Ni,[l("div",null,[l("dt",Pi,i(e.$t("customers.birthday")),1),l("dd",Ti,i(f(e.customer.birthday)),1)]),l("div",null,[l("dt",Bi,i(e.$t("customers.anniversary")),1),l("dd",Ji,i(f(e.customer.anniversary)),1)]),e.customer.age?(o(),d("div",Ki,[l("dt",Gi,i(e.$t("customers.age")),1),l("dd",Hi,i(e.customer.age)+" "+i(e.$t("common.years")),1)])):k("",!0)])]),l("div",Qi,[l("h4",Wi,i(e.$t("customers.crm_information")),1),l("dl",Xi,[l("div",null,[l("dt",Yi,i(e.$t("customers.lead_source")),1),l("dd",Zi,i(e.customer.lead_source?e.$t(`customers.lead_sources.${e.customer.lead_source}`):"-"),1)]),l("div",null,[l("dt",en,i(e.$t("customers.preferred_communication")),1),l("dd",tn,i(e.customer.preferred_communication_method?e.$t(`communication.${e.customer.preferred_communication_method}`):"-"),1)]),l("div",null,[l("dt",an,i(e.$t("customers.last_invoice")),1),l("dd",rn,i(f(e.customer.last_invoice_date)),1)]),e.customer.tags&&e.customer.tags.length>0?(o(),d("div",sn,[l("dt",on,i(e.$t("customers.tags")),1),l("dd",dn,[l("div",ln,[(o(!0),d(x,null,y(e.customer.tags,e=>(o(),d("span",{key:e,class:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},i(e),1))),128))])])])):k("",!0)])])]),e.customer.notes?(o(),d("div",nn,[l("h4",mn,i(e.$t("customers.notes")),1),l("p",cn,i(e.customer.notes),1)])):k("",!0)])):k("",!0),"communications"===n.value?(o(),d("div",un,[g($l,{customer:e.customer},null,8,["customer"])])):k("",!0),"invoices"===n.value?(o(),d("div",gn,[g(Zl,{customer:e.customer},null,8,["customer"])])):k("",!0)])])):k("",!0)])])]);var a,r,s}}}),yn={class:"space-y-6"},bn={class:"sm:flex sm:items-center sm:justify-between"},pn={class:"sm:flex-auto"},kn={class:"text-2xl font-semibold text-gray-900 dark:text-white"},vn={class:"mt-2 text-sm text-gray-700 dark:text-gray-300"},fn={class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},hn={class:"border-b border-gray-200 dark:border-gray-700"},wn={class:"-mb-px flex space-x-8"},_n=["onClick"],$n={class:"mt-6"},Cn={key:0},jn={key:1},Un={key:2},Vn={key:3},Sn=t({__name:"CustomersView",setup(t){const r=e(),n=a("list"),m=a(!1),u=a(!1),f=a(!1),h=a(!1),w=a(null),_=[{key:"list",label:"customers.tabs.list"},{key:"crm",label:"customers.tabs.crm_pipeline"},{key:"communication",label:"customers.tabs.communication"},{key:"aging",label:"customers.tabs.aging_report"}],$=e=>{w.value=e,u.value=!0,f.value=!1},C=e=>{w.value=e,f.value=!0},j=e=>{w.value=e,h.value=!0,f.value=!1},U=async()=>{if(w.value)try{await r.deleteCustomer(w.value.id),h.value=!1,w.value=null}catch(e){}},V=()=>{S(),r.fetchCustomers()},S=()=>{m.value=!1,u.value=!1,f.value=!1,w.value=null};return s(()=>{r.fetchCustomers()}),(e,t)=>{var a;return o(),d("div",yn,[l("div",bn,[l("div",pn,[l("h1",kn,i(e.$t("customers.title")),1),l("p",vn,i(e.$t("customers.description")),1)]),l("div",fn,[l("button",{onClick:t[0]||(t[0]=e=>m.value=!0),type:"button",class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"},[g(c(P),{class:"h-4 w-4 mr-2"}),v(" "+i(e.$t("customers.add_customer")),1)])])]),l("div",hn,[l("nav",wn,[(o(),d(x,null,y(_,t=>l("button",{key:t.key,onClick:e=>n.value=t.key,class:b(["whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm",n.value===t.key?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"])},i(e.$t(t.label)),11,_n)),64))])]),l("div",$n,["list"===n.value?(o(),d("div",Cn,[g(rt,{onEditCustomer:$,onViewCustomer:C,onDeleteCustomer:j})])):k("",!0),"crm"===n.value?(o(),d("div",jn,[g(ea)])):k("",!0),"communication"===n.value?(o(),d("div",Un,[g(ks)])):k("",!0),"aging"===n.value?(o(),d("div",Vn,[g($o)])):k("",!0)]),m.value||u.value?(o(),p(Fd,{key:0,customer:w.value,"is-edit":u.value,onClose:S,onSaved:V},null,8,["customer","is-edit"])):k("",!0),f.value?(o(),p(xn,{key:1,customer:w.value,onClose:S,onEdit:$,onDelete:j},null,8,["customer"])):k("",!0),h.value?(o(),p(T,{key:2,title:e.$t("customers.delete_customer"),message:e.$t("customers.delete_confirmation",{name:null==(a=w.value)?void 0:a.name}),loading:c(r).loading.deleting,onConfirm:U,onCancel:t[1]||(t[1]=e=>h.value=!1)},null,8,["title","message","loading"])):k("",!0)])}}});export{Sn as default};
