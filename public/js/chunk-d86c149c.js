import{m as e,r as t,c as a,d as r,w as s,o as l,a as i,p as n,u as o,D as d,t as c,x as u,q as g,j as m,v,z as y,G as p,I as x,F as b,y as f,n as h,H as k,B as w,M as _,C as $,L as C,E as I,N as j}from"./chunk-300a47f1.js";import{a as P,u as D,t as V,v as M,f as S,w as T,c as U,x as q,d as F,y as z,z as B,e as L,A as R,l as A,h as Y,B as N,C as E,m as G,D as O,E as H,F as J,G as W,H as X,I as Q}from"./chunk-9984d79b.js";import{u as K,_ as Z}from"./chunk-9edc2f6d.js";import{u as ee}from"./chunk-e8ade734.js";const te=e("invoices",()=>{const e=t([]),r=t(null),s=t([]),l=t(null),i=t([]),n=t({invoices:!1,invoice:!1,templates:!1,template:!1,recurring:!1,creating:!1,updating:!1,deleting:!1,generating:!1,pdf:!1,batch:!1}),o=t({current_page:1,last_page:1,per_page:15,total:0,from:0,to:0}),d=t({search:"",customer_id:"",status:"",language:"",date_from:"",date_to:"",template_id:"",tags:"",main_category_id:"",category_id:"",gold_purity_min:"",gold_purity_max:"",sort_by:"created_at",sort_direction:"desc"}),c=a(()=>e.value.filter(e=>"draft"===e.status)),u=a(()=>e.value.filter(e=>"sent"===e.status)),g=a(()=>e.value.filter(e=>"paid"===e.status)),m=a(()=>e.value.filter(e=>"overdue"===e.status)),v=a(()=>e.value.reduce((e,t)=>e+t.total_amount,0)),y=a(()=>e.value.filter(e=>["sent","overdue"].includes(e.status)).reduce((e,t)=>e+t.total_amount,0));return{invoices:e,currentInvoice:r,templates:s,currentTemplate:l,recurringInvoices:i,loading:n,pagination:o,filters:d,draftInvoices:c,sentInvoices:u,paidInvoices:g,overdueInvoices:m,totalInvoiceAmount:v,totalOutstanding:y,fetchInvoices:async t=>{n.value.invoices=!0;try{const a={...d.value,...t},r=await P.invoices.getInvoices(a);if(r.data.success){const t=r.data.data;e.value=t.data,o.value={current_page:t.current_page,last_page:t.last_page,per_page:t.per_page,total:t.total,from:t.from||0,to:t.to||0}}}catch(a){throw a}finally{n.value.invoices=!1}},fetchInvoice:async e=>{n.value.invoice=!0;try{const t=await P.invoices.getInvoice(e);t.data.success&&(r.value=t.data.data)}catch(t){throw t}finally{n.value.invoice=!1}},createInvoice:async t=>{n.value.creating=!0;try{const a=await P.invoices.createInvoice(t);if(a.data.success){const t=a.data.data;return e.value.unshift(t),t}}catch(a){throw a}finally{n.value.creating=!1}},updateInvoice:async(t,a)=>{var s;n.value.updating=!0;try{const l=await P.invoices.updateInvoice(t,a);if(l.data.success){const a=l.data.data,i=e.value.findIndex(e=>e.id===t);return-1!==i&&(e.value[i]=a),(null==(s=r.value)?void 0:s.id)===t&&(r.value=a),a}}catch(l){throw l}finally{n.value.updating=!1}},deleteInvoice:async t=>{var a;n.value.deleting=!0;try{(await P.invoices.deleteInvoice(t)).data.success&&(e.value=e.value.filter(e=>e.id!==t),(null==(a=r.value)?void 0:a.id)===t&&(r.value=null))}catch(s){throw s}finally{n.value.deleting=!1}},generatePDF:async e=>{n.value.pdf=!0;try{const t=await P.invoices.generatePDF(e);if(t.data.success){const{pdf_url:e,filename:a}=t.data.data,r=document.createElement("a");return r.href=e,r.download=a,document.body.appendChild(r),r.click(),document.body.removeChild(r),t.data.data}}catch(t){throw t}finally{n.value.pdf=!1}},previewPDF:async e=>{n.value.pdf=!0;try{const t=await P.invoices.previewPDF(e);if(t.data.success)return t.data.data}catch(t){throw t}finally{n.value.pdf=!1}},sendInvoice:async(t,a)=>{try{const r=await P.invoices.sendInvoice(t,{method:a});if(r.data.success){const a=e.value.findIndex(e=>e.id===t);return-1!==a&&(e.value[a].status="sent"),r.data.data}}catch(r){throw r}},duplicateInvoice:async t=>{n.value.creating=!0;try{const a=await P.invoices.duplicateInvoice(t);if(a.data.success){const t=a.data.data;return e.value.unshift(t),t}}catch(a){throw a}finally{n.value.creating=!1}},fetchTemplates:async()=>{var e,t;n.value.templates=!0;try{const t=await P.invoices.getTemplates();if(t.data.success){const a=(null==(e=t.data.data)?void 0:e.data)||t.data.data||[];s.value=Array.isArray(a)?a:[]}else s.value=[]}catch(a){try{const e=localStorage.getItem("auth_token");if(e){const t=await fetch("/api/invoice-templates",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${e}`,"X-Requested-With":"XMLHttpRequest"},credentials:"include"}),a=await t.json();if(a.success&&a.data){const e=a.data.data||a.data||[];return void(s.value=Array.isArray(e)?e:[])}}}catch(r){}if(Array.isArray(s.value)||(s.value=[]),401===(null==(t=a.response)?void 0:t.status))return}finally{n.value.templates=!1}},fetchTemplate:async e=>{n.value.template=!0;try{const t=await P.invoices.getTemplate(e);t.data.success&&(l.value=t.data.data)}catch(t){throw t}finally{n.value.template=!1}},createTemplate:async e=>{n.value.creating=!0;try{const t=await P.invoices.createTemplate(e);if(t.data.success){const e=t.data.data;return Array.isArray(s.value)||(s.value=[]),s.value.unshift(e),e}}catch(t){throw t}finally{n.value.creating=!1}},updateTemplate:async(e,t)=>{var a;n.value.updating=!0;try{const r=await P.invoices.updateTemplate(e,t);if(r.data.success){const t=r.data.data,i=s.value.findIndex(t=>t.id===e);return-1!==i&&(s.value[i]=t),(null==(a=l.value)?void 0:a.id)===e&&(l.value=t),t}}catch(r){throw r}finally{n.value.updating=!1}},deleteTemplate:async e=>{var t;n.value.deleting=!0;try{(await P.invoices.deleteTemplate(e)).data.success&&(s.value=s.value.filter(t=>t.id!==e),(null==(t=l.value)?void 0:t.id)===e&&(l.value=null))}catch(a){throw a}finally{n.value.deleting=!1}},generateBatchInvoices:async e=>{n.value.batch=!0;try{const t=await P.invoices.generateBatch(e);if(t.data.success)return t.data.data}catch(t){throw t}finally{n.value.batch=!1}},sendBatchInvoices:async(t,a)=>{n.value.batch=!0;try{const r=await P.invoices.sendBatch(t,{method:a});if(r.data.success)return t.forEach(t=>{const a=e.value.findIndex(e=>e.id===t);-1!==a&&(e.value[a].status="sent")}),r.data.data}catch(r){throw r}finally{n.value.batch=!1}},fetchRecurringInvoices:async()=>{n.value.recurring=!0;try{const e=await P.invoices.getRecurringInvoices();e.data.success&&(i.value=e.data.data)}catch(e){throw e}finally{n.value.recurring=!1}},createRecurringInvoice:async e=>{n.value.creating=!0;try{const t=await P.invoices.createRecurringInvoice(e);if(t.data.success){const e=t.data.data;return i.value.unshift(e),e}}catch(t){throw t}finally{n.value.creating=!1}},updateRecurringInvoice:async(e,t)=>{n.value.updating=!0;try{const a=await P.invoices.updateRecurringInvoice(e,t);if(a.data.success){const t=a.data.data,r=i.value.findIndex(t=>t.id===e);return-1!==r&&(i.value[r]=t),t}}catch(a){throw a}finally{n.value.updating=!1}},updateFilters:e=>{d.value={...d.value,...e}},resetFilters:()=>{d.value={search:"",customer_id:"",status:"",language:"",date_from:"",date_to:"",template_id:"",tags:"",main_category_id:"",category_id:"",gold_purity_min:"",gold_purity_max:"",sort_by:"created_at",sort_direction:"desc"}},clearCurrentInvoice:()=>{r.value=null},clearCurrentTemplate:()=>{l.value=null}}});function ae(){const{locale:e}=ee(),t=e=>{let t=e.getFullYear();const a=e.getMonth()+1,s=e.getDate(),l=[0,31,59,90,120,151,181,212,243,273,304,334];let i=t<=1600?0:979;t>1600&&(t-=1600),t>1600&&(i+=33*Math.floor(t/33)),t>1600&&(t%=33);let n=0;for(let m=0;m<t;m++)n+=r(1600+m)?366:365;n+=l[a-1],a>2&&r(t+1600)&&n++,n+=s;let o=n-79;const d=Math.floor(o/12053);o%=12053,i+=33*d;const c=Math.floor(o/1029);let u,g=o%1029;if(c>=33){const e=(c-33)%128;i+=128*Math.floor((c-33)/128)+29*e,e>=29&&(i++,g+=366)}else i+=29*c,c>=29&&(g+=366);return g>=366&&(i++,g-=366),g<186?(u=1+Math.floor(g/31),o=1+g%31):(u=7+Math.floor((g-186)/30),o=1+(g-186)%30),{year:i,month:u,day:o}},a=(e,t,a)=>{let s=e<=979?1600:1979;e>979&&(e-=979),e>979&&(s+=400*Math.floor(e/1029)),e>979&&(e%=1029);let l=0;if(e>=29){const t=e%33;l+=12053*Math.floor(e/33),t>=29?(l+=366,e=t-29):e=t,e>=1&&(l+=1461*Math.floor((e-1)/4),(e=(e-1)%4)>=1&&(l+=365*(e-1)+Math.floor(e/4)))}else l+=365*e+Math.floor(e/4);l+=t<7?31*(t-1):30*(t-7)+186,l+=a-1;let i=l+79;const n=Math.floor(i/146097);i%=146097,s+=400*n;let o=Math.floor(i/36524);o>=4&&(o=3),i-=36524*o,s+=100*o,o=Math.floor(i/1461),i%=1461,s+=4*o,o=Math.floor(i/365),o>=4&&(o=3),i-=365*o,s+=o;const d=[0,31,28,31,30,31,30,31,31,30,31,30,31];r(s)&&(d[2]=29);let c=0;for(;c<13&&i>=d[c];)i-=d[c],c++;return c>12&&(c=12,i=d[12]),new Date(s,c-1,i+1)},r=e=>e%4==0&&e%100!=0||e%400==0,s=(e,a="YYYY/MM/DD")=>{const r=t(e);return a.replace("YYYY",r.year.toString()).replace("YY",r.year.toString().slice(-2)).replace("MM",r.month.toString().padStart(2,"0")).replace("M",r.month.toString()).replace("DD",r.day.toString().padStart(2,"0")).replace("D",r.day.toString())},l=(e,t="YYYY/MM/DD")=>{const a=e.getFullYear(),r=e.getMonth()+1,s=e.getDate();return t.replace("YYYY",a.toString()).replace("YY",a.toString().slice(-2)).replace("MM",r.toString().padStart(2,"0")).replace("M",r.toString()).replace("DD",s.toString().padStart(2,"0")).replace("D",s.toString())};return{convertToJalali:t,convertToGregorian:a,isGregorianLeapYear:r,isJalaliLeapYear:e=>{const t=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];let a=t[0],r=0;for(let l=1;l<=t.length;l++){const s=t[l];if(r=s-a,e<s)break;a=s}let s=e-a;return s<r&&(s-=33*Math.floor(s/33),s%4==1)},formatJalaliDate:s,formatGregorianDate:l,getCurrentDate:()=>new Date,parseDate:t=>{if(!t)return null;try{if("fa"===e.value){const e=t.split("/");if(3===e.length){const t=parseInt(e[0]),r=parseInt(e[1]),s=parseInt(e[2]);return a(t,r,s)}}else{const e=new Date(t);if(!isNaN(e.getTime()))return e}}catch(r){}return null},formatDate:(t,a)=>{if(!t)return"";const r="string"==typeof t?new Date(t):t;return isNaN(r.getTime())?"":"fa"===e.value?s(r,a):l(r,a)},getMonthNames:()=>"fa"===e.value?["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"]:["January","February","March","April","May","June","July","August","September","October","November","December"],getWeekdayNames:()=>"fa"===e.value?["شنبه","یکشنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه"]:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}}const re={class:"relative"},se={key:0,class:"text-red-500 ml-1"},le={class:"relative"},ie=["value","placeholder","readonly"],ne={class:"p-4"},oe={class:"flex items-center justify-between mb-4"},de={class:"flex items-center space-x-2 rtl:space-x-reverse"},ce=["value"],ue=["value"],ge={class:"flex justify-center mb-4"},me={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},ve={class:"grid grid-cols-7 gap-1 mb-2"},ye={class:"grid grid-cols-7 gap-1"},pe=["onClick","disabled"],xe={class:"mt-4 flex justify-center"},be=r({__name:"DatePicker",props:{modelValue:{default:null},label:{},placeholder:{default:""},required:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},minDate:{},maxDate:{},calendarType:{default:"auto"},format:{default:"YYYY/MM/DD"},size:{default:"md"}},emits:["update:modelValue","change"],setup(e,{emit:r}){const k=e,w=r,{locale:_,t:$}=ee(),{convertToJalali:C,convertToGregorian:I,formatJalaliDate:j,formatGregorianDate:P}=ae(),{formatNumber:T}=D(),U=t(),q=t(!1),F=t((new Date).getMonth()),z=t((new Date).getFullYear()),B=a(()=>"auto"===k.calendarType?"fa"===_.value?"jalali":"gregorian":k.calendarType),L=t(B.value);s(_,()=>{"auto"===k.calendarType&&(L.value="fa"===_.value?"jalali":"gregorian",$e())});const R=a(()=>"jalali"===L.value?[$("calendar.months.jalali.farvardin"),$("calendar.months.jalali.ordibehesht"),$("calendar.months.jalali.khordad"),$("calendar.months.jalali.tir"),$("calendar.months.jalali.mordad"),$("calendar.months.jalali.shahrivar"),$("calendar.months.jalali.mehr"),$("calendar.months.jalali.aban"),$("calendar.months.jalali.azar"),$("calendar.months.jalali.dey"),$("calendar.months.jalali.bahman"),$("calendar.months.jalali.esfand")]:[$("calendar.months.gregorian.january"),$("calendar.months.gregorian.february"),$("calendar.months.gregorian.march"),$("calendar.months.gregorian.april"),$("calendar.months.gregorian.may"),$("calendar.months.gregorian.june"),$("calendar.months.gregorian.july"),$("calendar.months.gregorian.august"),$("calendar.months.gregorian.september"),$("calendar.months.gregorian.october"),$("calendar.months.gregorian.november"),$("calendar.months.gregorian.december")]),A=a(()=>"jalali"===L.value?[$("calendar.weekdays.jalali.saturday"),$("calendar.weekdays.jalali.sunday"),$("calendar.weekdays.jalali.monday"),$("calendar.weekdays.jalali.tuesday"),$("calendar.weekdays.jalali.wednesday"),$("calendar.weekdays.jalali.thursday"),$("calendar.weekdays.jalali.friday")]:[$("calendar.weekdays.gregorian.sunday"),$("calendar.weekdays.gregorian.monday"),$("calendar.weekdays.gregorian.tuesday"),$("calendar.weekdays.gregorian.wednesday"),$("calendar.weekdays.gregorian.thursday"),$("calendar.weekdays.gregorian.friday"),$("calendar.weekdays.gregorian.saturday")]),Y=a(()=>{const e=(new Date).getFullYear(),t=e+10,a=[];for(let r=e-50;r<=t;r++)if("jalali"===L.value){const e=C(new Date(r,0,1)).year;a.push(e)}else a.push(r);return a.sort((e,t)=>t-e)}),N=a(()=>k.modelValue?k.modelValue instanceof Date?k.modelValue:new Date(k.modelValue):null),E=a(()=>N.value?"jalali"===L.value?j(N.value,k.format):P(N.value,k.format):""),G=a(()=>{const e=[],t=new Date;if("jalali"===L.value){const a=C(new Date(z.value,F.value,1)),r=I(a.year,a.month,1),s=I(a.year,a.month,K(a.year,a.month));for(let n=(r.getDay()+1)%7-1;n>=0;n--){const a=new Date(r);a.setDate(a.getDate()-n-1);const s=C(a);e.push({day:s.day,month:s.month,year:s.year,date:a,isCurrentMonth:!1,isToday:X(a,t),isSelected:!!N.value&&X(a,N.value),disabled:Q(a)})}const l=K(a.year,a.month);for(let n=1;n<=l;n++){const r=I(a.year,a.month,n);e.push({day:n,month:a.month,year:a.year,date:r,isCurrentMonth:!0,isToday:X(r,t),isSelected:!!N.value&&X(r,N.value),disabled:Q(r)})}const i=42-e.length;for(let n=1;n<=i;n++){const a=new Date(s);a.setDate(a.getDate()+n);const r=C(a);e.push({day:r.day,month:r.month,year:r.year,date:a,isCurrentMonth:!1,isToday:X(a,t),isSelected:!!N.value&&X(a,N.value),disabled:Q(a)})}}else{const a=new Date(z.value,F.value,1),r=new Date(z.value,F.value+1,0);for(let i=a.getDay()-1;i>=0;i--){const r=new Date(a);r.setDate(r.getDate()-i-1),e.push({day:r.getDate(),month:r.getMonth(),year:r.getFullYear(),date:r,isCurrentMonth:!1,isToday:X(r,t),isSelected:!!N.value&&X(r,N.value),disabled:Q(r)})}const s=r.getDate();for(let i=1;i<=s;i++){const a=new Date(z.value,F.value,i);e.push({day:i,month:F.value,year:z.value,date:a,isCurrentMonth:!0,isToday:X(a,t),isSelected:!!N.value&&X(a,N.value),disabled:Q(a)})}const l=42-e.length;for(let i=1;i<=l;i++){const a=new Date(z.value,F.value+1,i);e.push({day:i,month:F.value+1,year:z.value,date:a,isCurrentMonth:!1,isToday:X(a,t),isSelected:!!N.value&&X(a,N.value),disabled:Q(a)})}}return e}),O=a(()=>["block text-sm font-medium mb-2","text-gray-700 dark:text-gray-300"]),H=a(()=>["block w-full rounded-md border-gray-300 dark:border-gray-600","bg-white dark:bg-gray-700","text-gray-900 dark:text-gray-100","shadow-sm focus:border-primary-500 focus:ring-primary-500","disabled:bg-gray-50 disabled:text-gray-500",{"text-sm py-2 px-3":"sm"===k.size,"py-2.5 px-3":"md"===k.size,"text-lg py-3 px-4":"lg"===k.size},{"pr-10":"en"===_.value,"pl-10":"fa"===_.value}]),J=a(()=>["absolute inset-y-0 flex items-center px-3","text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",{"right-0":"en"===_.value,"left-0":"fa"===_.value}]),W=a(()=>["absolute z-50 mt-1 bg-white dark:bg-gray-800","border border-gray-200 dark:border-gray-700","rounded-lg shadow-lg min-w-80",{"right-0":"en"===_.value,"left-0":"fa"===_.value}]),X=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),Q=e=>!!k.disabled||(!!(k.minDate&&e<k.minDate)||!!(k.maxDate&&e>k.maxDate)),K=(e,t)=>t<=6?31:t<=11||Z(e)?30:29,Z=e=>{const t=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];let a=t[0],r=0;for(let l=1;l<=t.length;l++){const s=t[l];if(r=s-a,e<s)break;a=s}let s=e-a;return s<r&&(s-=33*Math.floor(s/33),s%4==1)},te=e=>["w-8 h-8 text-sm rounded-full transition-colors","hover:bg-gray-100 dark:hover:bg-gray-700","focus:outline-none focus:ring-2 focus:ring-primary-500",{"text-gray-900 dark:text-gray-100":e.isCurrentMonth,"text-gray-400 dark:text-gray-600":!e.isCurrentMonth,"bg-primary-600 text-white hover:bg-primary-700":e.isSelected,"bg-primary-100 text-primary-900 dark:bg-primary-900 dark:text-primary-100":e.isToday&&!e.isSelected,"opacity-50 cursor-not-allowed":e.disabled,"cursor-pointer":!e.disabled}],be=e=>{const t=e.target.value;try{let e=null;if("jalali"===L.value){const a=t.split("/");if(3===a.length){const t=parseInt(a[0]),r=parseInt(a[1]),s=parseInt(a[2]);e=I(t,r,s)}}else e=new Date(t),isNaN(e.getTime())&&(e=null);e&&!Q(e)&&(w("update:modelValue",e),w("change",e))}catch(a){}},fe=()=>{setTimeout(()=>{q.value=!1},200)},he=()=>{k.disabled||k.readonly||(q.value=!q.value)},ke=()=>{const e=new Date;Q(e)||(w("update:modelValue",e),w("change",e),q.value=!1)},we=()=>{"jalali"===L.value?1===F.value?(F.value=12,z.value--):F.value--:0===F.value?(F.value=11,z.value--):F.value--},_e=()=>{"jalali"===L.value?12===F.value?(F.value=1,z.value++):F.value++:11===F.value?(F.value=0,z.value++):F.value++},$e=()=>{if(N.value)if("jalali"===L.value){const e=C(N.value);F.value=e.month,z.value=e.year}else F.value=N.value.getMonth(),z.value=N.value.getFullYear()},Ce=e=>{var t;const a=e.target;(null==(t=U.value)?void 0:t.contains(a))||(q.value=!1)};return l(()=>{document.addEventListener("click",Ce),N.value&&$e()}),i(()=>{document.removeEventListener("click",Ce)}),s(L,()=>{$e()}),(e,t)=>(h(),n("div",re,[e.label?(h(),n("label",{key:0,class:o(O.value)},[d(c(e.label)+" ",1),e.required?(h(),n("span",se,"*")):u("",!0)],2)):u("",!0),g("div",le,[g("input",{ref_key:"inputRef",ref:U,value:E.value,onInput:be,onFocus:t[0]||(t[0]=e=>q.value=!0),onBlur:fe,placeholder:e.placeholder,class:o(H.value),readonly:e.readonly,type:"text"},null,42,ie),g("button",{type:"button",onClick:he,class:o(J.value)},[m(v(V),{class:"h-5 w-5"})],2)]),q.value?(h(),n("div",{key:1,class:o(W.value),onClick:t[5]||(t[5]=y(()=>{},["stop"]))},[g("div",ne,[g("div",oe,[g("button",{type:"button",onClick:we,class:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded"},[m(v(M),{class:"h-5 w-5"})]),g("div",de,[p(g("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>F.value=e),onChange:$e,class:"text-sm border-0 bg-transparent font-medium focus:ring-0"},[(h(!0),n(b,null,f(R.value,(e,t)=>(h(),n("option",{key:t,value:t},c(e),9,ce))),128))],544),[[x,F.value]]),p(g("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>z.value=e),onChange:$e,class:"text-sm border-0 bg-transparent font-medium focus:ring-0"},[(h(!0),n(b,null,f(Y.value,e=>(h(),n("option",{key:e,value:e},c(v(T)(e)),9,ue))),128))],544),[[x,z.value]])]),g("button",{type:"button",onClick:_e,class:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded"},[m(v(S),{class:"h-5 w-5"})])]),g("div",ge,[g("div",me,[g("button",{type:"button",onClick:t[3]||(t[3]=e=>L.value="gregorian"),class:o(["px-3 py-1 text-sm rounded-md transition-colors","gregorian"===L.value?"bg-white dark:bg-gray-600 shadow-sm":"hover:bg-gray-200 dark:hover:bg-gray-600"])},c(e.$t("calendar.gregorian")),3),g("button",{type:"button",onClick:t[4]||(t[4]=e=>L.value="jalali"),class:o(["px-3 py-1 text-sm rounded-md transition-colors","jalali"===L.value?"bg-white dark:bg-gray-600 shadow-sm":"hover:bg-gray-200 dark:hover:bg-gray-600"])},c(e.$t("calendar.jalali")),3)])]),g("div",ve,[(h(!0),n(b,null,f(A.value,e=>(h(),n("div",{key:e,class:"text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2"},c(e),1))),128))]),g("div",ye,[(h(!0),n(b,null,f(G.value,e=>(h(),n("button",{key:`${e.year}-${e.month}-${e.day}`,type:"button",onClick:t=>(e=>{e.disabled||(w("update:modelValue",e.date),w("change",e.date),q.value=!1)})(e),class:o(te(e)),disabled:e.disabled},c(v(T)(e.day)),11,pe))),128))]),g("div",xe,[g("button",{type:"button",onClick:ke,class:"px-4 py-2 text-sm bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors"},c(e.$t("calendar.today")),1)])])],2)):u("",!0)]))}}),fe={class:"space-y-4"},he={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-4"},ke={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},we={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},_e=["placeholder"],$e={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ce={value:""},Ie={value:"draft"},je={value:"sent"},Pe={value:"paid"},De={value:"overdue"},Ve={value:"cancelled"},Me={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Se={value:""},Te={value:"en"},Ue={value:"fa"},qe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Fe={class:"grid grid-cols-2 gap-2"},ze={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4"},Be={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Le={value:""},Re=["value"],Ae={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ye={value:""},Ne=["value"],Ee={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ge={class:"grid grid-cols-2 gap-2"},Oe=["placeholder"],He=["placeholder"],Je={class:"flex items-end"},We={class:"mt-4 flex justify-between items-center"},Xe={class:"flex items-center space-x-4"},Qe={class:"text-sm text-gray-500 dark:text-gray-400"},Ke={class:"flex space-x-2"},Ze={key:0,class:"mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-md"},et={class:"flex space-x-2"},tt=["disabled"],at=["disabled"],rt=["disabled"],st={class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},lt={class:"overflow-x-auto"},it={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},nt={class:"bg-gray-50 dark:bg-gray-700"},ot={class:"px-6 py-3 text-left"},dt=["checked"],ct=["onClick"],ut={class:"flex items-center space-x-1"},gt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},mt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},vt={class:"px-6 py-4"},yt=["checked","onChange"],pt={class:"px-6 py-4 whitespace-nowrap"},xt={class:"text-sm font-medium text-gray-900 dark:text-white"},bt={class:"px-6 py-4 whitespace-nowrap"},ft={class:"text-sm text-gray-900 dark:text-white"},ht={class:"px-6 py-4 whitespace-nowrap"},kt={class:"text-sm text-gray-900 dark:text-white"},wt={class:"px-6 py-4 whitespace-nowrap"},_t={class:"text-sm text-gray-900 dark:text-white"},$t={class:"px-6 py-4 whitespace-nowrap"},Ct={class:"text-sm font-medium text-gray-900 dark:text-white"},It={class:"px-6 py-4 whitespace-nowrap"},jt={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Dt={class:"flex items-center justify-end space-x-2"},Vt=["onClick"],Mt=["onClick"],St=["onClick"],Tt=["onClick"],Ut={class:"relative"},qt=["onClick"],Ft={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg z-10 border border-gray-200 dark:border-gray-700"},zt={class:"py-1"},Bt=["onClick"],Lt=["onClick"],Rt=["onClick"],At=["onClick"],Yt={key:0,class:"p-8 text-center"},Nt={class:"inline-flex items-center"},Et={key:1,class:"p-8 text-center"},Gt={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Ot={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Ht={key:0,class:"flex items-center justify-between"},Jt={class:"flex-1 flex justify-between sm:hidden"},Wt=["disabled"],Xt=["disabled"],Qt={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Kt={class:"text-sm text-gray-700 dark:text-gray-300"},Zt={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},ea=["disabled"],ta=["onClick"],aa=["disabled"],ra=r({__name:"InvoiceList",emits:["view-invoice","edit-invoice","delete-invoice","duplicate-invoice","generate-pdf","send-invoice"],setup(e,{emit:r}){const i=r,y=te(),_=K(),{formatCurrency:$}=D(),{formatDate:C}=ae(),I=t({...y.filters}),j=t([]),P=t(!1),V=t(null),A=t(!1),Y=[{key:"invoice_number",label:"invoices.invoice_number",sortable:!0},{key:"customer_name",label:"invoices.customer",sortable:!0},{key:"issue_date",label:"invoices.issue_date",sortable:!0},{key:"due_date",label:"invoices.due_date",sortable:!0},{key:"total_amount",label:"invoices.total_amount",sortable:!0},{key:"status",label:"invoices.status",sortable:!0},{key:"language",label:"common.language",sortable:!1}],N=a(()=>y.invoices.length>0&&j.value.length===y.invoices.length),E=a(()=>{const e=y.pagination.current_page,t=y.pagination.last_page,a=[],r=Math.max(1,e-2),s=Math.min(t,e+2);for(let l=r;l<=s;l++)a.push(l);return a}),G=a(()=>_.categories.filter(e=>!e.parent_id)),O=a(()=>I.value.main_category_id?_.categories.filter(e=>e.parent_id===parseInt(I.value.main_category_id)):_.categories.filter(e=>e.parent_id)),H=((e,t)=>{let a;return function(...r){clearTimeout(a),a=setTimeout(()=>{clearTimeout(a),e(...r)},t)}})(()=>{J()},300),J=()=>{y.updateFilters(I.value),y.fetchInvoices()},W=()=>{I.value={search:"",customer_id:"",status:"",language:"",date_from:"",date_to:"",template_id:"",tags:"",main_category_id:"",category_id:"",gold_purity_min:"",gold_purity_max:"",sort_by:"created_at",sort_direction:"desc"},y.resetFilters(),y.fetchInvoices()},X=()=>{N.value?j.value=[]:j.value=y.invoices.map(e=>e.id)},Q=(e,t)=>{i("send-invoice",e,t),V.value=null},Z=async()=>{try{await y.generateBatchInvoices(j.value),j.value=[],P.value=!1}catch(e){}},ee=async e=>{try{await y.sendBatchInvoices(j.value,e),j.value=[],P.value=!1}catch(t){}},re=e=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",paid:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",overdue:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",cancelled:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"};return t[e]||t.draft},se=()=>{y.pagination.current_page>1&&ie(y.pagination.current_page-1)},le=()=>{y.pagination.current_page<y.pagination.last_page&&ie(y.pagination.current_page+1)},ie=e=>{y.fetchInvoices({page:e})},ne=e=>{e.target.closest(".relative")||(V.value=null)};return l(async()=>{document.addEventListener("click",ne);try{await _.fetchCategories()}catch(e){}}),s(()=>y.filters,e=>{I.value={...e}},{deep:!0}),(e,t)=>(h(),n("div",fe,[g("div",he,[g("div",ke,[g("div",null,[g("label",we,c(e.$t("common.search")),1),p(g("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>I.value.search=e),type:"text",placeholder:e.$t("invoices.search_placeholder"),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",onInput:t[1]||(t[1]=(...e)=>v(H)&&v(H)(...e))},null,40,_e),[[k,I.value.search]])]),g("div",null,[g("label",$e,c(e.$t("invoices.status")),1),p(g("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>I.value.status=e),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",onChange:J},[g("option",Ce,c(e.$t("common.all")),1),g("option",Ie,c(e.$t("invoices.status_draft")),1),g("option",je,c(e.$t("invoices.status_sent")),1),g("option",Pe,c(e.$t("invoices.status_paid")),1),g("option",De,c(e.$t("invoices.status_overdue")),1),g("option",Ve,c(e.$t("invoices.status_cancelled")),1)],544),[[x,I.value.status]])]),g("div",null,[g("label",Me,c(e.$t("common.language")),1),p(g("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>I.value.language=e),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",onChange:J},[g("option",Se,c(e.$t("common.all")),1),g("option",Te,c(e.$t("common.english")),1),g("option",Ue,c(e.$t("common.persian")),1)],544),[[x,I.value.language]])]),g("div",null,[g("label",qe,c(e.$t("common.date_range")),1),g("div",Fe,[m(be,{modelValue:I.value.date_from,"onUpdate:modelValue":[t[4]||(t[4]=e=>I.value.date_from=e),J],placeholder:e.$t("common.from_date")},null,8,["modelValue","placeholder"]),m(be,{modelValue:I.value.date_to,"onUpdate:modelValue":[t[5]||(t[5]=e=>I.value.date_to=e),J],placeholder:e.$t("common.to_date")},null,8,["modelValue","placeholder"])])])]),g("div",ze,[g("div",null,[g("label",Be,c(e.$t("categories.main_category")),1),p(g("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>I.value.main_category_id=e),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",onChange:J},[g("option",Le,c(e.$t("common.all")),1),(h(!0),n(b,null,f(G.value,e=>(h(),n("option",{key:e.id,value:e.id},c(e.localized_name),9,Re))),128))],544),[[x,I.value.main_category_id]])]),g("div",null,[g("label",Ae,c(e.$t("categories.subcategory")),1),p(g("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>I.value.category_id=e),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",onChange:J},[g("option",Ye,c(e.$t("common.all")),1),(h(!0),n(b,null,f(O.value,e=>(h(),n("option",{key:e.id,value:e.id},c(e.localized_name),9,Ne))),128))],544),[[x,I.value.category_id]])]),g("div",null,[g("label",Ee,c(e.$t("inventory.gold_purity_range")),1),g("div",Ge,[p(g("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>I.value.gold_purity_min=e),type:"number",step:"0.1",min:"0",max:"24",placeholder:e.$t("common.min"),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",onInput:J},null,40,Oe),[[k,I.value.gold_purity_min,void 0,{number:!0}]]),p(g("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>I.value.gold_purity_max=e),type:"number",step:"0.1",min:"0",max:"24",placeholder:e.$t("common.max"),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",onInput:J},null,40,He),[[k,I.value.gold_purity_max,void 0,{number:!0}]])])]),g("div",Je,[g("button",{onClick:t[10]||(t[10]=e=>A.value=!A.value),class:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},c(A.value?e.$t("common.hide_filters"):e.$t("common.show_filters")),1)])]),g("div",We,[g("div",Xe,[g("span",Qe,c(e.$t("common.showing_results",{from:v(y).pagination.from||0,to:v(y).pagination.to||0,total:v(y).pagination.total})),1)]),g("div",Ke,[g("button",{onClick:W,class:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"},c(e.$t("common.reset_filters")),1),j.value.length>0?(h(),n("button",{key:0,onClick:t[11]||(t[11]=e=>P.value=!P.value),class:"px-3 py-1 text-sm bg-primary-100 text-primary-700 rounded-md hover:bg-primary-200 dark:bg-primary-900 dark:text-primary-300"},c(e.$t("invoices.batch_actions"))+" ("+c(j.value.length)+") ",1)):u("",!0)])]),P.value&&j.value.length>0?(h(),n("div",Ze,[g("div",et,[g("button",{onClick:Z,disabled:v(y).loading.batch,class:"px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},c(e.$t("invoices.batch_generate_pdf")),9,tt),g("button",{onClick:t[12]||(t[12]=e=>ee("email")),disabled:v(y).loading.batch,class:"px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50"},c(e.$t("invoices.batch_send_email")),9,at),g("button",{onClick:t[13]||(t[13]=e=>ee("whatsapp")),disabled:v(y).loading.batch,class:"px-3 py-1 text-sm bg-green-500 text-white rounded-md hover:bg-green-600 disabled:opacity-50"},c(e.$t("invoices.batch_send_whatsapp")),9,rt)])])):u("",!0)]),g("div",st,[g("div",lt,[g("table",it,[g("thead",nt,[g("tr",null,[g("th",ot,[g("input",{type:"checkbox",checked:N.value,onChange:X,class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,40,dt)]),(h(),n(b,null,f(Y,t=>g("th",{key:t.key,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600",onClick:e=>t.sortable&&(e=>{const t=y.filters.sort_by,a=y.filters.sort_direction;let r="asc";t===e&&"asc"===a&&(r="desc"),I.value.sort_by=e,I.value.sort_direction=r,J()})(t.key)},[g("div",ut,[g("span",null,c(e.$t(t.label)),1),t.sortable?(h(),w(v(T),{key:0,class:o(["h-4 w-4",{"text-primary-500":v(y).filters.sort_by===t.key}])},null,8,["class"])):u("",!0)])],8,ct)),64)),g("th",gt,c(e.$t("common.actions")),1)])]),g("tbody",mt,[(h(!0),n(b,null,f(v(y).invoices,t=>{var a;return h(),n("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[g("td",vt,[g("input",{type:"checkbox",checked:j.value.includes(t.id),onChange:e=>(e=>{const t=j.value.indexOf(e);t>-1?j.value.splice(t,1):j.value.push(e)})(t.id),class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,40,yt)]),g("td",pt,[g("div",xt,c(t.invoice_number),1)]),g("td",bt,[g("div",ft,c((null==(a=t.customer)?void 0:a.name)||e.$t("common.no_customer")),1)]),g("td",ht,[g("div",kt,c(v(C)(t.issue_date)),1)]),g("td",wt,[g("div",_t,c(v(C)(t.due_date)),1)]),g("td",$t,[g("div",Ct,c(v($)(t.total_amount)),1)]),g("td",It,[g("span",{class:o([re(t.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},c(e.$t(`invoices.status_${t.status}`)),3)]),g("td",jt,[g("span",{class:o(["fa"===t.language?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300","inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},c("fa"===t.language?e.$t("common.persian"):e.$t("common.english")),3)]),g("td",Pt,[g("div",Dt,[g("button",{onClick:a=>e.$emit("view-invoice",t),class:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"},[m(v(U),{class:"h-4 w-4"})],8,Vt),g("button",{onClick:a=>e.$emit("generate-pdf",t),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300"},[m(v(q),{class:"h-4 w-4"})],8,Mt),g("button",{onClick:a=>e.$emit("edit-invoice",t),class:"text-yellow-600 hover:text-yellow-900 dark:text-yellow-400 dark:hover:text-yellow-300"},[m(v(F),{class:"h-4 w-4"})],8,St),g("button",{onClick:a=>e.$emit("duplicate-invoice",t),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300"},[m(v(z),{class:"h-4 w-4"})],8,Tt),g("div",Ut,[g("button",{onClick:e=>{return a=t.id,void(V.value=V.value===a?null:a);var a},class:"text-purple-600 hover:text-purple-900 dark:text-purple-400 dark:hover:text-purple-300"},[m(v(B),{class:"h-4 w-4"})],8,qt),V.value===t.id?(h(),n("div",Ft,[g("div",zt,[g("button",{onClick:e=>Q(t,"email"),class:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},c(e.$t("invoices.send_email")),9,Bt),g("button",{onClick:e=>Q(t,"whatsapp"),class:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},c(e.$t("invoices.send_whatsapp")),9,Lt),g("button",{onClick:e=>Q(t,"sms"),class:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},c(e.$t("invoices.send_sms")),9,Rt)])])):u("",!0)]),g("button",{onClick:a=>e.$emit("delete-invoice",t),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},[m(v(L),{class:"h-4 w-4"})],8,At)])])])}),128))])])]),v(y).loading.invoices?(h(),n("div",Yt,[g("div",Nt,[t[14]||(t[14]=g("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-primary-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[g("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),g("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),d(" "+c(e.$t("common.loading")),1)])])):0===v(y).invoices.length?(h(),n("div",Et,[m(v(R),{class:"mx-auto h-12 w-12 text-gray-400"}),g("h3",Gt,c(e.$t("invoices.no_invoices")),1),g("p",Ot,c(e.$t("invoices.no_invoices_description")),1)])):u("",!0)]),v(y).pagination.last_page>1?(h(),n("div",Ht,[g("div",Jt,[g("button",{onClick:se,disabled:1===v(y).pagination.current_page,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},c(e.$t("common.previous")),9,Wt),g("button",{onClick:le,disabled:v(y).pagination.current_page===v(y).pagination.last_page,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},c(e.$t("common.next")),9,Xt)]),g("div",Qt,[g("div",null,[g("p",Kt,c(e.$t("common.pagination_info",{from:v(y).pagination.from||0,to:v(y).pagination.to||0,total:v(y).pagination.total})),1)]),g("div",null,[g("nav",Zt,[g("button",{onClick:se,disabled:1===v(y).pagination.current_page,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[m(v(M),{class:"h-5 w-5"})],8,ea),(h(!0),n(b,null,f(E.value,e=>(h(),n("button",{key:e,onClick:t=>ie(e),class:o(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",e===v(y).pagination.current_page?"z-10 bg-primary-50 border-primary-500 text-primary-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"])},c(e),11,ta))),128)),g("button",{onClick:le,disabled:v(y).pagination.current_page===v(y).pagination.last_page,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[m(v(S),{class:"h-5 w-5"})],8,aa)])])])])):u("",!0)]))}}),sa={class:"fixed inset-0 z-50 overflow-y-auto"},la={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ia={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"},na={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 border-b border-gray-200 dark:border-gray-700"},oa={class:"flex items-center justify-between"},da={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},ca={class:"bg-gray-100 dark:bg-gray-900 p-6 max-h-[80vh] overflow-y-auto"},ua={class:"max-w-3xl mx-auto"},ga={class:"bg-white shadow-lg rounded-lg p-8"},ma={class:"text-center py-12"},va={class:"mt-2 text-sm font-medium text-gray-900"},ya={class:"mt-1 text-sm text-gray-500"},pa=r({__name:"TemplatePreviewModal",props:{template:{}},emits:["close"],setup:e=>(e,t)=>{var a,r,s,l;return h(),n("div",sa,[g("div",la,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),g("div",ia,[g("div",na,[g("div",oa,[g("h3",da,c(e.$t("invoices.template_preview"))+" - "+c(null==(a=e.template)?void 0:a.name),1),g("button",{onClick:t[1]||(t[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])])]),g("div",ca,[g("div",ua,[g("div",ga,[g("div",ma,[m(v(R),{class:"mx-auto h-12 w-12 text-gray-400"}),g("h3",va,c(e.$t("invoices.template_preview_placeholder")),1),g("p",ya,c(null==(r=e.template)?void 0:r.name)+" - "+c(null==(l=null==(s=e.template)?void 0:s.template_data)?void 0:l.layout),1)])])])])])])])}}),xa={class:"space-y-4"},ba={class:"flex items-center justify-between"},fa={class:"text-lg font-medium text-gray-900 dark:text-white"},ha={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},ka={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},wa={class:"p-4"},_a={class:"flex items-center justify-between mb-2"},$a={class:"text-sm font-medium text-gray-900 dark:text-white"},Ca={class:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mb-3"},Ia={class:"flex flex-wrap gap-1 mb-3"},ja={key:0,class:"inline-flex px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded dark:bg-gray-700 dark:text-gray-300"},Pa={key:1,class:"inline-flex px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded dark:bg-gray-700 dark:text-gray-300"},Da={key:2,class:"inline-flex px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded dark:bg-gray-700 dark:text-gray-300"},Va={class:"flex items-center justify-between"},Ma={class:"flex items-center space-x-2"},Sa=["onClick"],Ta=["onClick"],Ua={class:"flex items-center space-x-2"},qa=["onClick"],Fa=["onClick"],za={key:0,class:"text-center py-12"},Ba={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},La={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Ra={class:"mt-6"},Aa={key:1,class:"text-center py-12"},Ya={class:"inline-flex items-center"},Na=r({__name:"InvoiceTemplateList",emits:["edit-template","delete-template","create-template"],setup(e,{emit:a}){const r=te(),{formatDate:s}=ae(),l=t(!1),i=t(null);return(e,t)=>(h(),n("div",xa,[g("div",ba,[g("div",null,[g("h3",fa,c(e.$t("invoices.invoice_templates")),1),g("p",ha,c(e.$t("invoices.templates_description")),1)]),g("button",{onClick:t[0]||(t[0]=t=>e.$emit("create-template")),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[m(v(Y),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.create_template")),1)])]),g("div",ka,[(h(!0),n(b,null,f(v(r).templates,a=>{var d,y,p,x,b,f,k,w;return h(),n("div",{key:a.id,class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm hover:shadow-md transition-shadow"},[t[3]||(t[3]=_('<div class="aspect-[3/4] bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600 p-4"><div class="h-full bg-white dark:bg-gray-800 rounded shadow-sm p-3 text-xs"><div class="space-y-2"><div class="flex justify-between items-start"><div class="w-8 h-4 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="text-right space-y-1"><div class="w-16 h-2 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-12 h-2 bg-gray-200 dark:bg-gray-600 rounded"></div></div></div><div class="w-12 h-3 bg-gray-300 dark:bg-gray-500 rounded font-bold"></div><div class="space-y-1"><div class="w-20 h-2 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-16 h-2 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-18 h-2 bg-gray-200 dark:bg-gray-600 rounded"></div></div><div class="space-y-1 mt-3"><div class="flex justify-between"><div class="w-12 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-8 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-6 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-8 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div></div><div class="flex justify-between"><div class="w-10 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-6 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-8 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-10 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div></div></div><div class="flex justify-end mt-2"><div class="space-y-1"><div class="w-12 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-10 h-1 bg-gray-200 dark:bg-gray-600 rounded"></div><div class="w-14 h-1 bg-gray-300 dark:bg-gray-500 rounded"></div></div></div></div></div></div>',1)),g("div",wa,[g("div",_a,[g("h4",$a,c(a.name),1),g("span",{class:o(["fa"===a.language?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300","inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},c("fa"===a.language?e.$t("common.persian"):e.$t("common.english")),3)]),g("div",Ca,[g("span",null,c(e.$t(`invoices.layout_${(null==(d=a.template_data)?void 0:d.layout)||"standard"}`)),1),g("span",null,c(v(s)(a.created_at)),1)]),g("div",Ia,[(null==(p=null==(y=a.template_data)?void 0:y.fields)?void 0:p.logo)?(h(),n("span",ja,c(e.$t("invoices.logo")),1)):u("",!0),(null==(b=null==(x=a.template_data)?void 0:x.fields)?void 0:b.qr_code)?(h(),n("span",Pa,c(e.$t("invoices.qr_code")),1)):u("",!0),(null==(w=null==(k=null==(f=a.template_data)?void 0:f.fields)?void 0:k.custom_fields)?void 0:w.length)?(h(),n("span",Da,c(e.$t("invoices.custom_fields"))+" ("+c(a.template_data.fields.custom_fields.length)+") ",1)):u("",!0)]),g("div",Va,[g("div",Ma,[g("button",{onClick:e=>(e=>{i.value=e,l.value=!0})(a),class:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300 text-sm"},c(e.$t("invoices.preview")),9,Sa),g("button",{onClick:t=>e.$emit("edit-template",a),class:"text-yellow-600 hover:text-yellow-900 dark:text-yellow-400 dark:hover:text-yellow-300 text-sm"},c(e.$t("common.edit")),9,Ta)]),g("div",Ua,[g("button",{onClick:e=>(async e=>{try{const t={...e,name:`${e.name} (Copy)`,id:void 0};await r.createTemplate(t)}catch(t){}})(a),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300"},[m(v(z),{class:"h-4 w-4"})],8,qa),g("button",{onClick:t=>e.$emit("delete-template",a),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},[m(v(L),{class:"h-4 w-4"})],8,Fa)])])])])}),128))]),0===v(r).templates.length?(h(),n("div",za,[m(v(N),{class:"mx-auto h-12 w-12 text-gray-400"}),g("h3",Ba,c(e.$t("invoices.no_templates")),1),g("p",La,c(e.$t("invoices.no_templates_description")),1),g("div",Ra,[g("button",{onClick:t[1]||(t[1]=t=>e.$emit("create-template")),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[m(v(Y),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.create_first_template")),1)])])])):u("",!0),v(r).loading.templates?(h(),n("div",Aa,[g("div",Ya,[t[4]||(t[4]=g("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-primary-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[g("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),g("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),d(" "+c(e.$t("common.loading")),1)])])):u("",!0),l.value?(h(),w(pa,{key:2,template:i.value,onClose:t[2]||(t[2]=e=>l.value=!1)},null,8,["template"])):u("",!0)]))}}),Ea={class:"fixed inset-0 z-50 overflow-y-auto"},Ga={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Oa={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full"},Ha={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 border-b border-gray-200 dark:border-gray-700"},Ja={class:"flex items-center justify-between"},Wa={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Xa={class:"px-6 py-4"},Qa={class:"text-sm text-gray-600 dark:text-gray-400 mb-4"},Ka={class:"text-center py-8"},Za={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},er={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},tr={class:"bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},ar=["disabled"],rr={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},sr=r({__name:"BatchPDFModal",emits:["close","generated"],setup(e,{emit:a}){const r=a,s=te(),l=t(!1),i=t([]),o=async()=>{0===i.value.length&&(i.value=s.invoices.map(e=>e.id)),l.value=!0;try{const e=await s.generateBatchInvoices(i.value);r("generated",e)}catch(e){}finally{l.value=!1}};return(e,t)=>(h(),n("div",Ea,[g("div",Ga,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),g("div",Oa,[g("div",Ha,[g("div",Ja,[g("h3",Wa,c(e.$t("invoices.batch_pdf_generation")),1),g("button",{onClick:t[1]||(t[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])])]),g("div",Xa,[g("p",Qa,c(e.$t("invoices.batch_pdf_description")),1),g("div",Ka,[m(v(q),{class:"mx-auto h-12 w-12 text-gray-400"}),g("h3",Za,c(e.$t("invoices.batch_pdf_placeholder")),1),g("p",er,c(e.$t("invoices.batch_pdf_placeholder_description")),1)])]),g("div",tr,[g("button",{onClick:o,disabled:l.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},[l.value?(h(),n("svg",rr,t[3]||(t[3]=[g("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),g("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):u("",!0),d(" "+c(l.value?e.$t("common.loading"):e.$t("invoices.generate_pdfs")),1)],8,ar),g("button",{onClick:t[2]||(t[2]=t=>e.$emit("close")),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"},c(e.$t("common.cancel")),1)])])])]))}}),lr={class:"fixed inset-0 z-50 overflow-y-auto"},ir={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},nr={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full"},or={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 border-b border-gray-200 dark:border-gray-700"},dr={class:"flex items-center justify-between"},cr={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},ur={class:"px-6 py-4"},gr={class:"text-sm text-gray-600 dark:text-gray-400 mb-4"},mr={class:"text-center py-8"},vr={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},yr={class:"bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},pr={disabled:"",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-gray-400 text-base font-medium text-white cursor-not-allowed sm:ml-3 sm:w-auto sm:text-sm"},xr=r({__name:"BatchSendModal",emits:["close","sent"],setup:(e,{emit:t})=>(e,t)=>(h(),n("div",lr,[g("div",ir,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),g("div",nr,[g("div",or,[g("div",dr,[g("h3",cr,c(e.$t("invoices.batch_send_invoices")),1),g("button",{onClick:t[1]||(t[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])])]),g("div",ur,[g("p",gr,c(e.$t("invoices.batch_send_description")),1),g("div",mr,[m(v(B),{class:"mx-auto h-12 w-12 text-yellow-400"}),g("h3",vr,c(e.$t("common.coming_soon")),1),t[3]||(t[3]=g("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Batch invoice sending feature is not yet implemented. This will allow you to send multiple invoices via email, WhatsApp, or SMS. ",-1))])]),g("div",yr,[g("button",pr,c(e.$t("invoices.send_invoices"))+" ("+c(e.$t("common.coming_soon"))+") ",1),g("button",{onClick:t[2]||(t[2]=t=>e.$emit("close")),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"},c(e.$t("common.cancel")),1)])])])]))}),br={class:"fixed inset-0 z-50 overflow-y-auto"},fr={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},hr={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full"},kr={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 border-b border-gray-200 dark:border-gray-700"},wr={class:"flex items-center justify-between"},_r={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},$r={class:"px-6 py-4"},Cr={class:"text-sm text-gray-600 dark:text-gray-400 mb-4"},Ir={class:"text-center py-8"},jr={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Pr={class:"bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Dr={disabled:"",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-gray-400 text-base font-medium text-white cursor-not-allowed sm:ml-3 sm:w-auto sm:text-sm"},Vr=r({__name:"BatchCreateModal",emits:["close","created"],setup:(e,{emit:t})=>(e,t)=>(h(),n("div",br,[g("div",fr,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),g("div",hr,[g("div",kr,[g("div",wr,[g("h3",_r,c(e.$t("invoices.batch_create_invoices")),1),g("button",{onClick:t[1]||(t[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])])]),g("div",$r,[g("p",Cr,c(e.$t("invoices.batch_create_description")),1),g("div",Ir,[m(v(z),{class:"mx-auto h-12 w-12 text-yellow-400"}),g("h3",jr,c(e.$t("common.coming_soon")),1),t[3]||(t[3]=g("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Batch invoice creation feature is not yet implemented. This will allow you to create multiple invoices from templates. ",-1))])]),g("div",Pr,[g("button",Dr,c(e.$t("invoices.create_invoices"))+" ("+c(e.$t("common.coming_soon"))+") ",1),g("button",{onClick:t[2]||(t[2]=t=>e.$emit("close")),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"},c(e.$t("common.cancel")),1)])])])]))}),Mr={class:"fixed inset-0 z-50 overflow-y-auto"},Sr={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Tr={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full"},Ur={key:0,class:"bg-white dark:bg-gray-800"},qr={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Fr={class:"flex items-center justify-between"},zr={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Br={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Lr={class:"px-6 py-4"},Rr={class:"space-y-6"},Ar={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},Yr={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Nr={class:"text-sm text-gray-500 dark:text-gray-400"},Er={class:"text-sm font-medium text-gray-900 dark:text-white"},Gr={class:"text-sm text-gray-500 dark:text-gray-400"},Or={class:"text-sm font-medium text-gray-900 dark:text-white"},Hr={class:"text-sm text-gray-500 dark:text-gray-400"},Jr={class:"text-sm text-gray-500 dark:text-gray-400"},Wr={class:"text-sm font-medium text-gray-900 dark:text-white"},Xr={class:"text-center py-8"},Qr={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Kr={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Zr={class:"bg-gray-50 dark:bg-gray-700 px-6 py-4 flex items-center justify-end"},es=r({__name:"BatchDetailsModal",props:{operation:{}},emits:["close"],setup(e){const{formatDate:t}=ae(),a=e=>{const t={completed:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",in_progress:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",failed:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",pending:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"};return t[e]||t.pending};return(e,r)=>(h(),n("div",Mr,[g("div",Sr,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:r[0]||(r[0]=t=>e.$emit("close"))}),g("div",Tr,[e.operation?(h(),n("div",Ur,[g("div",qr,[g("div",Fr,[g("div",null,[g("h3",zr,c(e.$t("invoices.batch_operation_details")),1),g("p",Br,c(e.$t(`invoices.operation_${e.operation.type}`)),1)]),g("button",{onClick:r[1]||(r[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])])]),g("div",Lr,[g("div",Rr,[g("div",null,[g("h4",Ar,c(e.$t("invoices.operation_information")),1),g("dl",Yr,[g("div",null,[g("dt",Nr,c(e.$t("invoices.operation_type"))+": ",1),g("dd",Er,c(e.$t(`invoices.operation_${e.operation.type}`)),1)]),g("div",null,[g("dt",Gr,c(e.$t("invoices.invoices_count"))+": ",1),g("dd",Or,c(e.operation.invoices_count),1)]),g("div",null,[g("dt",Hr,c(e.$t("common.status"))+": ",1),g("dd",null,[g("span",{class:o([a(e.operation.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},c(e.$t(`common.status_${e.operation.status}`)),3)])]),g("div",null,[g("dt",Jr,c(e.$t("common.created_at"))+": ",1),g("dd",Wr,c(v(t)(e.operation.created_at)),1)])])]),g("div",Xr,[m(v(R),{class:"mx-auto h-12 w-12 text-gray-400"}),g("h3",Qr,c(e.$t("invoices.batch_details_placeholder")),1),g("p",Kr,c(e.$t("invoices.batch_details_placeholder_description")),1)])])]),g("div",Zr,[g("button",{onClick:r[2]||(r[2]=t=>e.$emit("close")),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"},c(e.$t("common.close")),1)])])):u("",!0)])])]))}}),ts={class:"space-y-6"},as={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},rs={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},ss={class:"text-sm text-gray-600 dark:text-gray-400 mb-6"},ls={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},is={class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},ns={class:"flex items-center mb-3"},os={class:"text-sm font-medium text-blue-900 dark:text-blue-100"},ds={class:"text-xs text-blue-700 dark:text-blue-300 mb-3"},cs={class:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4"},us={class:"flex items-center mb-3"},gs={class:"text-sm font-medium text-green-900 dark:text-green-100"},ms={class:"text-xs text-green-700 dark:text-green-300 mb-3"},vs={class:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4"},ys={class:"flex items-center mb-3"},ps={class:"text-sm font-medium text-purple-900 dark:text-purple-100"},xs={class:"text-xs text-purple-700 dark:text-purple-300 mb-3"},bs={class:"bg-white dark:bg-gray-800 shadow rounded-lg"},fs={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},hs={class:"text-lg font-medium text-gray-900 dark:text-white"},ks={class:"overflow-x-auto"},ws={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},_s={class:"bg-gray-50 dark:bg-gray-700"},$s={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Cs={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Is={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},js={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ps={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ds={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Vs={class:"px-6 py-4 whitespace-nowrap"},Ms={class:"flex items-center"},Ss={class:"text-sm text-gray-900 dark:text-white"},Ts={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Us={class:"px-6 py-4 whitespace-nowrap"},qs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Fs={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},zs=["onClick"],Bs=["onClick"],Ls={key:0,class:"p-8 text-center"},Rs={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},As={key:1,class:"p-8 text-center"},Ys={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Ns={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Es=r({__name:"BatchInvoiceInterface",setup(e){const{formatDate:a}=ae(),r=t(!1),s=t(!1),i=t(!1),d=t(!1),y=t(null),p=t([]),x=t(!1),k=e=>{const t={completed:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",in_progress:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",failed:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",pending:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"};return t[e]||t.pending},_=e=>{r.value=!1,j()},C=e=>{s.value=!1,j()},I=e=>{i.value=!1,j()},j=async()=>{x.value=!0;try{const e=await fetch("/api/queue/history?limit=20",{headers:{Accept:"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(e.ok){const t=await e.json();t.success&&(p.value=t.data.filter(e=>{var t,a;return e.queue&&(e.queue.includes("batch")||e.queue.includes("pdf")||e.queue.includes("email")||(null==(a=null==(t=e.payload)?void 0:t.displayName)?void 0:a.includes("batch")))}).map(e=>{var t;return{id:e.id,type:P(e),invoices_count:D(e),status:V(e.status),created_at:e.created_at,download_url:"completed"===e.status&&(null==(t=e.queue)?void 0:t.includes("pdf"))?`/api/invoices/batch-download?job_id=${e.id}`:null}}).slice(0,10))}}catch(e){p.value=[]}finally{x.value=!1}},P=e=>{var t,a,r,s,l,i,n,o,d;return(null==(t=e.queue)?void 0:t.includes("pdf"))||(null==(r=null==(a=e.payload)?void 0:a.displayName)?void 0:r.includes("PDF"))?"pdf_generation":(null==(s=e.queue)?void 0:s.includes("email"))||(null==(i=null==(l=e.payload)?void 0:l.displayName)?void 0:i.includes("email"))?"email_sending":(null==(n=e.queue)?void 0:n.includes("whatsapp"))||(null==(d=null==(o=e.payload)?void 0:o.displayName)?void 0:d.includes("whatsapp"))?"whatsapp_sending":"batch_creation"},D=e=>{var t,a;return(null==(a=null==(t=e.payload)?void 0:t.data)?void 0:a.invoice_ids)?e.payload.data.invoice_ids.length:Math.floor(50*Math.random())+1},V=e=>{switch(e){case"completed":case"finished":return"completed";case"processing":case"running":return"in_progress";case"failed":case"error":return"failed";default:return"pending"}};return l(()=>{j()}),(e,t)=>(h(),n("div",ts,[g("div",as,[g("h3",rs,c(e.$t("invoices.batch_operations")),1),g("p",ss,c(e.$t("invoices.batch_operations_description")),1),g("div",ls,[g("div",is,[g("div",ns,[m(v(q),{class:"h-6 w-6 text-blue-600 dark:text-blue-400 mr-2"}),g("h4",os,c(e.$t("invoices.batch_pdf_generation")),1)]),g("p",ds,c(e.$t("invoices.batch_pdf_description")),1),g("button",{onClick:t[0]||(t[0]=e=>r.value=!0),class:"w-full px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"},c(e.$t("invoices.generate_batch_pdf")),1)]),g("div",cs,[g("div",us,[m(v(B),{class:"h-6 w-6 text-green-600 dark:text-green-400 mr-2"}),g("h4",gs,c(e.$t("invoices.batch_sending")),1)]),g("p",ms,c(e.$t("invoices.batch_sending_description")),1),g("button",{onClick:t[1]||(t[1]=e=>s.value=!0),class:"w-full px-3 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500"},c(e.$t("invoices.send_batch_invoices")),1)]),g("div",vs,[g("div",ys,[m(v(z),{class:"h-6 w-6 text-purple-600 dark:text-purple-400 mr-2"}),g("h4",ps,c(e.$t("invoices.batch_creation")),1)]),g("p",xs,c(e.$t("invoices.batch_creation_description")),1),g("button",{onClick:t[2]||(t[2]=e=>i.value=!0),class:"w-full px-3 py-2 bg-purple-600 text-white text-sm font-medium rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500"},c(e.$t("invoices.create_batch_invoices")),1)])])]),g("div",bs,[g("div",fs,[g("h3",hs,c(e.$t("invoices.recent_batch_operations")),1)]),g("div",ks,[g("table",ws,[g("thead",_s,[g("tr",null,[g("th",$s,c(e.$t("invoices.operation_type")),1),g("th",Cs,c(e.$t("invoices.invoices_count")),1),g("th",Is,c(e.$t("common.status")),1),g("th",js,c(e.$t("common.created_at")),1),g("th",Ps,c(e.$t("common.actions")),1)])]),g("tbody",Ds,[(h(!0),n(b,null,f(p.value,t=>{return h(),n("tr",{key:t.id},[g("td",Vs,[g("div",Ms,[(h(),w($((r=t.type,{pdf_generation:q,email_sending:B,whatsapp_sending:B,batch_creation:z}[r]||R)),{class:"h-5 w-5 text-gray-400 mr-3"})),g("span",Ss,c(e.$t(`invoices.operation_${t.type}`)),1)])]),g("td",Ts,c(t.invoices_count),1),g("td",Us,[g("span",{class:o([k(t.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},c(e.$t(`common.status_${t.status}`)),3)]),g("td",qs,c(v(a)(t.created_at)),1),g("td",Fs,[t.download_url?(h(),n("button",{key:0,onClick:e=>(async e=>{if(e.download_url)try{const t=await fetch(e.download_url,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(t.ok){const a=await t.blob(),r=window.URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download=`batch-operation-${e.id}.zip`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(r)}}catch(t){}})(t),class:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300 mr-3"},c(e.$t("common.download")),9,zs)):u("",!0),g("button",{onClick:e=>(e=>{y.value=e,d.value=!0})(t),class:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300"},c(e.$t("common.view_details")),9,Bs)])]);var r}),128))])])]),x.value?(h(),n("div",Ls,[t[7]||(t[7]=g("svg",{class:"animate-spin mx-auto h-12 w-12 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[g("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),g("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),g("h3",Rs,c(e.$t("common.loading")),1)])):0===p.value.length?(h(),n("div",As,[m(v(R),{class:"mx-auto h-12 w-12 text-gray-400"}),g("h3",Ys,c(e.$t("invoices.no_batch_operations")),1),g("p",Ns,c(e.$t("invoices.no_batch_operations_description")),1)])):u("",!0)]),r.value?(h(),w(sr,{key:0,onClose:t[3]||(t[3]=e=>r.value=!1),onGenerated:_})):u("",!0),s.value?(h(),w(xr,{key:1,onClose:t[4]||(t[4]=e=>s.value=!1),onSent:C})):u("",!0),i.value?(h(),w(Vr,{key:2,onClose:t[5]||(t[5]=e=>i.value=!1),onCreated:I})):u("",!0),d.value?(h(),w(es,{key:3,operation:y.value,onClose:t[6]||(t[6]=e=>d.value=!1)},null,8,["operation"])):u("",!0)]))}}),Gs={class:"fixed inset-0 z-50 overflow-y-auto"},Os={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Hs={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full"},Js={key:0,class:"bg-white dark:bg-gray-800"},Ws={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Xs={class:"flex items-center justify-between"},Qs={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Ks={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Zs={class:"px-6 py-4 max-h-[70vh] overflow-y-auto"},el={class:"space-y-6"},tl={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},al={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},rl={class:"text-sm text-gray-500 dark:text-gray-400"},sl={class:"text-sm font-medium text-gray-900 dark:text-white"},ll={class:"text-sm text-gray-500 dark:text-gray-400"},il={class:"text-sm font-medium text-gray-900 dark:text-white"},nl={class:"text-sm text-gray-500 dark:text-gray-400"},ol={class:"text-sm font-medium text-gray-900 dark:text-white"},dl={class:"text-sm text-gray-500 dark:text-gray-400"},cl={class:"text-sm font-medium text-gray-900 dark:text-white"},ul={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},gl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ml={class:"text-sm text-gray-500 dark:text-gray-400"},vl={class:"text-sm font-medium text-gray-900 dark:text-white"},yl={class:"text-sm text-gray-500 dark:text-gray-400"},pl={class:"text-sm font-medium text-gray-900 dark:text-white"},xl={class:"text-sm text-gray-500 dark:text-gray-400"},bl={class:"text-sm font-medium text-gray-900 dark:text-white"},fl={class:"text-sm text-gray-500 dark:text-gray-400"},hl={key:0},kl={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},wl={class:"overflow-x-auto"},_l={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},$l={class:"bg-gray-50 dark:bg-gray-700"},Cl={class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Il={class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},jl={class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Pl={class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Dl={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Vl={class:"px-3 py-2 text-sm text-gray-900 dark:text-white"},Ml={class:"px-3 py-2 text-sm text-gray-900 dark:text-white"},Sl={class:"px-3 py-2 text-sm text-gray-900 dark:text-white"},Tl={class:"px-3 py-2 text-sm"},Ul={class:"bg-gray-50 dark:bg-gray-700 px-6 py-4 flex items-center justify-between"},ql={class:"flex items-center space-x-2"},Fl={class:"flex items-center space-x-2"},zl=r({__name:"RecurringInvoiceDetailsModal",props:{recurringInvoice:{}},emits:["close","edit","delete"],setup(e){const{formatCurrency:t}=D(),{formatDate:a}=ae(),r=e=>{const t={active:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",paused:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",completed:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",cancelled:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"};return t[e]||t.active},s=e=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",paid:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",overdue:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",cancelled:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"};return t[e]||t.draft};return(e,l)=>{var i,y;return h(),n("div",Gs,[g("div",Os,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:l[0]||(l[0]=t=>e.$emit("close"))}),g("div",Hs,[e.recurringInvoice?(h(),n("div",Js,[g("div",Ws,[g("div",Xs,[g("div",null,[g("h3",Qs,c(e.$t("invoices.recurring_invoice_details")),1),g("p",Ks,c(e.recurringInvoice.name),1)]),g("button",{onClick:l[1]||(l[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])])]),g("div",Zs,[g("div",el,[g("div",null,[g("h4",tl,c(e.$t("invoices.basic_information")),1),g("dl",al,[g("div",null,[g("dt",rl,c(e.$t("invoices.template_name"))+": ",1),g("dd",sl,c(e.recurringInvoice.name),1)]),g("div",null,[g("dt",ll,c(e.$t("invoices.customer"))+": ",1),g("dd",il,c((null==(i=e.recurringInvoice.customer)?void 0:i.name)||e.$t("common.no_customer")),1)]),g("div",null,[g("dt",nl,c(e.$t("invoices.frequency"))+": ",1),g("dd",ol,c(e.$t(`invoices.frequency_${e.recurringInvoice.frequency}`)),1)]),g("div",null,[g("dt",dl,c(e.$t("invoices.amount"))+": ",1),g("dd",cl,c(v(t)(e.recurringInvoice.amount)),1)])])]),g("div",null,[g("h4",ul,c(e.$t("invoices.schedule_information")),1),g("dl",gl,[g("div",null,[g("dt",ml,c(e.$t("invoices.start_date"))+": ",1),g("dd",vl,c(v(a)(e.recurringInvoice.start_date)),1)]),g("div",null,[g("dt",yl,c(e.$t("invoices.next_generation"))+": ",1),g("dd",pl,c(v(a)(e.recurringInvoice.next_generation_date)),1)]),g("div",null,[g("dt",xl,c(e.$t("invoices.generated_count"))+": ",1),g("dd",bl,c(e.recurringInvoice.generated_count||0),1)]),g("div",null,[g("dt",fl,c(e.$t("common.status"))+": ",1),g("dd",null,[g("span",{class:o([r(e.recurringInvoice.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},c(e.$t(`invoices.recurring_status_${e.recurringInvoice.status}`)),3)])])])]),(null==(y=e.recurringInvoice.generated_invoices)?void 0:y.length)?(h(),n("div",hl,[g("h4",kl,c(e.$t("invoices.generated_invoices")),1),g("div",wl,[g("table",_l,[g("thead",$l,[g("tr",null,[g("th",Cl,c(e.$t("invoices.invoice_number")),1),g("th",Il,c(e.$t("invoices.generated_date")),1),g("th",jl,c(e.$t("invoices.amount")),1),g("th",Pl,c(e.$t("common.status")),1)])]),g("tbody",Dl,[(h(!0),n(b,null,f(e.recurringInvoice.generated_invoices,r=>(h(),n("tr",{key:r.id},[g("td",Vl,c(r.invoice_number),1),g("td",Ml,c(v(a)(r.created_at)),1),g("td",Sl,c(v(t)(r.total_amount)),1),g("td",Tl,[g("span",{class:o([s(r.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},c(e.$t(`invoices.status_${r.status}`)),3)])]))),128))])])])])):u("",!0)])]),g("div",Ul,[g("div",ql,[g("button",{onClick:l[2]||(l[2]=t=>e.$emit("edit",e.recurringInvoice)),class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"},[m(v(F),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("common.edit")),1)])]),g("div",Fl,[g("button",{onClick:l[3]||(l[3]=t=>e.$emit("delete",e.recurringInvoice)),class:"inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm leading-4 font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:bg-gray-700 dark:text-red-400 dark:border-red-600 dark:hover:bg-red-900/20"},[m(v(L),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("common.delete")),1)])])])])):u("",!0)])])])}}}),Bl={class:"space-y-4"},Ll={class:"flex items-center justify-between"},Rl={class:"text-lg font-medium text-gray-900 dark:text-white"},Al={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Yl={class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},Nl={class:"overflow-x-auto"},El={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Gl={class:"bg-gray-50 dark:bg-gray-700"},Ol={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Hl={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Jl={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Wl={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Xl={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ql={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Kl={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Zl={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},ei={class:"px-6 py-4 whitespace-nowrap"},ti={class:"text-sm font-medium text-gray-900 dark:text-white"},ai={class:"text-sm text-gray-500 dark:text-gray-400"},ri={class:"px-6 py-4 whitespace-nowrap"},si={class:"text-sm text-gray-900 dark:text-white"},li={class:"px-6 py-4 whitespace-nowrap"},ii={class:"text-sm text-gray-900 dark:text-white"},ni={class:"text-sm text-gray-500 dark:text-gray-400"},oi={class:"px-6 py-4 whitespace-nowrap"},di={class:"text-sm text-gray-900 dark:text-white"},ci={class:"px-6 py-4 whitespace-nowrap"},ui={class:"text-sm font-medium text-gray-900 dark:text-white"},gi={class:"px-6 py-4 whitespace-nowrap"},mi={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},vi={class:"flex items-center justify-end space-x-2"},yi=["onClick"],pi=["onClick"],xi=["onClick"],bi=["onClick"],fi={key:0,class:"p-8 text-center"},hi={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},ki={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},wi={class:"mt-6"},_i={key:1,class:"p-8 text-center"},$i={class:"inline-flex items-center"},Ci=r({__name:"RecurringInvoiceList",emits:["edit-recurring","delete-recurring","create-recurring"],setup(e,{emit:a}){const r=te(),{formatCurrency:s}=D(),{formatDate:l}=ae(),i=t(!1),y=t(null),p=e=>{const t={active:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",paused:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",completed:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",cancelled:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"};return t[e]||t.active};return(e,t)=>(h(),n("div",Bl,[g("div",Ll,[g("div",null,[g("h3",Rl,c(e.$t("invoices.recurring_invoices")),1),g("p",Al,c(e.$t("invoices.recurring_description")),1)]),g("button",{onClick:t[0]||(t[0]=t=>e.$emit("create-recurring")),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[m(v(Y),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.create_recurring")),1)])]),g("div",Yl,[g("div",Nl,[g("table",El,[g("thead",Gl,[g("tr",null,[g("th",Ol,c(e.$t("invoices.template_name")),1),g("th",Hl,c(e.$t("invoices.customer")),1),g("th",Jl,c(e.$t("invoices.frequency")),1),g("th",Wl,c(e.$t("invoices.next_generation")),1),g("th",Xl,c(e.$t("invoices.amount")),1),g("th",Ql,c(e.$t("common.status")),1),g("th",Kl,c(e.$t("common.actions")),1)])]),g("tbody",Zl,[(h(!0),n(b,null,f(v(r).recurringInvoices,t=>{var a;return h(),n("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[g("td",ei,[g("div",ti,c(t.name),1),g("div",ai,c(e.$t("invoices.created"))+" "+c(v(l)(t.created_at)),1)]),g("td",ri,[g("div",si,c((null==(a=t.customer)?void 0:a.name)||e.$t("common.no_customer")),1)]),g("td",li,[g("div",ii,c(e.$t(`invoices.frequency_${t.frequency}`)),1),g("div",ni,c(e.$t("invoices.every"))+" "+c(t.interval)+" "+c(e.$t(`invoices.${t.frequency}`)),1)]),g("td",oi,[g("div",di,c(v(l)(t.next_generation_date)),1)]),g("td",ci,[g("div",ui,c(v(s)(t.amount)),1)]),g("td",gi,[g("span",{class:o([p(t.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},c(e.$t(`invoices.recurring_status_${t.status}`)),3)]),g("td",mi,[g("div",vi,[g("button",{onClick:e=>(e=>{y.value=e,i.value=!0})(t),class:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"},[m(v(U),{class:"h-4 w-4"})],8,yi),g("button",{onClick:a=>e.$emit("edit-recurring",t),class:"text-yellow-600 hover:text-yellow-900 dark:text-yellow-400 dark:hover:text-yellow-300"},[m(v(F),{class:"h-4 w-4"})],8,pi),g("button",{onClick:e=>(async e=>{try{e.status}catch(t){}})(t),class:o("active"===t.status?"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300":"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300")},[(h(),w($("active"===t.status?v(E):v(G)),{class:"h-4 w-4"}))],10,xi),g("button",{onClick:a=>e.$emit("delete-recurring",t),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},[m(v(L),{class:"h-4 w-4"})],8,bi)])])])}),128))])])]),0===v(r).recurringInvoices.length?(h(),n("div",fi,[m(v(O),{class:"mx-auto h-12 w-12 text-gray-400"}),g("h3",hi,c(e.$t("invoices.no_recurring_invoices")),1),g("p",ki,c(e.$t("invoices.no_recurring_description")),1),g("div",wi,[g("button",{onClick:t[1]||(t[1]=t=>e.$emit("create-recurring")),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[m(v(Y),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.create_first_recurring")),1)])])])):u("",!0),v(r).loading.recurring?(h(),n("div",_i,[g("div",$i,[t[5]||(t[5]=g("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-primary-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[g("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),g("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),d(" "+c(e.$t("common.loading")),1)])])):u("",!0)]),i.value?(h(),w(zl,{key:0,"recurring-invoice":y.value,onClose:t[2]||(t[2]=e=>i.value=!1),onEdit:t[3]||(t[3]=t=>e.$emit("edit-recurring",y.value)),onDelete:t[4]||(t[4]=t=>e.$emit("delete-recurring",y.value))},null,8,["recurring-invoice"])):u("",!0)]))}}),Ii=e("customers",()=>{const e=t([]),r=t(null),s=t([]),l=t(null),i=t(null),n=t({customers:!1,customer:!1,communications:!1,crm:!1,aging:!1,creating:!1,updating:!1,deleting:!1}),o=t({current_page:1,last_page:1,per_page:15,total:0}),d=t({search:"",customer_type:"",crm_stage:"",is_active:"",preferred_language:"",lead_source:"",tags:"",sort_by:"name",sort_direction:"asc"}),c=a(()=>e.value.filter(e=>e.is_active)),u=a(()=>{const t={lead:[],prospect:[],customer:[],inactive:[]};return e.value.forEach(e=>{t[e.crm_stage]&&t[e.crm_stage].push(e)}),t}),g=a(()=>e.value.reduce((e,t)=>e+(t.outstanding_balance||0),0)),m=async()=>{n.value.crm=!0;try{const e=await P.customers.getCRMPipeline();e.data.success&&(l.value=e.data.data)}catch(e){throw e}finally{n.value.crm=!1}},v=async e=>{n.value.communications=!0;try{const t=await P.customers.getCustomer(e);t.data.success&&t.data.data.communications&&(s.value=t.data.data.communications)}catch(t){throw t}finally{n.value.communications=!1}};return{customers:e,currentCustomer:r,communications:s,crmPipeline:l,agingReport:i,loading:n,pagination:o,filters:d,activeCustomers:c,customersByStage:u,totalOutstanding:g,fetchCustomers:async t=>{n.value.customers=!0;try{const a={...d.value,page:(null==t?void 0:t.page)||o.value.current_page,per_page:o.value.per_page,...t},r=await P.customers.getCustomers(a);r.data.success&&(e.value=r.data.data.data,o.value={current_page:r.data.data.current_page,last_page:r.data.data.last_page,per_page:r.data.data.per_page,total:r.data.data.total})}catch(a){const t=[{id:1,name:"علی رضایی",email:"ali.rezaei@example.com",phone:"+98-912-111-2222",customer_type:"retail",crm_stage:"customer",is_active:!0,preferred_language:"fa",outstanding_balance:0,address:"تهران، میدان آزادی، پلاک ۱۰۰"},{id:2,name:"مریم احمدی",email:"maryam.ahmadi@example.com",phone:"+98-911-333-4444",customer_type:"vip",crm_stage:"customer",is_active:!0,preferred_language:"fa",outstanding_balance:0,address:"اصفهان، خیابان سی و سه پل، پلاک ۲۰۰"},{id:3,name:"Michael Johnson",email:"michael.johnson@example.com",phone:"+1-555-777-8888",customer_type:"wholesale",crm_stage:"customer",is_active:!0,preferred_language:"en",outstanding_balance:0,address:"456 Oak Street, Los Angeles, CA 90210"},{id:4,name:"زهرا محمدی",email:"zahra.mohammadi@example.com",phone:"+98-913-555-6666",customer_type:"retail",crm_stage:"prospect",is_active:!0,preferred_language:"fa",outstanding_balance:0,address:"شیراز، خیابان زند، پلاک ۳۰۰"},{id:5,name:"Sarah Williams",email:"sarah.williams@example.com",phone:"+1-555-999-0000",customer_type:"retail",crm_stage:"lead",is_active:!0,preferred_language:"en",outstanding_balance:0,address:"789 Pine Avenue, Chicago, IL 60601"},{id:6,name:"حسن کریمی",email:"hassan.karimi@example.com",phone:"+98-914-777-8888",customer_type:"wholesale",crm_stage:"customer",is_active:!0,preferred_language:"fa",outstanding_balance:0,address:"مشهد، خیابان امام رضا، پلاک ۴۰۰"},{id:7,name:"Emma Davis",email:"emma.davis@example.com",phone:"+1-555-111-2222",customer_type:"vip",crm_stage:"customer",is_active:!0,preferred_language:"en",outstanding_balance:0,address:"321 Maple Drive, Miami, FL 33101"},{id:8,name:"رضا نوری",email:"reza.nouri@example.com",phone:"+98-915-333-4444",customer_type:"retail",crm_stage:"customer",is_active:!0,preferred_language:"fa",outstanding_balance:0,address:"تبریز، خیابان شهریار، پلاک ۵۰۰"},{id:9,name:"Lisa Anderson",email:"lisa.anderson@example.com",phone:"+1-555-444-5555",customer_type:"retail",crm_stage:"prospect",is_active:!0,preferred_language:"en",outstanding_balance:0,address:"654 Cedar Lane, Seattle, WA 98101"},{id:10,name:"فاطمه حسینی",email:"fateme.hosseini@example.com",phone:"+98-916-666-7777",customer_type:"vip",crm_stage:"customer",is_active:!0,preferred_language:"fa",outstanding_balance:0,address:"کرج، خیابان مطهری، پلاک ۶۰۰"}];e.value=t.map(e=>({...e,customer_type:e.customer_type,preferred_language:e.preferred_language,crm_stage:e.crm_stage,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()})),o.value={current_page:1,last_page:8,per_page:15,total:117}}finally{n.value.customers=!1}},fetchCustomer:async e=>{n.value.customer=!0;try{const t=await P.customers.getCustomer(e);t.data.success&&(r.value=t.data.data,await v(e))}catch(t){throw t}finally{n.value.customer=!1}},createCustomer:async t=>{n.value.creating=!0;try{const a=await P.customers.createCustomer(t);if(a.data.success){const t=a.data.data;return e.value.unshift(t),t}}catch(a){throw a}finally{n.value.creating=!1}},updateCustomer:async(t,a)=>{var s;n.value.updating=!0;try{const l=await P.customers.updateCustomer(t,a);if(l.data.success){const a=l.data.data,i=e.value.findIndex(e=>e.id===t);return-1!==i&&(e.value[i]=a),(null==(s=r.value)?void 0:s.id)===t&&(r.value=a),a}}catch(l){throw l}finally{n.value.updating=!1}},deleteCustomer:async t=>{var a;n.value.deleting=!0;try{(await P.customers.deleteCustomer(t)).data.success&&(e.value=e.value.filter(e=>e.id!==t),(null==(a=r.value)?void 0:a.id)===t&&(r.value=null))}catch(s){throw s}finally{n.value.deleting=!1}},fetchCRMPipeline:m,updateCRMStage:async(t,a,s)=>{var l;try{const i=await P.customers.updateCRMStage(t,{crm_stage:a,notes:s});if(i.data.success){const a=i.data.data,s=e.value.findIndex(e=>e.id===t);return-1!==s&&(e.value[s]=a),(null==(l=r.value)?void 0:l.id)===t&&(r.value=a),await m(),a}}catch(i){throw i}},fetchAgingReport:async e=>{n.value.aging=!0;try{const t=await P.customers.getAgingReport(e);t.data.success&&(i.value=t.data.data)}catch(t){throw t}finally{n.value.aging=!1}},fetchCommunications:v,sendCommunication:async(e,t)=>{try{const a=await P.customers.sendCommunication(e,t);if(a.data.success){const e=a.data.data;return s.value.unshift(e),e}}catch(a){throw a}},exportVCard:async e=>{try{const t=await P.customers.exportVCard(e);if(t.data.success){const{vcard:e,filename:a}=t.data.data,r=new Blob([e],{type:"text/vcard"}),s=window.URL.createObjectURL(r),l=document.createElement("a");return l.href=s,l.download=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(s),t.data.data}}catch(t){throw t}},updateFilters:e=>{d.value={...d.value,...e}},resetFilters:()=>{d.value={search:"",customer_type:"",crm_stage:"",is_active:"",preferred_language:"",lead_source:"",tags:"",sort_by:"name",sort_direction:"asc"}},clearCurrentCustomer:()=>{r.value=null,s.value=[]}}}),ji=e("settings",()=>{const e=t(null),r=t([]),s=t([]),l=t([]),i=t([]),n=t([]),o=t(!1),d=t(null),c=a(()=>{var t;return(null==(t=e.value)?void 0:t.business)||null}),u=a(()=>{var t;return(null==(t=e.value)?void 0:t.theme)||null}),g=a(()=>{var t;return(null==(t=e.value)?void 0:t.language)||null}),m=a(()=>{var t;return(null==(t=e.value)?void 0:t.security)||null}),v=a(()=>{var t;return(null==(t=e.value)?void 0:t.backup)||null}),y=a(()=>{var t;return(null==(t=e.value)?void 0:t.audit)||null}),p=a(()=>{var t;return(null==(t=e.value)?void 0:t.notifications)||null});return{settings:e,roles:r,permissions:s,messageTemplates:l,auditLogs:i,loginAnomalies:n,isLoading:o,error:d,businessConfig:c,themeSettings:u,languageSettings:g,securitySettings:m,backupSettings:v,auditSettings:y,notificationSettings:p,fetchSettings:async()=>{var t,a;try{o.value=!0,d.value=null;const t=await P.get("/api/settings");return e.value=t.data.data,{success:!0}}catch(r){return d.value=(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"Failed to fetch settings",{success:!1,error:d.value}}finally{o.value=!1}},updateBusinessConfig:async t=>{var a,r;try{o.value=!0,d.value=null;const a=await P.put("/api/config/business-info",t);return e.value&&(e.value.business={...e.value.business,...a.data.data}),{success:!0,data:a.data.data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to update business configuration",{success:!1,error:d.value}}finally{o.value=!1}},getDefaultPricingPercentages:async()=>{var e,t;try{o.value=!0,d.value=null;return{success:!0,data:(await P.get("/api/config/pricing-percentages")).data.data}}catch(a){return d.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||"Failed to fetch default pricing percentages",{success:!1,error:d.value}}finally{o.value=!1}},updateDefaultPricingPercentages:async e=>{var t,a;try{o.value=!0,d.value=null;return{success:!0,data:(await P.put("/api/config/pricing-percentages",e)).data.data}}catch(r){return d.value=(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"Failed to update default pricing percentages",{success:!1,error:d.value}}finally{o.value=!1}},getAllConfigurations:async()=>{var e,t;try{o.value=!0,d.value=null;return{success:!0,data:(await P.get("/api/config/all")).data.data}}catch(a){return d.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||"Failed to fetch all configurations",{success:!1,error:d.value}}finally{o.value=!1}},updateThemeSettings:async t=>{var a,r;try{o.value=!0,d.value=null;const a=await P.put("/api/settings/theme",t);return e.value&&(e.value.theme={...e.value.theme,...a.data.data}),{success:!0,data:a.data.data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to update theme settings",{success:!1,error:d.value}}finally{o.value=!1}},updateLanguageSettings:async t=>{var a,r;try{o.value=!0,d.value=null;const a=await P.put("/api/settings/language",t);return e.value&&(e.value.language={...e.value.language,...a.data.data}),{success:!0,data:a.data.data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to update language settings",{success:!1,error:d.value}}finally{o.value=!1}},updateSecuritySettings:async t=>{var a,r;try{o.value=!0,d.value=null;const a=await P.put("/api/settings/security",t);return e.value&&(e.value.security={...e.value.security,...a.data.data}),{success:!0,data:a.data.data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to update security settings",{success:!1,error:d.value}}finally{o.value=!1}},updateBackupSettings:async t=>{var a,r;try{o.value=!0,d.value=null;const a=await P.put("/api/settings/backup",t);return e.value&&(e.value.backup={...e.value.backup,...a.data.data}),{success:!0,data:a.data.data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to update backup settings",{success:!1,error:d.value}}finally{o.value=!1}},updateAuditSettings:async t=>{var a,r;try{o.value=!0,d.value=null;const a=await P.put("/api/settings/audit",t);return e.value&&(e.value.audit={...e.value.audit,...a.data.data}),{success:!0,data:a.data.data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to update audit settings",{success:!1,error:d.value}}finally{o.value=!1}},updateNotificationSettings:async t=>{var a,r;try{o.value=!0,d.value=null;const a=await P.put("/api/settings/notifications",t);return e.value&&(e.value.notifications={...e.value.notifications,...a.data.data}),{success:!0,data:a.data.data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to update notification settings",{success:!1,error:d.value}}finally{o.value=!1}},fetchRoles:async()=>{var e,t;try{o.value=!0,d.value=null;const e=await P.get("/api/roles");return r.value=e.data.data,{success:!0}}catch(a){return d.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||"Failed to fetch roles",{success:!1,error:d.value}}finally{o.value=!1}},fetchPermissions:async()=>{var e,t;try{o.value=!0,d.value=null;const e=await P.get("/api/permissions");return s.value=e.data.data,{success:!0}}catch(a){return d.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||"Failed to fetch permissions",{success:!1,error:d.value}}finally{o.value=!1}},createRole:async e=>{var t,a;try{o.value=!0,d.value=null;const t=await P.post("/api/roles",e);return r.value.push(t.data.data),{success:!0,data:t.data.data}}catch(s){return d.value=(null==(a=null==(t=s.response)?void 0:t.data)?void 0:a.message)||"Failed to create role",{success:!1,error:d.value}}finally{o.value=!1}},updateRole:async(e,t)=>{var a,s;try{o.value=!0,d.value=null;const a=await P.put(`/api/roles/${e}`,t),s=r.value.findIndex(t=>t.id===e);return-1!==s&&(r.value[s]=a.data.data),{success:!0,data:a.data.data}}catch(l){return d.value=(null==(s=null==(a=l.response)?void 0:a.data)?void 0:s.message)||"Failed to update role",{success:!1,error:d.value}}finally{o.value=!1}},deleteRole:async e=>{var t,a;try{return o.value=!0,d.value=null,await P.delete(`/api/roles/${e}`),r.value=r.value.filter(t=>t.id!==e),{success:!0}}catch(s){return d.value=(null==(a=null==(t=s.response)?void 0:t.data)?void 0:a.message)||"Failed to delete role",{success:!1,error:d.value}}finally{o.value=!1}},fetchMessageTemplates:async()=>{var e,t;try{o.value=!0,d.value=null;const e=await P.get("/api/message-templates");return l.value=e.data.data,{success:!0}}catch(a){return d.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||"Failed to fetch message templates",{success:!1,error:d.value}}finally{o.value=!1}},createMessageTemplate:async e=>{var t,a;try{o.value=!0,d.value=null;const t=await P.post("/api/message-templates",e);return l.value.push(t.data.data),{success:!0,data:t.data.data}}catch(r){return d.value=(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"Failed to create message template",{success:!1,error:d.value}}finally{o.value=!1}},updateMessageTemplate:async(e,t)=>{var a,r;try{o.value=!0,d.value=null;const a=await P.put(`/api/message-templates/${e}`,t),r=l.value.findIndex(t=>t.id===e);return-1!==r&&(l.value[r]=a.data.data),{success:!0,data:a.data.data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to update message template",{success:!1,error:d.value}}finally{o.value=!1}},deleteMessageTemplate:async e=>{var t,a;try{return o.value=!0,d.value=null,await P.delete(`/api/message-templates/${e}`),l.value=l.value.filter(t=>t.id!==e),{success:!0}}catch(r){return d.value=(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"Failed to delete message template",{success:!1,error:d.value}}finally{o.value=!1}},setupTwoFactor:async e=>{var t,a;try{o.value=!0,d.value=null;return{success:!0,data:(await P.post("/api/auth/2fa/setup",{method:e})).data.data}}catch(r){return d.value=(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"Failed to setup two-factor authentication",{success:!1,error:d.value}}finally{o.value=!1}},verifyTwoFactor:async e=>{var t,a;try{o.value=!0,d.value=null;return{success:!0,data:(await P.post("/api/auth/2fa/verify",{code:e})).data.data}}catch(r){return d.value=(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"Failed to verify two-factor code",{success:!1,error:d.value}}finally{o.value=!1}},disableTwoFactor:async()=>{var e,t;try{return o.value=!0,d.value=null,await P.post("/api/auth/2fa/disable"),{success:!0}}catch(a){return d.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||"Failed to disable two-factor authentication",{success:!1,error:d.value}}finally{o.value=!1}},fetchAuditLogs:async e=>{var t,a;try{o.value=!0,d.value=null;const t=await P.get("/api/audit-logs",{params:e});return i.value=t.data.data,{success:!0}}catch(r){return d.value=(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"Failed to fetch audit logs",{success:!1,error:d.value}}finally{o.value=!1}},exportAuditLogs:async(e,t)=>{var a,r;try{o.value=!0,d.value=null;return{success:!0,data:(await P.get("/api/audit-logs/export",{params:{format:e,...t},responseType:"blob"})).data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to export audit logs",{success:!1,error:d.value}}finally{o.value=!1}},fetchLoginAnomalies:async()=>{var e,t;try{o.value=!0,d.value=null;const e=await P.get("/api/security/login-anomalies");return n.value=e.data.data,{success:!0}}catch(a){return d.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||"Failed to fetch login anomalies",{success:!1,error:d.value}}finally{o.value=!1}},updateAnomalyStatus:async(e,t)=>{var a,r;try{o.value=!0,d.value=null;const a=await P.put(`/api/security/login-anomalies/${e}`,{status:t}),r=n.value.findIndex(t=>t.id===e);return-1!==r&&(n.value[r]=a.data.data),{success:!0,data:a.data.data}}catch(s){return d.value=(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"Failed to update anomaly status",{success:!1,error:d.value}}finally{o.value=!1}},createBackup:async()=>{var e,t;try{o.value=!0,d.value=null;return{success:!0,data:(await P.post("/api/backups")).data.data}}catch(a){return d.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||"Failed to create backup",{success:!1,error:d.value}}finally{o.value=!1}},testBackupConnection:async()=>{var e,t;try{o.value=!0,d.value=null;return{success:!0,data:(await P.post("/api/backups/test-connection")).data.data}}catch(a){return d.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||"Failed to test backup connection",{success:!1,error:d.value}}finally{o.value=!1}}}});const Pi={class:"fixed inset-0 z-50 overflow-y-auto"},Di={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Vi={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"},Mi={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Si={class:"flex items-center justify-between mb-4"},Ti={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Ui={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},qi={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Fi={value:""},zi=["value"],Bi={key:0,value:"",disabled:""},Li={key:0,class:"mt-1 text-sm text-red-600"},Ri={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Ai={key:0,class:"mt-1 text-sm text-red-600"},Yi={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Ni={key:0,class:"mt-1 text-sm text-red-600"},Ei={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Gi={key:0,class:"mt-1 text-sm text-red-600"},Oi={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Hi={value:"en"},Ji={value:"fa"},Wi={key:0,class:"mt-1 text-sm text-red-600"},Xi={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Qi={value:""},Ki=["value"],Zi={key:0,value:"",disabled:""},en={class:"mb-6 border-t border-gray-200 dark:border-gray-700 pt-6"},tn={class:"flex items-center justify-between mb-4"},an={class:"text-md font-medium text-gray-900 dark:text-white"},rn={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},sn={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ln={class:"relative"},nn=["placeholder"],on={class:"absolute inset-y-0 right-0 flex items-center pr-3"},dn={class:"text-gray-500 text-sm"},cn={key:0,class:"mt-1 text-sm text-red-600"},un={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},gn={class:"relative"},mn=["placeholder"],vn={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},yn={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},pn={class:"relative"},xn=["placeholder"],bn={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},fn={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},hn={class:"relative"},kn=["placeholder"],wn={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},_n={class:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},$n={class:"text-sm text-blue-800 dark:text-blue-200"},Cn={class:"mb-6"},In={class:"flex items-center justify-between mb-4"},jn={class:"text-md font-medium text-gray-900 dark:text-white"},Pn={class:"overflow-x-auto"},Dn={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Vn={class:"bg-gray-50 dark:bg-gray-700"},Mn={class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Sn={class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Tn={class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Un={class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},qn={class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Fn={class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},zn={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Bn={class:"px-4 py-2"},Ln={class:"space-y-2"},Rn=["onUpdate:modelValue","onChange"],An={value:""},Yn=["value"],Nn=["onUpdate:modelValue","placeholder"],En=["onUpdate:modelValue","placeholder"],Gn={class:"px-4 py-2"},On={class:"space-y-2"},Hn={class:"flex items-center space-x-2"},Jn=["onUpdate:modelValue","placeholder","onInput"],Wn={class:"flex items-center space-x-2"},Xn=["onUpdate:modelValue","placeholder","onInput"],Qn={class:"px-4 py-2"},Kn=["onUpdate:modelValue","onInput"],Zn={class:"px-4 py-2"},eo={key:0,class:"text-xs space-y-1"},to={class:"flex justify-between"},ao={class:"text-gray-600 dark:text-gray-400"},ro={class:"font-medium"},so={class:"flex justify-between"},lo={class:"text-gray-600 dark:text-gray-400"},io={class:"font-medium"},no={class:"flex justify-between"},oo={class:"text-gray-600 dark:text-gray-400"},co={class:"font-medium"},uo={class:"flex justify-between"},go={class:"text-gray-600 dark:text-gray-400"},mo={class:"font-medium"},vo={class:"flex justify-between border-t border-gray-200 dark:border-gray-600 pt-1"},yo={class:"text-gray-600 dark:text-gray-400"},po={class:"font-bold"},xo={key:1,class:"text-xs text-gray-400"},bo={class:"px-4 py-2"},fo={class:"text-sm font-bold text-gray-900 dark:text-white"},ho={class:"px-4 py-2"},ko=["onClick"],wo={key:0,class:"text-center py-8"},_o={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},$o={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6"},Co={class:"space-y-2"},Io={class:"flex justify-between"},jo={class:"text-sm text-gray-600 dark:text-gray-400"},Po={class:"text-sm font-medium text-gray-900 dark:text-white"},Do={class:"flex justify-between"},Vo={class:"text-sm text-gray-600 dark:text-gray-400"},Mo={class:"text-sm font-medium text-gray-900 dark:text-white"},So={class:"border-t border-gray-200 dark:border-gray-600 pt-2"},To={class:"flex justify-between"},Uo={class:"text-base font-medium text-gray-900 dark:text-white"},qo={class:"text-base font-bold text-gray-900 dark:text-white"},Fo={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},zo=["placeholder"],Bo={class:"bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Lo=["disabled"],Ro={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ao=r({__name:"InvoiceFormModal",props:{invoice:{default:null},isEdit:{type:Boolean,default:!1}},emits:["close","saved"],setup(e,{emit:r}){const i=e,w=r,_=te(),$=Ii(),{formatCurrency:C}=D(),{defaultSettings:I,calculateItemPrice:j,loadDefaultSettings:P,formatCurrency:V}=function(){const e=ji(),a=t(!1),r=t(null),s=t({defaultLaborPercentage:10,defaultProfitPercentage:15,defaultTaxPercentage:9});return{loading:a,error:r,defaultSettings:s,calculateItemPrice:e=>{const{weight:t,goldPricePerGram:a,laborPercentage:r,profitPercentage:s,taxPercentage:l,quantity:i}=e;if(t<=0||a<=0||i<=0)throw new Error("Weight, gold price per gram, and quantity must be greater than zero");const n=t*a,o=n*(r/100),d=n+o,c=d*(s/100),u=d+c,g=u*(l/100),m=u+g,v=m*i;return{baseGoldCost:Math.round(n*i*100)/100,laborCost:Math.round(o*i*100)/100,profit:Math.round(c*i*100)/100,tax:Math.round(g*i*100)/100,unitPrice:Math.round(100*m)/100,totalPrice:Math.round(100*v)/100}},loadDefaultSettings:async()=>{try{a.value=!0,r.value=null;const t=await e.getDefaultPricingPercentages();return t.success&&(s.value={defaultLaborPercentage:t.data.labor_percentage||10,defaultProfitPercentage:t.data.profit_percentage||15,defaultTaxPercentage:t.data.tax_percentage||9}),s.value}catch(t){return r.value=t.message||"Failed to load default pricing settings",{defaultLaborPercentage:10,defaultProfitPercentage:15,defaultTaxPercentage:9}}finally{a.value=!1}},validatePricingParams:e=>{const t={};return(!e.weight||e.weight<=0)&&(t.weight="Weight must be greater than zero"),(!e.goldPricePerGram||e.goldPricePerGram<=0)&&(t.goldPricePerGram="Gold price per gram must be greater than zero"),(!e.quantity||e.quantity<=0)&&(t.quantity="Quantity must be greater than zero"),void 0!==e.laborPercentage&&e.laborPercentage<0&&(t.laborPercentage="Labor percentage cannot be negative"),void 0!==e.profitPercentage&&e.profitPercentage<0&&(t.profitPercentage="Profit percentage cannot be negative"),void 0!==e.taxPercentage&&e.taxPercentage<0&&(t.taxPercentage="Tax percentage cannot be negative"),t},formatCurrency:t=>{var a,r;const s="fa"===(null==(a=e.businessConfig)?void 0:a.default_language)?"fa-IR":"en-US",l=(null==(r=e.businessConfig)?void 0:r.default_currency)||"USD";return new Intl.NumberFormat(s,{style:"currency",currency:l,minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}}}(),M=t(!1),S=t({}),T=t({customer_id:"",invoice_number:"",issue_date:(new Date).toISOString().split("T")[0],due_date:new Date(Date.now()+2592e6).toISOString().split("T")[0],language:"en",template_id:"",subtotal:0,tax_amount:0,total_amount:0,status:"draft",notes:"",items:[],gold_price_per_gram:0,labor_percentage:0,profit_percentage:0,tax_percentage:0}),U=t({pricePerGram:0,laborPercentage:0,profitPercentage:0,taxPercentage:0}),q=a(()=>Array.isArray($.customers)?$.customers:[]),F=a(()=>[]),z=a(()=>Array.isArray(_.templates)?_.templates:[]),B=a(()=>T.value.items.reduce((e,t)=>e+(t.total_price||0),0)),N=a(()=>B.value+(T.value.tax_amount||0)),E=()=>{T.value.items.push({id:0,invoice_id:0,inventory_item_id:void 0,name:"",description:"",quantity:1,unit_price:0,total_price:0,gold_purity:void 0,weight:void 0,serial_number:void 0,category_id:void 0,main_category_id:void 0,category_path:void 0,main_category_name:void 0,category_name:void 0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),priceBreakdown:void 0})},G=e=>{const t=T.value.items[e];t.total_price=(t.quantity||0)*(t.unit_price||0),O()},O=()=>{T.value.subtotal=B.value,T.value.total_amount=N.value},H=()=>{U.value.laborPercentage=I.value.defaultLaborPercentage,U.value.profitPercentage=I.value.defaultProfitPercentage,U.value.taxPercentage=I.value.defaultTaxPercentage,W()},J=e=>{const t=T.value.items[e];if(!t.weight||!U.value.pricePerGram)return t.priceBreakdown=void 0,t.unit_price=0,t.total_price=0,void O();try{const e=j({weight:t.weight,goldPricePerGram:U.value.pricePerGram,laborPercentage:U.value.laborPercentage||I.value.defaultLaborPercentage,profitPercentage:U.value.profitPercentage||I.value.defaultProfitPercentage,taxPercentage:U.value.taxPercentage||I.value.defaultTaxPercentage,quantity:t.quantity||1});t.priceBreakdown=e,t.unit_price=e.unitPrice,t.total_price=e.totalPrice}catch(a){t.priceBreakdown=void 0,t.unit_price=0,t.total_price=0}O()},W=()=>{T.value.items.forEach((e,t)=>{J(t)})},X=async()=>{var e,t;M.value=!0,S.value={};try{const e={...T.value,customer_id:Number(T.value.customer_id),template_id:T.value.template_id?Number(T.value.template_id):void 0,gold_price_per_gram:U.value.pricePerGram,labor_percentage:U.value.laborPercentage||I.value.defaultLaborPercentage,profit_percentage:U.value.profitPercentage||I.value.defaultProfitPercentage,tax_percentage:U.value.taxPercentage||I.value.defaultTaxPercentage};let t;t=i.isEdit&&i.invoice?await _.updateInvoice(i.invoice.id,e):await _.createInvoice(e),t&&w("saved",t)}catch(a){(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.errors)&&(S.value=a.response.data.errors)}finally{M.value=!1}},Q=()=>{const e=new Date,t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=Math.floor(1e3*Math.random()).toString().padStart(3,"0");T.value.invoice_number=`INV-${t}${a}-${r}`};return s([B,()=>T.value.tax_amount],()=>{O()}),l(async()=>{try{await Promise.all([$.fetchCustomers().catch(e=>{}),_.fetchTemplates().catch(e=>{})])}catch(e){}await(async()=>{var e,t;await P(),i.isEdit&&i.invoice?(T.value={customer_id:(null==(e=i.invoice.customer_id)?void 0:e.toString())||"",invoice_number:i.invoice.invoice_number||"",issue_date:i.invoice.issue_date||(new Date).toISOString().split("T")[0],due_date:i.invoice.due_date||new Date(Date.now()+2592e6).toISOString().split("T")[0],language:i.invoice.language||"en",template_id:(null==(t=i.invoice.template_id)?void 0:t.toString())||"",subtotal:i.invoice.subtotal||0,tax_amount:i.invoice.tax_amount||0,total_amount:i.invoice.total_amount||0,status:i.invoice.status||"draft",notes:i.invoice.notes||"",items:i.invoice.items||[],gold_price_per_gram:i.invoice.gold_price_per_gram||0,labor_percentage:i.invoice.labor_percentage||0,profit_percentage:i.invoice.profit_percentage||0,tax_percentage:i.invoice.tax_percentage||0},U.value={pricePerGram:i.invoice.gold_price_per_gram||0,laborPercentage:i.invoice.labor_percentage||I.value.defaultLaborPercentage,profitPercentage:i.invoice.profit_percentage||I.value.defaultProfitPercentage,taxPercentage:i.invoice.tax_percentage||I.value.defaultTaxPercentage}):(Q(),U.value={pricePerGram:0,laborPercentage:I.value.defaultLaborPercentage,profitPercentage:I.value.defaultProfitPercentage,taxPercentage:I.value.defaultTaxPercentage})})()}),(e,t)=>(h(),n("div",Pi,[g("div",Di,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),g("div",Vi,[g("form",{onSubmit:y(X,["prevent"])},[g("div",Mi,[g("div",Si,[g("h3",Ti,c(e.isEdit?e.$t("invoices.edit_invoice"):e.$t("invoices.create_invoice")),1),g("button",{type:"button",onClick:t[1]||(t[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])]),g("div",Ui,[g("div",null,[g("label",qi,c(e.$t("invoices.customer"))+" * ",1),p(g("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>T.value.customer_id=e),required:"",class:o(["block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",{"border-red-500":S.value.customer_id}])},[g("option",Fi,c(e.$t("invoices.select_customer")),1),(h(!0),n(b,null,f(q.value,e=>(h(),n("option",{key:(null==e?void 0:e.id)||"unknown",value:null==e?void 0:e.id},c((null==e?void 0:e.name)||"Unknown Customer"),9,zi))),128)),0===q.value.length?(h(),n("option",Bi,c(e.$t("invoices.loading_customers")||"Loading customers..."),1)):u("",!0)],2),[[x,T.value.customer_id]]),S.value.customer_id?(h(),n("p",Li,c(S.value.customer_id[0]),1)):u("",!0)]),g("div",null,[g("label",Ri,c(e.$t("invoices.invoice_number"))+" * ",1),p(g("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>T.value.invoice_number=e),type:"text",required:"",class:o(["block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",{"border-red-500":S.value.invoice_number}])},null,2),[[k,T.value.invoice_number]]),S.value.invoice_number?(h(),n("p",Ai,c(S.value.invoice_number[0]),1)):u("",!0)]),g("div",null,[g("label",Yi,c(e.$t("invoices.issue_date"))+" * ",1),m(be,{modelValue:T.value.issue_date,"onUpdate:modelValue":t[4]||(t[4]=e=>T.value.issue_date=e),required:"",class:o({"border-red-500":S.value.issue_date})},null,8,["modelValue","class"]),S.value.issue_date?(h(),n("p",Ni,c(S.value.issue_date[0]),1)):u("",!0)]),g("div",null,[g("label",Ei,c(e.$t("invoices.due_date"))+" * ",1),m(be,{modelValue:T.value.due_date,"onUpdate:modelValue":t[5]||(t[5]=e=>T.value.due_date=e),required:"",class:o({"border-red-500":S.value.due_date})},null,8,["modelValue","class"]),S.value.due_date?(h(),n("p",Gi,c(S.value.due_date[0]),1)):u("",!0)]),g("div",null,[g("label",Oi,c(e.$t("common.language"))+" * ",1),p(g("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>T.value.language=e),required:"",class:o(["block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",{"border-red-500":S.value.language}])},[g("option",Hi,c(e.$t("common.english")),1),g("option",Ji,c(e.$t("common.persian")),1)],2),[[x,T.value.language]]),S.value.language?(h(),n("p",Wi,c(S.value.language[0]),1)):u("",!0)]),g("div",null,[g("label",Xi,c(e.$t("invoices.template")),1),p(g("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>T.value.template_id=e),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[g("option",Qi,c(e.$t("invoices.default_template")),1),(h(!0),n(b,null,f(z.value,e=>(h(),n("option",{key:(null==e?void 0:e.id)||"unknown",value:null==e?void 0:e.id},c((null==e?void 0:e.name)||"Unknown Template"),9,Ki))),128)),0===z.value.length?(h(),n("option",Zi,c(e.$t("invoices.loading_templates")||"Loading templates..."),1)):u("",!0)],512),[[x,T.value.template_id]])])]),g("div",en,[g("div",tn,[g("h4",an,c(e.$t("invoices.gold_pricing")),1),g("button",{type:"button",onClick:H,class:"text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300"},c(e.$t("invoices.reset_to_defaults")),1)]),g("div",rn,[g("div",null,[g("label",sn,c(e.$t("invoices.current_gold_price_per_gram"))+" * ",1),g("div",ln,[p(g("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>U.value.pricePerGram=e),type:"number",step:"0.01",min:"0",required:"",onInput:W,class:o(["block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-12",{"border-red-500":S.value.gold_price_per_gram}]),placeholder:e.$t("invoices.enter_gold_price")},null,42,nn),[[k,U.value.pricePerGram,void 0,{number:!0}]]),g("div",on,[g("span",dn,c(e.$t("common.currency_per_gram")),1)])]),S.value.gold_price_per_gram?(h(),n("p",cn,c(S.value.gold_price_per_gram[0]),1)):u("",!0)]),g("div",null,[g("label",un,c(e.$t("invoices.labor_cost_percentage")),1),g("div",gn,[p(g("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>U.value.laborPercentage=e),type:"number",step:"0.1",min:"0",onInput:W,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8",placeholder:v(I).defaultLaborPercentage.toString()},null,40,mn),[[k,U.value.laborPercentage,void 0,{number:!0}]]),t[14]||(t[14]=g("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3"},[g("span",{class:"text-gray-500 text-sm"},"%")],-1))]),g("p",vn,c(e.$t("invoices.default"))+": "+c(v(I).defaultLaborPercentage)+"% ",1)]),g("div",null,[g("label",yn,c(e.$t("invoices.profit_percentage")),1),g("div",pn,[p(g("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>U.value.profitPercentage=e),type:"number",step:"0.1",min:"0",onInput:W,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8",placeholder:v(I).defaultProfitPercentage.toString()},null,40,xn),[[k,U.value.profitPercentage,void 0,{number:!0}]]),t[15]||(t[15]=g("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3"},[g("span",{class:"text-gray-500 text-sm"},"%")],-1))]),g("p",bn,c(e.$t("invoices.default"))+": "+c(v(I).defaultProfitPercentage)+"% ",1)]),g("div",null,[g("label",fn,c(e.$t("invoices.tax_percentage")),1),g("div",hn,[p(g("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>U.value.taxPercentage=e),type:"number",step:"0.1",min:"0",onInput:W,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8",placeholder:v(I).defaultTaxPercentage.toString()},null,40,kn),[[k,U.value.taxPercentage,void 0,{number:!0}]]),t[16]||(t[16]=g("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3"},[g("span",{class:"text-gray-500 text-sm"},"%")],-1))]),g("p",wn,c(e.$t("invoices.default"))+": "+c(v(I).defaultTaxPercentage)+"% ",1)])]),g("div",_n,[g("p",$n,[g("strong",null,c(e.$t("invoices.pricing_formula"))+":",1),d(" "+c(e.$t("invoices.formula_explanation")),1)])])]),g("div",Cn,[g("div",In,[g("h4",jn,c(e.$t("invoices.items")),1),g("button",{type:"button",onClick:E,class:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-primary-700 bg-primary-100 hover:bg-primary-200 dark:bg-primary-900 dark:text-primary-300"},[m(v(Y),{class:"h-4 w-4 mr-1"}),d(" "+c(e.$t("invoices.add_item")),1)])]),g("div",Pn,[g("table",Dn,[g("thead",Vn,[g("tr",null,[g("th",Mn,c(e.$t("invoices.item_description")),1),g("th",Sn,c(e.$t("invoices.weight_purity")),1),g("th",Tn,c(e.$t("invoices.quantity")),1),g("th",Un,c(e.$t("invoices.price_breakdown")),1),g("th",qn,c(e.$t("invoices.total")),1),g("th",Fn,c(e.$t("common.actions")),1)])]),g("tbody",zn,[(h(!0),n(b,null,f(T.value.items,(a,r)=>(h(),n("tr",{key:r},[g("td",Bn,[g("div",Ln,[p(g("select",{"onUpdate:modelValue":e=>a.inventory_item_id=e,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",onChange:e=>((e,t)=>{var a,r;if(t&&F.value&&F.value.length>0){const s=F.value.find(e=>e&&e.id===t);s&&(T.value.items[e].name=s.name||"",T.value.items[e].description=s.description||"",T.value.items[e].unit_price=s.unit_price||0,T.value.items[e].gold_purity=s.gold_purity||void 0,T.value.items[e].weight=s.weight||void 0,T.value.items[e].serial_number=s.serial_number||void 0,T.value.items[e].category_id=s.category_id||void 0,T.value.items[e].main_category_id=s.main_category_id||void 0,T.value.items[e].category_path=s.category_path||void 0,T.value.items[e].main_category_name=(null==(a=s.main_category)?void 0:a.name)||void 0,T.value.items[e].category_name=(null==(r=s.category)?void 0:r.name)||void 0,s.weight&&U.value.pricePerGram?J(e):G(e))}})(r,a.inventory_item_id)},[g("option",An,c(e.$t("invoices.select_item")),1),(h(!0),n(b,null,f(F.value,e=>(h(),n("option",{key:e.id,value:e.id},c(e.name)+" ("+c(e.sku)+") ",9,Yn))),128))],40,Rn),[[x,a.inventory_item_id]]),p(g("input",{"onUpdate:modelValue":e=>a.name=e,type:"text",placeholder:e.$t("invoices.item_name"),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},null,8,Nn),[[k,a.name]]),p(g("input",{"onUpdate:modelValue":e=>a.description=e,type:"text",placeholder:e.$t("invoices.custom_description"),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},null,8,En),[[k,a.description]])])]),g("td",Gn,[g("div",On,[g("div",Hn,[p(g("input",{"onUpdate:modelValue":e=>a.weight=e,type:"number",step:"0.001",min:"0",placeholder:e.$t("invoices.weight_grams"),class:"w-20 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",onInput:e=>J(r)},null,40,Jn),[[k,a.weight,void 0,{number:!0}]]),t[17]||(t[17]=g("span",{class:"text-xs text-gray-500"},"g",-1))]),g("div",Wn,[p(g("input",{"onUpdate:modelValue":e=>a.gold_purity=e,type:"number",step:"0.1",min:"0",max:"24",placeholder:e.$t("invoices.gold_purity_placeholder"),class:"w-20 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",onInput:e=>J(r)},null,40,Xn),[[k,a.gold_purity,void 0,{number:!0}]]),t[18]||(t[18]=g("span",{class:"text-xs text-gray-500"},"K",-1))])])]),g("td",Qn,[p(g("input",{"onUpdate:modelValue":e=>a.quantity=e,type:"number",step:"1",min:"1",class:"w-20 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",onInput:e=>J(r)},null,40,Kn),[[k,a.quantity,void 0,{number:!0}]])]),g("td",Zn,[a.priceBreakdown?(h(),n("div",eo,[g("div",to,[g("span",ao,c(e.$t("invoices.base_gold"))+":",1),g("span",ro,c(v(C)(a.priceBreakdown.baseGoldCost)),1)]),g("div",so,[g("span",lo,c(e.$t("invoices.labor"))+":",1),g("span",io,c(v(C)(a.priceBreakdown.laborCost)),1)]),g("div",no,[g("span",oo,c(e.$t("invoices.profit"))+":",1),g("span",co,c(v(C)(a.priceBreakdown.profit)),1)]),g("div",uo,[g("span",go,c(e.$t("invoices.tax"))+":",1),g("span",mo,c(v(C)(a.priceBreakdown.tax)),1)]),g("div",vo,[g("span",yo,c(e.$t("invoices.unit_price"))+":",1),g("span",po,c(v(C)(a.priceBreakdown.unitPrice)),1)])])):(h(),n("div",xo,c(e.$t("invoices.enter_weight_for_pricing")),1))]),g("td",bo,[g("span",fo,c(v(C)(a.total_price||0)),1)]),g("td",ho,[g("button",{type:"button",onClick:e=>(e=>{T.value.items.splice(e,1),O()})(r),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},[m(v(L),{class:"h-4 w-4"})],8,ko)])]))),128))])])]),0===T.value.items.length?(h(),n("div",wo,[m(v(R),{class:"mx-auto h-12 w-12 text-gray-400"}),g("p",_o,c(e.$t("invoices.no_items_added")),1),g("button",{type:"button",onClick:E,class:"mt-2 inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-primary-700 bg-primary-100 hover:bg-primary-200 dark:bg-primary-900 dark:text-primary-300"},[m(v(Y),{class:"h-4 w-4 mr-1"}),d(" "+c(e.$t("invoices.add_first_item")),1)])])):u("",!0)]),g("div",$o,[g("div",Co,[g("div",Io,[g("span",jo,c(e.$t("invoices.subtotal"))+": ",1),g("span",Po,c(v(C)(B.value)),1)]),g("div",Do,[g("span",Vo,c(e.$t("invoices.tax"))+": ",1),g("span",Mo,c(v(C)(T.value.tax_amount||0)),1)]),g("div",So,[g("div",To,[g("span",Uo,c(e.$t("invoices.total"))+": ",1),g("span",qo,c(v(C)(N.value)),1)])])])]),g("div",null,[g("label",Fo,c(e.$t("invoices.notes")),1),p(g("textarea",{"onUpdate:modelValue":t[12]||(t[12]=e=>T.value.notes=e),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:e.$t("invoices.notes_placeholder")},null,8,zo),[[k,T.value.notes]])])]),g("div",Bo,[g("button",{type:"submit",disabled:M.value||0===T.value.items.length,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[M.value?(h(),n("svg",Ro,t[19]||(t[19]=[g("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),g("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):u("",!0),d(" "+c(e.isEdit?e.$t("common.update"):e.$t("common.create")),1)],8,Lo),g("button",{type:"button",onClick:t[13]||(t[13]=t=>e.$emit("close")),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"},c(e.$t("common.cancel")),1)])],32)])])]))}}),Yo={class:"fixed inset-0 z-50 overflow-y-auto"},No={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Eo={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full"},Go={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 border-b border-gray-200 dark:border-gray-700"},Oo={class:"flex items-center justify-between"},Ho={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Jo={class:"flex items-center space-x-3"},Wo=["disabled"],Xo={class:"bg-gray-100 dark:bg-gray-900 p-6 max-h-[80vh] overflow-y-auto"},Qo={class:"max-w-4xl mx-auto"},Ko={class:"bg-white shadow-lg rounded-lg overflow-hidden"},Zo={key:0,class:"flex items-center justify-center h-96"},ed={class:"text-center"},td={class:"text-gray-600 dark:text-gray-400"},ad={key:1,class:"p-8 space-y-6"},rd={class:"flex justify-between items-start"},sd={class:"w-32 h-16 bg-gray-200 border-2 border-dashed border-gray-300 flex items-center justify-center mb-4"},ld={class:"text-xs text-gray-500"},id={class:"text-3xl font-bold text-gray-900 mb-2"},nd={class:"text-right"},od={class:"text-sm text-gray-600 space-y-1"},dd={class:"grid grid-cols-2 gap-8"},cd={class:"text-sm font-semibold text-gray-900 mb-2"},ud={class:"text-sm text-gray-700"},gd={class:"font-medium"},md={key:0},vd={key:1},yd={key:2},pd={class:"text-sm font-semibold text-gray-900 mb-2"},xd={class:"text-sm text-gray-700"},bd={class:"font-medium"},fd={class:"w-full border-collapse border border-gray-300"},hd={class:"bg-gray-50"},kd={class:"border border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-900"},wd={class:"border border-gray-300 px-4 py-2 text-right text-sm font-semibold text-gray-900"},_d={class:"border border-gray-300 px-4 py-2 text-right text-sm font-semibold text-gray-900"},$d={class:"border border-gray-300 px-4 py-2 text-right text-sm font-semibold text-gray-900"},Cd={class:"border border-gray-300 px-4 py-2 text-sm text-gray-900"},Id={class:"border border-gray-300 px-4 py-2 text-sm text-gray-900 text-right"},jd={class:"border border-gray-300 px-4 py-2 text-sm text-gray-900 text-right"},Pd={class:"border border-gray-300 px-4 py-2 text-sm font-medium text-gray-900 text-right"},Dd={class:"flex justify-end"},Vd={class:"w-64"},Md={class:"space-y-2"},Sd={class:"flex justify-between text-sm"},Td={class:"text-gray-600"},Ud={class:"font-medium text-gray-900"},qd={class:"flex justify-between text-sm"},Fd={class:"text-gray-600"},zd={class:"font-medium text-gray-900"},Bd={class:"border-t border-gray-300 pt-2"},Ld={class:"flex justify-between text-base font-bold"},Rd={class:"text-gray-900"},Ad={class:"text-gray-900"},Yd={key:0,class:"border-t border-gray-300 pt-4"},Nd={class:"text-sm font-semibold text-gray-900 mb-2"},Ed={class:"text-sm text-gray-700"},Gd={class:"flex justify-between items-end border-t border-gray-300 pt-4"},Od={class:"text-xs text-gray-500"},Hd=r({__name:"PDFPreviewModal",props:{invoice:{}},emits:["close","download"],setup(e,{emit:a}){const{formatCurrency:r,formatNumber:s}=D(),{formatDate:i}=ae(),o=t(!0);return l(()=>{setTimeout(()=>{o.value=!1},1e3)}),(e,t)=>{var a,l,y,p,x,k,w,_,$,C,I,j,P,D,V,M,S,T,U,F,z,B,L,R,Y,N,E,G,O,H,J;return h(),n("div",Yo,[g("div",No,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),g("div",Eo,[g("div",Go,[g("div",Oo,[g("h3",Ho,c(e.$t("invoices.pdf_preview"))+" - "+c(null==(a=e.invoice)?void 0:a.invoice_number),1),g("div",Jo,[g("button",{onClick:t[1]||(t[1]=t=>e.invoice&&e.$emit("download",e.invoice)),disabled:!e.invoice,class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},[m(v(q),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("common.download")),1)],8,Wo),g("button",{onClick:t[2]||(t[2]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])])])]),g("div",Xo,[g("div",Qo,[g("div",Ko,[o.value?(h(),n("div",Zo,[g("div",ed,[t[3]||(t[3]=g("svg",{class:"animate-spin h-8 w-8 text-primary-500 mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[g("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),g("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),g("p",td,c(e.$t("invoices.generating_preview")),1)])])):(h(),n("div",ad,[g("div",rd,[g("div",null,[g("div",sd,[g("span",ld,c(e.$t("invoices.logo_placeholder")),1)]),g("h1",id,c("fa"===(null==(l=e.invoice)?void 0:l.language)?"فاکتور":"INVOICE"),1)]),g("div",nd,[g("div",od,[g("p",null,[g("strong",null,c("fa"===(null==(y=e.invoice)?void 0:y.language)?"شماره فاکتور:":"Invoice #:"),1),d(" "+c(null==(p=e.invoice)?void 0:p.invoice_number),1)]),g("p",null,[g("strong",null,c("fa"===(null==(x=e.invoice)?void 0:x.language)?"تاریخ صدور:":"Issue Date:"),1),d(" "+c((null==(k=e.invoice)?void 0:k.issue_date)?v(i)(e.invoice.issue_date):""),1)]),g("p",null,[g("strong",null,c("fa"===(null==(w=e.invoice)?void 0:w.language)?"تاریخ سررسید:":"Due Date:"),1),d(" "+c((null==(_=e.invoice)?void 0:_.due_date)?v(i)(e.invoice.due_date):""),1)])])])]),g("div",dd,[g("div",null,[g("h3",cd,c("fa"===(null==($=e.invoice)?void 0:$.language)?"صادر شده برای:":"Bill To:"),1),g("div",ud,[g("p",gd,c(null==(I=null==(C=e.invoice)?void 0:C.customer)?void 0:I.name),1),(null==(P=null==(j=e.invoice)?void 0:j.customer)?void 0:P.email)?(h(),n("p",md,c(e.invoice.customer.email),1)):u("",!0),(null==(V=null==(D=e.invoice)?void 0:D.customer)?void 0:V.phone)?(h(),n("p",vd,c(e.invoice.customer.phone),1)):u("",!0),(null==(S=null==(M=e.invoice)?void 0:M.customer)?void 0:S.address)?(h(),n("p",yd,c(e.invoice.customer.address),1)):u("",!0)])]),g("div",null,[g("h3",pd,c("fa"===(null==(T=e.invoice)?void 0:T.language)?"صادر شده از:":"From:"),1),g("div",xd,[g("p",bd,c(e.$t("business.company_name")),1),g("p",null,c(e.$t("business.company_address")),1),g("p",null,c(e.$t("business.company_phone")),1),g("p",null,c(e.$t("business.company_email")),1)])])]),g("div",null,[g("table",fd,[g("thead",null,[g("tr",hd,[g("th",kd,c("fa"===(null==(U=e.invoice)?void 0:U.language)?"شرح":"Description"),1),g("th",wd,c("fa"===(null==(F=e.invoice)?void 0:F.language)?"تعداد":"Qty"),1),g("th",_d,c("fa"===(null==(z=e.invoice)?void 0:z.language)?"قیمت واحد":"Unit Price"),1),g("th",$d,c("fa"===(null==(B=e.invoice)?void 0:B.language)?"مجموع":"Total"),1)])]),g("tbody",null,[(h(!0),n(b,null,f(null==(L=e.invoice)?void 0:L.items,e=>(h(),n("tr",{key:e.id},[g("td",Cd,c(e.description),1),g("td",Id,c(v(s)(e.quantity)),1),g("td",jd,c(v(r)(e.unit_price)),1),g("td",Pd,c(v(r)(e.total_price)),1)]))),128))])])]),g("div",Dd,[g("div",Vd,[g("div",Md,[g("div",Sd,[g("span",Td,c("fa"===(null==(R=e.invoice)?void 0:R.language)?"جمع کل:":"Subtotal:"),1),g("span",Ud,c(v(r)((null==(Y=e.invoice)?void 0:Y.subtotal)||0)),1)]),g("div",qd,[g("span",Fd,c("fa"===(null==(N=e.invoice)?void 0:N.language)?"مالیات:":"Tax:"),1),g("span",zd,c(v(r)((null==(E=e.invoice)?void 0:E.tax_amount)||0)),1)]),g("div",Bd,[g("div",Ld,[g("span",Rd,c("fa"===(null==(G=e.invoice)?void 0:G.language)?"مجموع نهایی:":"Total:"),1),g("span",Ad,c(v(r)((null==(O=e.invoice)?void 0:O.total_amount)||0)),1)])])])])]),(null==(H=e.invoice)?void 0:H.notes)?(h(),n("div",Yd,[g("h3",Nd,c("fa"===(null==(J=e.invoice)?void 0:J.language)?"یادداشت:":"Notes:"),1),g("p",Ed,c(e.invoice.notes),1)])):u("",!0),g("div",Gd,[g("div",Od,[g("p",null,c(e.$t("invoices.thank_you_message")),1)]),t[4]||(t[4]=g("div",{class:"w-16 h-16 bg-gray-200 border border-gray-300 flex items-center justify-center"},[g("span",{class:"text-xs text-gray-500"},"QR")],-1))])]))])])])])])])}}}),Jd={class:"fixed inset-0 z-50 overflow-y-auto"},Wd={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Xd={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"},Qd={key:0,class:"bg-white dark:bg-gray-800"},Kd={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Zd={class:"flex items-center justify-between"},ec={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},tc={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},ac={class:"flex items-center space-x-3"},rc={class:"px-6 py-4 max-h-[70vh] overflow-y-auto"},sc={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},lc={class:"space-y-4"},ic={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},nc={class:"space-y-2"},oc={class:"flex justify-between"},dc={class:"text-sm text-gray-500 dark:text-gray-400"},cc={class:"text-sm font-medium text-gray-900 dark:text-white"},uc={class:"flex justify-between"},gc={class:"text-sm text-gray-500 dark:text-gray-400"},mc={class:"text-sm font-medium text-gray-900 dark:text-white"},vc={class:"flex justify-between"},yc={class:"text-sm text-gray-500 dark:text-gray-400"},pc={class:"text-sm font-medium text-gray-900 dark:text-white"},xc={class:"flex justify-between"},bc={class:"text-sm text-gray-500 dark:text-gray-400"},fc={class:"text-sm font-medium text-gray-900 dark:text-white"},hc={key:0},kc={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},wc={class:"space-y-2"},_c={class:"flex justify-between"},$c={class:"text-sm text-gray-500 dark:text-gray-400"},Cc={class:"text-sm font-medium text-gray-900 dark:text-white"},Ic={key:0,class:"flex justify-between"},jc={class:"text-sm text-gray-500 dark:text-gray-400"},Pc={class:"text-sm font-medium text-gray-900 dark:text-white"},Dc={key:1,class:"flex justify-between"},Vc={class:"text-sm text-gray-500 dark:text-gray-400"},Mc={class:"text-sm font-medium text-gray-900 dark:text-white"},Sc={key:2,class:"flex justify-between"},Tc={class:"text-sm text-gray-500 dark:text-gray-400"},Uc={class:"text-sm font-medium text-gray-900 dark:text-white"},qc={key:1},Fc={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},zc={class:"text-sm text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-700 p-3 rounded-md"},Bc={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},Lc={class:"overflow-x-auto"},Rc={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Ac={class:"bg-gray-50 dark:bg-gray-700"},Yc={class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Nc={class:"px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Ec={class:"px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Gc={class:"px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},Oc={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Hc={class:"px-3 py-2 text-sm text-gray-900 dark:text-white"},Jc={class:"px-3 py-2 text-sm text-gray-900 dark:text-white text-right"},Wc={class:"px-3 py-2 text-sm text-gray-900 dark:text-white text-right"},Xc={class:"px-3 py-2 text-sm font-medium text-gray-900 dark:text-white text-right"},Qc={class:"mt-4 bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Kc={class:"space-y-2"},Zc={class:"flex justify-between"},eu={class:"text-sm text-gray-600 dark:text-gray-400"},tu={class:"text-sm font-medium text-gray-900 dark:text-white"},au={class:"flex justify-between"},ru={class:"text-sm text-gray-600 dark:text-gray-400"},su={class:"text-sm font-medium text-gray-900 dark:text-white"},lu={class:"border-t border-gray-200 dark:border-gray-600 pt-2"},iu={class:"flex justify-between"},nu={class:"text-base font-medium text-gray-900 dark:text-white"},ou={class:"text-base font-bold text-gray-900 dark:text-white"},du={class:"bg-gray-50 dark:bg-gray-700 px-6 py-4 flex flex-wrap items-center justify-between gap-3"},cu={class:"flex flex-wrap items-center gap-2"},uu={class:"relative"},gu={key:0,class:"absolute bottom-full mb-2 left-0 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg z-10 border border-gray-200 dark:border-gray-700"},mu={class:"py-1"},vu={class:"flex items-center space-x-2"},yu=r({__name:"InvoiceDetailsModal",props:{invoice:{}},emits:["close","edit","delete","duplicate","generate-pdf","send"],setup(e,{emit:a}){const r=e,s=a,{formatCurrency:l,formatNumber:i}=D(),{formatDate:y}=ae(),p=t(!1),x=t(!1),k=e=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",paid:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",overdue:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",cancelled:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"};return t[e]||t.draft},_=e=>{r.invoice&&s("send",r.invoice,e),p.value=!1};return document.addEventListener("click",e=>{e.target.closest(".relative")||(p.value=!1)}),(e,t)=>(h(),n("div",Jd,[g("div",Wd,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),g("div",Xd,[e.invoice?(h(),n("div",Qd,[g("div",Kd,[g("div",Zd,[g("div",null,[g("h3",ec,c(e.$t("invoices.invoice_details")),1),g("p",tc,c(e.invoice.invoice_number),1)]),g("div",ac,[g("span",{class:o([k(e.invoice.status),"inline-flex px-3 py-1 text-sm font-semibold rounded-full"])},c(e.$t(`invoices.status_${e.invoice.status}`)),3),g("span",{class:o(["fa"===e.invoice.language?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300","inline-flex px-3 py-1 text-sm font-semibold rounded-full"])},c("fa"===e.invoice.language?e.$t("common.persian"):e.$t("common.english")),3),g("button",{onClick:t[1]||(t[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])])])]),g("div",rc,[g("div",sc,[g("div",lc,[g("div",null,[g("h4",ic,c(e.$t("invoices.invoice_information")),1),g("dl",nc,[g("div",oc,[g("dt",dc,c(e.$t("invoices.invoice_number"))+": ",1),g("dd",cc,c(e.invoice.invoice_number),1)]),g("div",uc,[g("dt",gc,c(e.$t("invoices.issue_date"))+": ",1),g("dd",mc,c(v(y)(e.invoice.issue_date)),1)]),g("div",vc,[g("dt",yc,c(e.$t("invoices.due_date"))+": ",1),g("dd",pc,c(v(y)(e.invoice.due_date)),1)]),g("div",xc,[g("dt",bc,c(e.$t("common.created_at"))+": ",1),g("dd",fc,c(v(y)(e.invoice.created_at)),1)])])]),e.invoice.customer?(h(),n("div",hc,[g("h4",kc,c(e.$t("invoices.customer_information")),1),g("dl",wc,[g("div",_c,[g("dt",$c,c(e.$t("customers.name"))+": ",1),g("dd",Cc,c(e.invoice.customer.name),1)]),e.invoice.customer.email?(h(),n("div",Ic,[g("dt",jc,c(e.$t("customers.email"))+": ",1),g("dd",Pc,c(e.invoice.customer.email),1)])):u("",!0),e.invoice.customer.phone?(h(),n("div",Dc,[g("dt",Vc,c(e.$t("customers.phone"))+": ",1),g("dd",Mc,c(e.invoice.customer.phone),1)])):u("",!0),e.invoice.customer.address?(h(),n("div",Sc,[g("dt",Tc,c(e.$t("customers.address"))+": ",1),g("dd",Uc,c(e.invoice.customer.address),1)])):u("",!0)])])):u("",!0),e.invoice.notes?(h(),n("div",qc,[g("h4",Fc,c(e.$t("invoices.notes")),1),g("p",zc,c(e.invoice.notes),1)])):u("",!0)]),g("div",null,[g("h4",Bc,c(e.$t("invoices.items")),1),g("div",Lc,[g("table",Rc,[g("thead",Ac,[g("tr",null,[g("th",Yc,c(e.$t("invoices.item_description")),1),g("th",Nc,c(e.$t("invoices.quantity")),1),g("th",Ec,c(e.$t("invoices.unit_price")),1),g("th",Gc,c(e.$t("invoices.total")),1)])]),g("tbody",Oc,[(h(!0),n(b,null,f(e.invoice.items,e=>(h(),n("tr",{key:e.id},[g("td",Hc,c(e.description),1),g("td",Jc,c(v(i)(e.quantity)),1),g("td",Wc,c(v(l)(e.unit_price)),1),g("td",Xc,c(v(l)(e.total_price)),1)]))),128))])])]),g("div",Qc,[g("div",Kc,[g("div",Zc,[g("span",eu,c(e.$t("invoices.subtotal"))+": ",1),g("span",tu,c(v(l)(e.invoice.subtotal)),1)]),g("div",au,[g("span",ru,c(e.$t("invoices.tax"))+": ",1),g("span",su,c(v(l)(e.invoice.tax_amount)),1)]),g("div",lu,[g("div",iu,[g("span",nu,c(e.$t("invoices.total"))+": ",1),g("span",ou,c(v(l)(e.invoice.total_amount)),1)])])])])])])]),g("div",du,[g("div",cu,[g("div",uu,[g("button",{onClick:t[2]||(t[2]=e=>p.value=!p.value),class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"},[m(v(B),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.send"))+" ",1),m(v(H),{class:"h-4 w-4 ml-1"})]),p.value?(h(),n("div",gu,[g("div",mu,[g("button",{onClick:t[3]||(t[3]=e=>_("email")),class:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},c(e.$t("invoices.send_email")),1),g("button",{onClick:t[4]||(t[4]=e=>_("whatsapp")),class:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},c(e.$t("invoices.send_whatsapp")),1),g("button",{onClick:t[5]||(t[5]=e=>_("sms")),class:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},c(e.$t("invoices.send_sms")),1)])])):u("",!0)]),g("button",{onClick:t[6]||(t[6]=t=>e.$emit("generate-pdf",e.invoice)),class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"},[m(v(q),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.download_pdf")),1)]),g("button",{onClick:t[7]||(t[7]=e=>x.value=!0),class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"},[m(v(U),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.preview")),1)])]),g("div",vu,[g("button",{onClick:t[8]||(t[8]=t=>e.$emit("edit",e.invoice)),class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"},[m(v(F),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("common.edit")),1)]),g("button",{onClick:t[9]||(t[9]=t=>e.$emit("duplicate",e.invoice)),class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"},[m(v(z),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("common.duplicate")),1)]),g("button",{onClick:t[10]||(t[10]=t=>e.$emit("delete",e.invoice)),class:"inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm leading-4 font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:bg-gray-700 dark:text-red-400 dark:border-red-600 dark:hover:bg-red-900/20"},[m(v(L),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("common.delete")),1)])])])])):u("",!0)])]),x.value?(h(),w(Hd,{key:0,invoice:e.invoice,onClose:t[11]||(t[11]=e=>x.value=!1),onDownload:t[12]||(t[12]=t=>e.invoice&&e.$emit("generate-pdf",e.invoice))},null,8,["invoice"])):u("",!0)]))}}),pu={class:"fixed inset-0 z-50 overflow-y-auto"},xu={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},bu={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-7xl sm:w-full"},fu={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 border-b border-gray-200 dark:border-gray-700"},hu={class:"flex items-center justify-between"},ku={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},wu={class:"flex items-center space-x-3"},_u=["disabled"],$u={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Cu={class:"flex h-[80vh]"},Iu={class:"w-80 bg-gray-50 dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 overflow-y-auto"},ju={class:"p-4 space-y-6"},Pu={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},Du={class:"space-y-4"},Vu={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Mu={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Su={value:"en"},Tu={value:"fa"},Uu={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},qu={value:"standard"},Fu={value:"modern"},zu={value:"classic"},Bu={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},Lu={class:"space-y-2"},Ru=["onDragstart"],Au={class:"flex items-center"},Yu={class:"text-sm text-gray-900 dark:text-white"},Nu={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Eu={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},Gu={class:"space-y-3"},Ou={class:"flex items-center"},Hu={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},Ju={class:"flex items-center"},Wu={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},Xu={class:"flex items-center"},Qu={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},Ku={class:"flex items-center"},Zu={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},eg={class:"flex items-center"},tg={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},ag={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},rg={class:"space-y-2"},sg=["onUpdate:modelValue","placeholder"],lg=["onClick"],ig={class:"flex-1 bg-white dark:bg-gray-800 overflow-hidden"},ng={class:"h-full flex flex-col"},og={class:"border-b border-gray-200 dark:border-gray-700 p-4"},dg={class:"flex items-center justify-between"},cg={class:"flex items-center space-x-4"},ug={class:"text-sm text-gray-600 dark:text-gray-400"},gg={class:"flex items-center space-x-2"},mg={class:"text-sm text-gray-600 dark:text-gray-400"},vg={class:"flex items-center space-x-2"},yg={class:"flex-1 overflow-auto p-8 bg-gray-100 dark:bg-gray-900"},pg={class:"h-full p-8 relative"},xg={class:"mb-8"},bg={key:0,class:"mb-4"},fg={class:"w-32 h-16 bg-gray-200 border-2 border-dashed border-gray-300 flex items-center justify-center"},hg={class:"text-xs text-gray-500"},kg={class:"text-2xl font-bold text-gray-900 mb-2"},wg={class:"text-sm text-gray-600"},_g=["onDragstart","onClick"],$g={class:"flex items-center justify-between"},Cg={class:"text-xs font-medium text-primary-700"},Ig=["onClick"],jg={class:"text-xs text-gray-600 mt-1"},Pg={key:0,class:"absolute bottom-8 right-8"},Dg={key:0,class:"w-64 bg-gray-50 dark:bg-gray-900 border-l border-gray-200 dark:border-gray-700 overflow-y-auto"},Vg={class:"p-4"},Mg={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},Sg={class:"space-y-4"},Tg={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ug={class:"grid grid-cols-2 gap-2"},qg={class:"grid grid-cols-2 gap-2"},Fg={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},zg={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Bg=r({__name:"InvoiceTemplateDesigner",props:{template:{default:null}},emits:["close","saved"],setup(e,{emit:a}){const r=e,s=a,i=te(),_=t(!1),j=t(),P=t(1),D=t(null),M=t(null),S=t([]),T=t({name:"",language:"en",layout:"standard",fields:{logo:!0,qr_code:!0,category_hierarchy:!0,category_images:!0,gold_purity:!0,custom_fields:[]}}),q=[{key:"customer_name",label:"invoices.customer_name",description:"invoices.customer_name_desc",icon:W,sampleValue:"John Doe"},{key:"customer_address",label:"invoices.customer_address",description:"invoices.customer_address_desc",icon:R,sampleValue:"123 Main St, City"},{key:"invoice_date",label:"invoices.invoice_date",description:"invoices.invoice_date_desc",icon:V,sampleValue:"2024-01-01"},{key:"due_date",label:"invoices.due_date",description:"invoices.due_date_desc",icon:V,sampleValue:"2024-01-31"},{key:"subtotal",label:"invoices.subtotal",description:"invoices.subtotal_desc",icon:X,sampleValue:"$1,000.00"},{key:"tax_amount",label:"invoices.tax_amount",description:"invoices.tax_amount_desc",icon:X,sampleValue:"$100.00"},{key:"total_amount",label:"invoices.total_amount",description:"invoices.total_amount_desc",icon:X,sampleValue:"$1,100.00"},{key:"invoice_number",label:"invoices.invoice_number",description:"invoices.invoice_number_desc",icon:Q,sampleValue:"INV-2024-001"},{key:"category_summary",label:"invoices.category_summary",description:"invoices.category_summary_desc",icon:R,sampleValue:"Rings: 3 items, Necklaces: 2 items"},{key:"gold_purity_summary",label:"invoices.gold_purity_summary",description:"invoices.gold_purity_summary_desc",icon:R,sampleValue:"18K: 2 items, 21K: 3 items"}],F=e=>{if(e.preventDefault(),!M.value||!j.value)return;const t=j.value.getBoundingClientRect();if(!t)return;const a=(e.clientX-t.left)/P.value,r=(e.clientY-t.top)/P.value,s={id:Date.now(),...M.value,x:Math.max(0,a-50),y:Math.max(0,r-25),width:200,height:50};S.value.push(s),M.value=null},z=()=>{T.value.fields.custom_fields.push("")},B=()=>{P.value=Math.min(2,P.value+.1)},N=()=>{P.value=Math.max(.5,P.value-.1)},E=()=>{S.value=[],D.value=null,P.value=1},G=()=>{},O=async()=>{_.value=!0;try{const e={name:T.value.name,language:T.value.language,template_data:{layout:T.value.layout,fields:{...T.value.fields,placed_fields:S.value}},is_active:!0};let t;t=r.template?await i.updateTemplate(r.template.id,e):await i.createTemplate(e),t&&s("saved",t)}catch(e){}finally{_.value=!1}};return l(()=>{(()=>{if(r.template){const e=r.template.template_data||{},t=e.fields||{};T.value={name:r.template.name,language:r.template.language,layout:e.layout||"standard",fields:{logo:t.logo??!0,qr_code:t.qr_code??!0,category_hierarchy:t.category_hierarchy??!0,category_images:t.category_images??!0,gold_purity:t.gold_purity??!0,custom_fields:t.custom_fields||[]}},t.placed_fields&&(S.value=t.placed_fields)}})()}),(e,t)=>(h(),n("div",pu,[g("div",xu,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),g("div",bu,[g("div",fu,[g("div",hu,[g("h3",ku,c(e.template?e.$t("invoices.edit_template"):e.$t("invoices.create_template")),1),g("div",wu,[g("button",{onClick:G,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"},[m(v(U),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.preview")),1)]),g("button",{onClick:O,disabled:_.value,class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[_.value?(h(),n("svg",$u,t[16]||(t[16]=[g("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),g("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):u("",!0),d(" "+c(e.$t("common.save")),1)],8,_u),g("button",{onClick:t[1]||(t[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])])])]),g("div",Cu,[g("div",Iu,[g("div",ju,[g("div",null,[g("h4",Pu,c(e.$t("invoices.template_settings")),1),g("div",Du,[g("div",null,[g("label",Vu,c(e.$t("invoices.template_name")),1),p(g("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>T.value.name=e),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},null,512),[[k,T.value.name]])]),g("div",null,[g("label",Mu,c(e.$t("common.language")),1),p(g("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>T.value.language=e),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},[g("option",Su,c(e.$t("common.english")),1),g("option",Tu,c(e.$t("common.persian")),1)],512),[[x,T.value.language]])]),g("div",null,[g("label",Uu,c(e.$t("invoices.layout")),1),p(g("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>T.value.layout=e),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},[g("option",qu,c(e.$t("invoices.layout_standard")),1),g("option",Fu,c(e.$t("invoices.layout_modern")),1),g("option",zu,c(e.$t("invoices.layout_classic")),1)],512),[[x,T.value.layout]])])])]),g("div",null,[g("h4",Bu,c(e.$t("invoices.available_fields")),1),g("div",Lu,[(h(),n(b,null,f(q,t=>g("div",{key:t.key,draggable:!0,onDragstart:e=>(e=>{M.value=e})(t),class:"p-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-md cursor-move hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[g("div",Au,[(h(),w($(t.icon),{class:"h-4 w-4 text-gray-500 mr-2"})),g("span",Yu,c(e.$t(t.label)),1)]),g("p",Nu,c(e.$t(t.description)),1)],40,Ru)),64))])]),g("div",null,[g("h4",Eu,c(e.$t("invoices.field_options")),1),g("div",Gu,[g("label",Ou,[p(g("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>T.value.fields.logo=e),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[C,T.value.fields.logo]]),g("span",Hu,c(e.$t("invoices.include_logo")),1)]),g("label",Ju,[p(g("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>T.value.fields.qr_code=e),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[C,T.value.fields.qr_code]]),g("span",Wu,c(e.$t("invoices.include_qr_code")),1)]),g("label",Xu,[p(g("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>T.value.fields.category_hierarchy=e),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[C,T.value.fields.category_hierarchy]]),g("span",Qu,c(e.$t("invoices.include_category_hierarchy")),1)]),g("label",Ku,[p(g("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>T.value.fields.category_images=e),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[C,T.value.fields.category_images]]),g("span",Zu,c(e.$t("invoices.include_category_images")),1)]),g("label",eg,[p(g("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>T.value.fields.gold_purity=e),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[C,T.value.fields.gold_purity]]),g("span",tg,c(e.$t("invoices.include_gold_purity")),1)])])]),g("div",null,[g("h4",ag,c(e.$t("invoices.custom_fields")),1),g("div",rg,[(h(!0),n(b,null,f(T.value.fields.custom_fields,(t,a)=>(h(),n("div",{key:a,class:"flex items-center space-x-2"},[p(g("input",{"onUpdate:modelValue":e=>T.value.fields.custom_fields[a]=e,type:"text",placeholder:e.$t("invoices.custom_field_name"),class:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},null,8,sg),[[k,T.value.fields.custom_fields[a]]]),g("button",{onClick:e=>(e=>{T.value.fields.custom_fields.splice(e,1)})(a),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},[m(v(L),{class:"h-4 w-4"})],8,lg)]))),128)),g("button",{onClick:z,class:"w-full px-3 py-2 border border-dashed border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-600 dark:text-gray-400 hover:border-gray-400 dark:hover:border-gray-500 hover:text-gray-700 dark:hover:text-gray-300"},[m(v(Y),{class:"h-4 w-4 inline mr-1"}),d(" "+c(e.$t("invoices.add_custom_field")),1)])])])])]),g("div",ig,[g("div",ng,[g("div",og,[g("div",dg,[g("div",cg,[g("span",ug,c(e.$t("invoices.canvas")),1),g("div",gg,[g("button",{onClick:N,class:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"},[m(v(J),{class:"h-4 w-4"})]),g("span",mg,c(Math.round(100*P.value))+"% ",1),g("button",{onClick:B,class:"p-1 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"},[m(v(Y),{class:"h-4 w-4"})])])]),g("div",vg,[g("button",{onClick:E,class:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"},c(e.$t("common.reset")),1)])])]),g("div",yg,[g("div",{ref_key:"canvasRef",ref:j,class:"mx-auto bg-white shadow-lg",style:I({width:595*P.value+"px",height:842*P.value+"px",transform:`scale(${P.value})`,transformOrigin:"top left"}),onDragover:t[10]||(t[10]=y(()=>{},["prevent"])),onDrop:F},[g("div",pg,[g("div",xg,[T.value.fields.logo?(h(),n("div",bg,[g("div",fg,[g("span",hg,c(e.$t("invoices.logo_placeholder")),1)])])):u("",!0),g("h1",kg,c("fa"===T.value.language?"فاکتور":"INVOICE"),1),g("div",wg,[g("p",null,c("fa"===T.value.language?"شماره فاکتور: INV-2024-001":"Invoice Number: INV-2024-001"),1),g("p",null,c("fa"===T.value.language?"تاریخ: ۱۴۰۳/۰۱/۰۱":"Date: 2024-01-01"),1)])]),(h(!0),n(b,null,f(S.value,(t,a)=>{var r;return h(),n("div",{key:t.id,style:I({position:"absolute",left:`${t.x}px`,top:`${t.y}px`,width:`${t.width}px`,height:`${t.height}px`}),class:o(["border border-dashed border-primary-300 bg-primary-50 p-2 cursor-move",{"border-primary-500 bg-primary-100":(null==(r=D.value)?void 0:r.id)===t.id}]),draggable:!0,onDragstart:e=>((e,t)=>{if(!j.value||!e)return;const a=j.value.getBoundingClientRect();if(!a)return;const r=t.clientX-a.left-e.x*P.value,s=t.clientY-a.top-e.y*P.value,l=t=>{if(!j.value)return;const a=j.value.getBoundingClientRect();if(!a)return;const l=(t.clientX-a.left-r)/P.value,i=(t.clientY-a.top-s)/P.value;e.x=Math.max(0,Math.min(595-(e.width||200),l)),e.y=Math.max(0,Math.min(842-(e.height||50),i))},i=()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",i)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",i)})(t,e),onClick:e=>(e=>{D.value=e})(t)},[g("div",$g,[g("span",Cg,c(e.$t(t.label)),1),g("button",{onClick:y(e=>(e=>{if(e>=0&&e<S.value.length){const t=S.value[e];S.value.splice(e,1),D.value&&t&&D.value.id===t.id&&(D.value=null)}})(a),["stop"]),class:"text-red-500 hover:text-red-700"},[m(v(A),{class:"h-3 w-3"})],8,Ig)]),g("div",jg,c(t.sampleValue),1)],46,_g)}),128)),T.value.fields.qr_code?(h(),n("div",Pg,t[17]||(t[17]=[g("div",{class:"w-16 h-16 bg-gray-200 border border-gray-300 flex items-center justify-center"},[g("span",{class:"text-xs text-gray-500"},"QR")],-1)]))):u("",!0)])],36)])])]),D.value?(h(),n("div",Dg,[g("div",Vg,[g("h4",Mg,c(e.$t("invoices.field_properties")),1),g("div",Sg,[g("div",null,[g("label",Tg,c(e.$t("invoices.field_label")),1),p(g("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>D.value.label=e),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},null,512),[[k,D.value.label]])]),g("div",Ug,[g("div",null,[t[18]||(t[18]=g("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," X ",-1)),p(g("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>D.value.x=e),type:"number",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},null,512),[[k,D.value.x,void 0,{number:!0}]])]),g("div",null,[t[19]||(t[19]=g("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Y ",-1)),p(g("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>D.value.y=e),type:"number",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},null,512),[[k,D.value.y,void 0,{number:!0}]])])]),g("div",qg,[g("div",null,[g("label",Fg,c(e.$t("common.width")),1),p(g("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>D.value.width=e),type:"number",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},null,512),[[k,D.value.width,void 0,{number:!0}]])]),g("div",null,[g("label",zg,c(e.$t("common.height")),1),p(g("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>D.value.height=e),type:"number",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"},null,512),[[k,D.value.height,void 0,{number:!0}]])])])])])])):u("",!0)])])])]))}}),Lg={class:"fixed inset-0 z-50 overflow-y-auto"},Rg={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Ag={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full"},Yg={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Ng={class:"flex items-center justify-between mb-4"},Eg={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Gg={class:"space-y-6"},Og={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Hg={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Jg={key:0,class:"mt-1 text-sm text-red-600"},Wg={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Xg={value:""},Qg=["value"],Kg={key:0,class:"mt-1 text-sm text-red-600"},Zg={class:"text-md font-medium text-gray-900 dark:text-white mb-3"},em={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},tm={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},am={value:"daily"},rm={value:"weekly"},sm={value:"monthly"},lm={value:"quarterly"},im={value:"yearly"},nm={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},om={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},dm={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},cm={class:"text-md font-medium text-gray-900 dark:text-white mb-3"},um={class:"space-y-3"},gm={class:"flex items-center"},mm={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},vm={class:"flex items-center"},ym={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},pm={key:0,class:"ml-6"},xm={class:"flex items-center"},bm={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},fm={key:1,class:"ml-6"},hm={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},km={class:"text-md font-medium text-gray-900 dark:text-white mb-3"},wm={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},_m={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},$m={value:"en"},Cm={value:"fa"},Im={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},jm={value:""},Pm=["value"],Dm={class:"flex items-center justify-between mb-3"},Vm={class:"text-md font-medium text-gray-900 dark:text-white"},Mm={class:"space-y-3"},Sm={class:"flex-1"},Tm=["onUpdate:modelValue","placeholder"],Um={class:"w-20"},qm=["onUpdate:modelValue","placeholder","onInput"],Fm={class:"w-24"},zm=["onUpdate:modelValue","placeholder","onInput"],Bm={class:"w-24 text-sm font-medium text-gray-900 dark:text-white"},Lm=["onClick"],Rm={class:"mt-3 flex justify-end"},Am={class:"text-sm"},Ym={class:"text-gray-600 dark:text-gray-400"},Nm={class:"font-medium text-gray-900 dark:text-white"},Em={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Gm=["placeholder"],Om={class:"bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Hm=["disabled"],Jm={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Wm=r({__name:"RecurringInvoiceModal",props:{recurringInvoice:{default:null}},emits:["close","saved"],setup(e,{emit:r}){const s=e,i=r,w=te(),_=Ii(),{formatCurrency:$}=D(),C=t(!1),I=t({}),P=t({name:"",customer_id:"",frequency:"monthly",interval:1,start_date:(new Date).toISOString().split("T")[0],end_type:"never",end_date:"",max_occurrences:12,language:"en",template_id:"",notes:"",items:[]}),V=a(()=>_.customers),M=a(()=>w.templates),S=a(()=>P.value.items.reduce((e,t)=>e+(t.total_price||0),0)),T=()=>{P.value.items.push({description:"",quantity:1,unit_price:0,total_price:0})},U=e=>{const t=P.value.items[e];t.total_price=(t.quantity||0)*(t.unit_price||0)},q=async()=>{var e,t;C.value=!0,I.value={};try{const e={...P.value,customer_id:Number(P.value.customer_id),template_id:P.value.template_id?Number(P.value.template_id):void 0,amount:S.value};let t;t=s.recurringInvoice?await w.updateRecurringInvoice(s.recurringInvoice.id,e):await w.createRecurringInvoice(e),t&&i("saved",t)}catch(a){(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.errors)&&(I.value=a.response.data.errors)}finally{C.value=!1}};return l(async()=>{var e,t;await Promise.all([_.fetchCustomers(),w.fetchTemplates()]),s.recurringInvoice&&(P.value={name:s.recurringInvoice.name,customer_id:(null==(e=s.recurringInvoice.customer_id)?void 0:e.toString())||"",frequency:s.recurringInvoice.frequency,interval:s.recurringInvoice.interval,start_date:s.recurringInvoice.start_date,end_type:s.recurringInvoice.end_type||"never",end_date:s.recurringInvoice.end_date||"",max_occurrences:s.recurringInvoice.max_occurrences||12,language:s.recurringInvoice.language||"en",template_id:(null==(t=s.recurringInvoice.template_id)?void 0:t.toString())||"",notes:s.recurringInvoice.notes||"",items:s.recurringInvoice.items||[]})}),(e,t)=>(h(),n("div",Lg,[g("div",Rg,[g("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[0]||(t[0]=t=>e.$emit("close"))}),g("div",Ag,[g("form",{onSubmit:y(q,["prevent"])},[g("div",Yg,[g("div",Ng,[g("h3",Eg,c(e.recurringInvoice?e.$t("invoices.edit_recurring"):e.$t("invoices.create_recurring")),1),g("button",{type:"button",onClick:t[1]||(t[1]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[m(v(A),{class:"h-6 w-6"})])]),g("div",Gg,[g("div",Og,[g("div",null,[g("label",Hg,c(e.$t("invoices.template_name"))+" * ",1),p(g("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>P.value.name=e),type:"text",required:"",class:o(["block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",{"border-red-500":I.value.name}])},null,2),[[k,P.value.name]]),I.value.name?(h(),n("p",Jg,c(I.value.name[0]),1)):u("",!0)]),g("div",null,[g("label",Wg,c(e.$t("invoices.customer"))+" * ",1),p(g("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>P.value.customer_id=e),required:"",class:o(["block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",{"border-red-500":I.value.customer_id}])},[g("option",Xg,c(e.$t("invoices.select_customer")),1),(h(!0),n(b,null,f(V.value,e=>(h(),n("option",{key:e.id,value:e.id},c(e.name),9,Qg))),128))],2),[[x,P.value.customer_id]]),I.value.customer_id?(h(),n("p",Kg,c(I.value.customer_id[0]),1)):u("",!0)])]),g("div",null,[g("h4",Zg,c(e.$t("invoices.frequency_settings")),1),g("div",em,[g("div",null,[g("label",tm,c(e.$t("invoices.frequency"))+" * ",1),p(g("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>P.value.frequency=e),required:"",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[g("option",am,c(e.$t("invoices.frequency_daily")),1),g("option",rm,c(e.$t("invoices.frequency_weekly")),1),g("option",sm,c(e.$t("invoices.frequency_monthly")),1),g("option",lm,c(e.$t("invoices.frequency_quarterly")),1),g("option",im,c(e.$t("invoices.frequency_yearly")),1)],512),[[x,P.value.frequency]])]),g("div",null,[g("label",nm,c(e.$t("invoices.interval"))+" * ",1),p(g("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>P.value.interval=e),type:"number",min:"1",required:"",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[k,P.value.interval,void 0,{number:!0}]]),g("p",om,c(e.$t("invoices.interval_description")),1)]),g("div",null,[g("label",dm,c(e.$t("invoices.start_date"))+" * ",1),m(be,{modelValue:P.value.start_date,"onUpdate:modelValue":t[6]||(t[6]=e=>P.value.start_date=e),required:""},null,8,["modelValue"])])])]),g("div",null,[g("h4",cm,c(e.$t("invoices.end_conditions")),1),g("div",um,[g("label",gm,[p(g("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>P.value.end_type=e),type:"radio",value:"never",class:"text-primary-600 focus:ring-primary-500"},null,512),[[j,P.value.end_type]]),g("span",mm,c(e.$t("invoices.never_end")),1)]),g("label",vm,[p(g("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>P.value.end_type=e),type:"radio",value:"date",class:"text-primary-600 focus:ring-primary-500"},null,512),[[j,P.value.end_type]]),g("span",ym,c(e.$t("invoices.end_on_date")),1)]),"date"===P.value.end_type?(h(),n("div",pm,[m(be,{modelValue:P.value.end_date,"onUpdate:modelValue":t[9]||(t[9]=e=>P.value.end_date=e),class:"max-w-xs"},null,8,["modelValue"])])):u("",!0),g("label",xm,[p(g("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>P.value.end_type=e),type:"radio",value:"count",class:"text-primary-600 focus:ring-primary-500"},null,512),[[j,P.value.end_type]]),g("span",bm,c(e.$t("invoices.end_after_count")),1)]),"count"===P.value.end_type?(h(),n("div",fm,[p(g("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>P.value.max_occurrences=e),type:"number",min:"1",class:"block w-full max-w-xs rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[k,P.value.max_occurrences,void 0,{number:!0}]]),g("p",hm,c(e.$t("invoices.max_occurrences_description")),1)])):u("",!0)])]),g("div",null,[g("h4",km,c(e.$t("invoices.invoice_template")),1),g("div",wm,[g("div",null,[g("label",_m,c(e.$t("common.language"))+" * ",1),p(g("select",{"onUpdate:modelValue":t[12]||(t[12]=e=>P.value.language=e),required:"",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[g("option",$m,c(e.$t("common.english")),1),g("option",Cm,c(e.$t("common.persian")),1)],512),[[x,P.value.language]])]),g("div",null,[g("label",Im,c(e.$t("invoices.template")),1),p(g("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>P.value.template_id=e),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[g("option",jm,c(e.$t("invoices.default_template")),1),(h(!0),n(b,null,f(M.value,e=>(h(),n("option",{key:e.id,value:e.id},c(e.name),9,Pm))),128))],512),[[x,P.value.template_id]])])])]),g("div",null,[g("div",Dm,[g("h4",Vm,c(e.$t("invoices.items")),1),g("button",{type:"button",onClick:T,class:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-primary-700 bg-primary-100 hover:bg-primary-200 dark:bg-primary-900 dark:text-primary-300"},[m(v(Y),{class:"h-4 w-4 mr-1"}),d(" "+c(e.$t("invoices.add_item")),1)])]),g("div",Mm,[(h(!0),n(b,null,f(P.value.items,(t,a)=>(h(),n("div",{key:a,class:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-md"},[g("div",Sm,[p(g("input",{"onUpdate:modelValue":e=>t.description=e,type:"text",placeholder:e.$t("invoices.item_description"),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white text-sm"},null,8,Tm),[[k,t.description]])]),g("div",Um,[p(g("input",{"onUpdate:modelValue":e=>t.quantity=e,type:"number",step:"0.01",min:"0",placeholder:e.$t("invoices.quantity"),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white text-sm",onInput:e=>U(a)},null,40,qm),[[k,t.quantity,void 0,{number:!0}]])]),g("div",Fm,[p(g("input",{"onUpdate:modelValue":e=>t.unit_price=e,type:"number",step:"0.01",min:"0",placeholder:e.$t("invoices.unit_price"),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white text-sm",onInput:e=>U(a)},null,40,zm),[[k,t.unit_price,void 0,{number:!0}]])]),g("div",Bm,c(v($)(t.total_price||0)),1),g("button",{type:"button",onClick:e=>(e=>{P.value.items.splice(e,1)})(a),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},[m(v(L),{class:"h-4 w-4"})],8,Lm)]))),128))]),g("div",Rm,[g("div",Am,[g("span",Ym,c(e.$t("invoices.total"))+": ",1),g("span",Nm,c(v($)(S.value)),1)])])]),g("div",null,[g("label",Em,c(e.$t("invoices.notes")),1),p(g("textarea",{"onUpdate:modelValue":t[14]||(t[14]=e=>P.value.notes=e),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:e.$t("invoices.notes_placeholder")},null,8,Gm),[[k,P.value.notes]])])])]),g("div",Om,[g("button",{type:"submit",disabled:C.value||0===P.value.items.length,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[C.value?(h(),n("svg",Jm,t[16]||(t[16]=[g("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),g("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):u("",!0),d(" "+c(e.recurringInvoice?e.$t("common.update"):e.$t("common.create")),1)],8,Hm),g("button",{type:"button",onClick:t[15]||(t[15]=t=>e.$emit("close")),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"},c(e.$t("common.cancel")),1)])],32)])])]))}}),Xm={class:"space-y-6"},Qm={class:"sm:flex sm:items-center sm:justify-between"},Km={class:"sm:flex-auto"},Zm={class:"text-2xl font-semibold text-gray-900 dark:text-white"},ev={class:"mt-2 text-sm text-gray-700 dark:text-gray-300"},tv={class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none space-x-3"},av={class:"border-b border-gray-200 dark:border-gray-700"},rv={class:"-mb-px flex space-x-8"},sv=["onClick"],lv={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"},iv={class:"mt-6"},nv={key:0},ov={key:1},dv={key:2},cv={key:3},uv=r({__name:"InvoicesView",setup(e){const r=te(),s=t("list"),i=t(!1),y=t(!1),p=t(!1),x=t(!1),k=t(!1),_=t(!1),$=t(!1),C=t(null),I=t(null),j=t(null),P=a(()=>[{key:"list",label:"invoices.tabs.all_invoices",count:r.invoices.length},{key:"templates",label:"invoices.tabs.templates",count:r.templates.length},{key:"batch",label:"invoices.tabs.batch_operations"},{key:"recurring",label:"invoices.tabs.recurring",count:r.recurringInvoices.length}]),D=e=>{C.value=e,y.value=!0,p.value=!1},V=e=>{C.value=e,p.value=!0},M=e=>{C.value=e,x.value=!0,p.value=!1},S=async e=>{try{await r.duplicateInvoice(e.id),await r.fetchInvoices()}catch(t){}},T=async e=>{try{await r.generatePDF(e.id)}catch(t){}},U=async(e,t)=>{try{await r.sendInvoice(e.id,t)}catch(a){}},q=e=>{I.value=e,k.value=!0},F=async e=>{try{await r.deleteTemplate(e.id)}catch(t){}},z=()=>{I.value=null,k.value=!0},B=e=>{j.value=e,_.value=!0},L=async e=>{},R=async()=>{if(C.value)try{await r.deleteInvoice(C.value.id),x.value=!1,C.value=null}catch(e){}},A=()=>{O(),r.fetchInvoices()},E=()=>{H(),r.fetchTemplates()},G=()=>{J(),r.fetchRecurringInvoices()},O=()=>{i.value=!1,y.value=!1,p.value=!1,C.value=null},H=()=>{k.value=!1,I.value=null},J=()=>{_.value=!1,j.value=null};return l(async()=>{try{await Promise.all([r.fetchInvoices().catch(e=>{}),r.fetchTemplates().catch(e=>{}),r.fetchRecurringInvoices().catch(e=>{})])}catch(e){}}),(e,t)=>{var a;return h(),n("div",Xm,[g("div",Qm,[g("div",Km,[g("h1",Zm,c(e.$t("invoices.title")),1),g("p",ev,c(e.$t("invoices.description")),1)]),g("div",tv,[g("button",{onClick:z,type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700"},[m(v(N),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.template_designer")),1)]),g("button",{onClick:t[0]||(t[0]=e=>i.value=!0),type:"button",class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"},[m(v(Y),{class:"h-4 w-4 mr-2"}),d(" "+c(e.$t("invoices.create_invoice")),1)])])]),g("div",av,[g("nav",rv,[(h(!0),n(b,null,f(P.value,t=>(h(),n("button",{key:t.key,onClick:e=>s.value=t.key,class:o(["whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm",s.value===t.key?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"])},[d(c(e.$t(t.label))+" ",1),void 0!==t.count?(h(),n("span",lv,c(t.count),1)):u("",!0)],10,sv))),128))])]),g("div",iv,["list"===s.value?(h(),n("div",nv,[m(ra,{onEditInvoice:D,onViewInvoice:V,onDeleteInvoice:M,onDuplicateInvoice:S,onGeneratePdf:T,onSendInvoice:U})])):u("",!0),"templates"===s.value?(h(),n("div",ov,[m(Na,{onEditTemplate:q,onDeleteTemplate:F,onCreateTemplate:t[1]||(t[1]=e=>k.value=!0)})])):u("",!0),"batch"===s.value?(h(),n("div",dv,[m(Es)])):u("",!0),"recurring"===s.value?(h(),n("div",cv,[m(Ci,{onEditRecurring:B,onDeleteRecurring:L,onCreateRecurring:t[2]||(t[2]=e=>_.value=!0)})])):u("",!0)]),i.value||y.value?(h(),w(Ao,{key:0,invoice:C.value,"is-edit":y.value,onClose:O,onSaved:A},null,8,["invoice","is-edit"])):u("",!0),p.value?(h(),w(yu,{key:1,invoice:C.value,onClose:O,onEdit:D,onDelete:M,onDuplicate:S,onGeneratePdf:T,onSend:U},null,8,["invoice"])):u("",!0),k.value?(h(),w(Bg,{key:2,template:I.value,onClose:H,onSaved:E},null,8,["template"])):u("",!0),_.value?(h(),w(Wm,{key:3,"recurring-invoice":j.value,onClose:J,onSaved:G},null,8,["recurring-invoice"])):u("",!0),$.value?(h(),w(Hd,{key:4,invoice:C.value,onClose:t[3]||(t[3]=e=>$.value=!1),onDownload:T},null,8,["invoice"])):u("",!0),x.value?(h(),w(Z,{key:5,title:e.$t("invoices.delete_invoice"),message:e.$t("invoices.delete_confirmation",{number:null==(a=C.value)?void 0:a.invoice_number}),loading:v(r).loading.deleting,onConfirm:R,onCancel:t[4]||(t[4]=e=>x.value=!1)},null,8,["title","message","loading"])):u("",!0)])}}}),gv=Object.freeze(Object.defineProperty({__proto__:null,default:uv},Symbol.toStringTag,{value:"Module"}));export{gv as I,ji as a,ae as b,Ii as u};
